(()=>{var an=Object.create;var Xi=Object.defineProperty;var cn=Object.getOwnPropertyDescriptor;var ln=Object.getOwnPropertyNames,yr=Object.getOwnPropertySymbols,hn=Object.getPrototypeOf,br=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable;var mr=(e,s,l)=>s in e?Xi(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l,Ye=(e,s)=>{for(var l in s||(s={}))br.call(s,l)&&mr(e,l,s[l]);if(yr)for(var l of yr(s))un.call(s,l)&&mr(e,l,s[l]);return e};var fn=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports);var dn=(e,s,l,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of ln(s))!br.call(e,o)&&o!==l&&Xi(e,o,{get:()=>s[o],enumerable:!(t=cn(s,o))||t.enumerable});return e};var pn=(e,s,l)=>(l=e!=null?an(hn(e)):{},dn(s||!e||!e.__esModule?Xi(l,"default",{value:e,enumerable:!0}):l,e));var Zr=fn((yi,pr)=>{(function(e,s){if(typeof yi=="object"&&typeof pr=="object")pr.exports=s();else if(typeof define=="function"&&define.amd)define([],s);else{var l=s();for(var t in l)(typeof yi=="object"?yi:e)[t]=l[t]}})(self,function(){return(()=>{"use strict";var e={4567:function(l,t,o){var a,u=this&&this.__extends||(a=function(r,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,d){n.__proto__=d}||function(n,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(n[f]=d[f])},a(r,i)},function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=r}a(r,i),r.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;var p=o(9042),_=o(6114),b=o(9924),m=o(3656),h=o(844),v=o(5596),g=o(9631),c=function(r){function i(n,d){var f=r.call(this)||this;f._terminal=n,f._renderService=d,f._liveRegionLineCount=0,f._charsToConsume=[],f._charsToAnnounce="",f._accessibilityTreeRoot=document.createElement("div"),f._accessibilityTreeRoot.classList.add("xterm-accessibility"),f._accessibilityTreeRoot.tabIndex=0,f._rowContainer=document.createElement("div"),f._rowContainer.setAttribute("role","list"),f._rowContainer.classList.add("xterm-accessibility-tree"),f._rowElements=[];for(var y=0;y<f._terminal.rows;y++)f._rowElements[y]=f._createAccessibilityTreeNode(),f._rowContainer.appendChild(f._rowElements[y]);if(f._topBoundaryFocusListener=function(S){return f._onBoundaryFocus(S,0)},f._bottomBoundaryFocusListener=function(S){return f._onBoundaryFocus(S,1)},f._rowElements[0].addEventListener("focus",f._topBoundaryFocusListener),f._rowElements[f._rowElements.length-1].addEventListener("focus",f._bottomBoundaryFocusListener),f._refreshRowsDimensions(),f._accessibilityTreeRoot.appendChild(f._rowContainer),f._renderRowsDebouncer=new b.TimeBasedDebouncer(f._renderRows.bind(f)),f._refreshRows(),f._liveRegion=document.createElement("div"),f._liveRegion.classList.add("live-region"),f._liveRegion.setAttribute("aria-live","assertive"),f._accessibilityTreeRoot.appendChild(f._liveRegion),!f._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");return f._terminal.element.insertAdjacentElement("afterbegin",f._accessibilityTreeRoot),f.register(f._renderRowsDebouncer),f.register(f._terminal.onResize(function(S){return f._onResize(S.rows)})),f.register(f._terminal.onRender(function(S){return f._refreshRows(S.start,S.end)})),f.register(f._terminal.onScroll(function(){return f._refreshRows()})),f.register(f._terminal.onA11yChar(function(S){return f._onChar(S)})),f.register(f._terminal.onLineFeed(function(){return f._onChar(`
`)})),f.register(f._terminal.onA11yTab(function(S){return f._onTab(S)})),f.register(f._terminal.onKey(function(S){return f._onKey(S.key)})),f.register(f._terminal.onBlur(function(){return f._clearLiveRegion()})),f.register(f._renderService.onDimensionsChange(function(){return f._refreshRowsDimensions()})),f._screenDprMonitor=new v.ScreenDprMonitor,f.register(f._screenDprMonitor),f._screenDprMonitor.setListener(function(){return f._refreshRowsDimensions()}),f.register((0,m.addDisposableDomListener)(window,"resize",function(){return f._refreshRowsDimensions()})),f}return u(i,r),i.prototype.dispose=function(){r.prototype.dispose.call(this),(0,g.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0},i.prototype._onBoundaryFocus=function(n,d){var f=n.target,y=this._rowElements[d===0?1:this._rowElements.length-2];if(f.getAttribute("aria-posinset")!==(d===0?"1":""+this._terminal.buffer.lines.length)&&n.relatedTarget===y){var S,E;if(d===0?(S=f,E=this._rowElements.pop(),this._rowContainer.removeChild(E)):(S=this._rowElements.shift(),E=f,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),E.removeEventListener("focus",this._bottomBoundaryFocusListener),d===0){var L=this._createAccessibilityTreeNode();this._rowElements.unshift(L),this._rowContainer.insertAdjacentElement("afterbegin",L)}else L=this._createAccessibilityTreeNode(),this._rowElements.push(L),this._rowContainer.appendChild(L);this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(d===0?-1:1),this._rowElements[d===0?1:this._rowElements.length-2].focus(),n.preventDefault(),n.stopImmediatePropagation()}},i.prototype._onResize=function(n){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var d=this._rowContainer.children.length;d<this._terminal.rows;d++)this._rowElements[d]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[d]);for(;this._rowElements.length>n;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},i.prototype._createAccessibilityTreeNode=function(){var n=document.createElement("div");return n.setAttribute("role","listitem"),n.tabIndex=-1,this._refreshRowDimensions(n),n},i.prototype._onTab=function(n){for(var d=0;d<n;d++)this._onChar(" ")},i.prototype._onChar=function(n){var d=this;this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==n&&(this._charsToAnnounce+=n):this._charsToAnnounce+=n,n===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=p.tooMuchOutput)),_.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(function(){d._accessibilityTreeRoot.appendChild(d._liveRegion)},0))},i.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,_.isMac&&(0,g.removeElementFromParent)(this._liveRegion)},i.prototype._onKey=function(n){this._clearLiveRegion(),this._charsToConsume.push(n)},i.prototype._refreshRows=function(n,d){this._renderRowsDebouncer.refresh(n,d,this._terminal.rows)},i.prototype._renderRows=function(n,d){for(var f=this._terminal.buffer,y=f.lines.length.toString(),S=n;S<=d;S++){var E=f.translateBufferLineToString(f.ydisp+S,!0),L=(f.ydisp+S+1).toString(),C=this._rowElements[S];C&&(E.length===0?C.innerText="\xA0":C.textContent=E,C.setAttribute("aria-posinset",L),C.setAttribute("aria-setsize",y))}this._announceCharacters()},i.prototype._refreshRowsDimensions=function(){if(this._renderService.dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var n=0;n<this._terminal.rows;n++)this._refreshRowDimensions(this._rowElements[n])}},i.prototype._refreshRowDimensions=function(n){n.style.height=this._renderService.dimensions.actualCellHeight+"px"},i.prototype._announceCharacters=function(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},i}(h.Disposable);t.AccessibilityManager=c},3614:(l,t)=>{function o(_){return _.replace(/\r?\n/g,"\r")}function a(_,b){return b?"\x1B[200~"+_+"\x1B[201~":_}function u(_,b,m){_=a(_=o(_),m.decPrivateModes.bracketedPasteMode),m.triggerDataEvent(_,!0),b.value=""}function p(_,b,m){var h=m.getBoundingClientRect(),v=_.clientX-h.left-10,g=_.clientY-h.top-10;b.style.width="20px",b.style.height="20px",b.style.left=v+"px",b.style.top=g+"px",b.style.zIndex="1000",b.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=o,t.bracketTextForPaste=a,t.copyHandler=function(_,b){_.clipboardData&&_.clipboardData.setData("text/plain",b.selectionText),_.preventDefault()},t.handlePasteEvent=function(_,b,m){_.stopPropagation(),_.clipboardData&&u(_.clipboardData.getData("text/plain"),b,m)},t.paste=u,t.moveTextAreaUnderMouseCursor=p,t.rightClickHandler=function(_,b,m,h,v){p(_,b,m),v&&h.rightClickSelect(_),b.value=h.selectionText,b.select()}},4774:(l,t)=>{var o,a,u,p;function _(m){var h=m.toString(16);return h.length<2?"0"+h:h}function b(m,h){return m<h?(h+.05)/(m+.05):(m+.05)/(h+.05)}Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=void 0,function(m){m.toCss=function(h,v,g,c){return c!==void 0?"#"+_(h)+_(v)+_(g)+_(c):"#"+_(h)+_(v)+_(g)},m.toRgba=function(h,v,g,c){return c===void 0&&(c=255),(h<<24|v<<16|g<<8|c)>>>0}}(o=t.channels||(t.channels={})),(a=t.color||(t.color={})).blend=function(m,h){var v=(255&h.rgba)/255;if(v===1)return{css:h.css,rgba:h.rgba};var g=h.rgba>>24&255,c=h.rgba>>16&255,r=h.rgba>>8&255,i=m.rgba>>24&255,n=m.rgba>>16&255,d=m.rgba>>8&255,f=i+Math.round((g-i)*v),y=n+Math.round((c-n)*v),S=d+Math.round((r-d)*v);return{css:o.toCss(f,y,S),rgba:o.toRgba(f,y,S)}},a.isOpaque=function(m){return(255&m.rgba)==255},a.ensureContrastRatio=function(m,h,v){var g=p.ensureContrastRatio(m.rgba,h.rgba,v);if(g)return p.toColor(g>>24&255,g>>16&255,g>>8&255)},a.opaque=function(m){var h=(255|m.rgba)>>>0,v=p.toChannels(h),g=v[0],c=v[1],r=v[2];return{css:o.toCss(g,c,r),rgba:h}},a.opacity=function(m,h){var v=Math.round(255*h),g=p.toChannels(m.rgba),c=g[0],r=g[1],i=g[2];return{css:o.toCss(c,r,i,v),rgba:o.toRgba(c,r,i,v)}},a.toColorRGB=function(m){return[m.rgba>>24&255,m.rgba>>16&255,m.rgba>>8&255]},(t.css||(t.css={})).toColor=function(m){switch(m.length){case 7:return{css:m,rgba:(parseInt(m.slice(1),16)<<8|255)>>>0};case 9:return{css:m,rgba:parseInt(m.slice(1),16)>>>0}}throw new Error("css.toColor: Unsupported css format")},function(m){function h(v,g,c){var r=v/255,i=g/255,n=c/255;return .2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))}m.relativeLuminance=function(v){return h(v>>16&255,v>>8&255,255&v)},m.relativeLuminance2=h}(u=t.rgb||(t.rgb={})),function(m){function h(g,c,r){for(var i=g>>24&255,n=g>>16&255,d=g>>8&255,f=c>>24&255,y=c>>16&255,S=c>>8&255,E=b(u.relativeLuminance2(f,S,y),u.relativeLuminance2(i,n,d));E<r&&(f>0||y>0||S>0);)f-=Math.max(0,Math.ceil(.1*f)),y-=Math.max(0,Math.ceil(.1*y)),S-=Math.max(0,Math.ceil(.1*S)),E=b(u.relativeLuminance2(f,S,y),u.relativeLuminance2(i,n,d));return(f<<24|y<<16|S<<8|255)>>>0}function v(g,c,r){for(var i=g>>24&255,n=g>>16&255,d=g>>8&255,f=c>>24&255,y=c>>16&255,S=c>>8&255,E=b(u.relativeLuminance2(f,S,y),u.relativeLuminance2(i,n,d));E<r&&(f<255||y<255||S<255);)f=Math.min(255,f+Math.ceil(.1*(255-f))),y=Math.min(255,y+Math.ceil(.1*(255-y))),S=Math.min(255,S+Math.ceil(.1*(255-S))),E=b(u.relativeLuminance2(f,S,y),u.relativeLuminance2(i,n,d));return(f<<24|y<<16|S<<8|255)>>>0}m.ensureContrastRatio=function(g,c,r){var i=u.relativeLuminance(g>>8),n=u.relativeLuminance(c>>8);if(b(i,n)<r)return n<i?h(g,c,r):v(g,c,r)},m.reduceLuminance=h,m.increaseLuminance=v,m.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},m.toColor=function(g,c,r){return{css:o.toCss(g,c,r),rgba:o.toRgba(g,c,r)}}}(p=t.rgba||(t.rgba={})),t.toPaddedHex=_,t.contrastRatio=b},7239:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;var o=function(){function a(){this._color={},this._rgba={}}return a.prototype.clear=function(){this._color={},this._rgba={}},a.prototype.setCss=function(u,p,_){this._rgba[u]||(this._rgba[u]={}),this._rgba[u][p]=_},a.prototype.getCss=function(u,p){return this._rgba[u]?this._rgba[u][p]:void 0},a.prototype.setColor=function(u,p,_){this._color[u]||(this._color[u]={}),this._color[u][p]=_},a.prototype.getColor=function(u,p){return this._color[u]?this._color[u][p]:void 0},a}();t.ColorContrastCache=o},5680:function(l,t,o){var a=this&&this.__spreadArray||function(c,r,i){if(i||arguments.length===2)for(var n,d=0,f=r.length;d<f;d++)!n&&d in r||(n||(n=Array.prototype.slice.call(r,0,d)),n[d]=r[d]);return c.concat(n||Array.prototype.slice.call(r))};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorManager=t.DEFAULT_ANSI_COLORS=void 0;var u=o(4774),p=o(7239),_=u.css.toColor("#ffffff"),b=u.css.toColor("#000000"),m=u.css.toColor("#ffffff"),h=u.css.toColor("#000000"),v={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var c=[u.css.toColor("#2e3436"),u.css.toColor("#cc0000"),u.css.toColor("#4e9a06"),u.css.toColor("#c4a000"),u.css.toColor("#3465a4"),u.css.toColor("#75507b"),u.css.toColor("#06989a"),u.css.toColor("#d3d7cf"),u.css.toColor("#555753"),u.css.toColor("#ef2929"),u.css.toColor("#8ae234"),u.css.toColor("#fce94f"),u.css.toColor("#729fcf"),u.css.toColor("#ad7fa8"),u.css.toColor("#34e2e2"),u.css.toColor("#eeeeec")],r=[0,95,135,175,215,255],i=0;i<216;i++){var n=r[i/36%6|0],d=r[i/6%6|0],f=r[i%6];c.push({css:u.channels.toCss(n,d,f),rgba:u.channels.toRgba(n,d,f)})}for(i=0;i<24;i++){var y=8+10*i;c.push({css:u.channels.toCss(y,y,y),rgba:u.channels.toRgba(y,y,y)})}return c}());var g=function(){function c(r,i){this.allowTransparency=i;var n=r.createElement("canvas");n.width=1,n.height=1;var d=n.getContext("2d");if(!d)throw new Error("Could not get rendering context");this._ctx=d,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this._contrastCache=new p.ColorContrastCache,this.colors={foreground:_,background:b,cursor:m,cursorAccent:h,selectionTransparent:v,selectionOpaque:u.color.blend(b,v),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors()}return c.prototype.onOptionsChange=function(r){r==="minimumContrastRatio"&&this._contrastCache.clear()},c.prototype.setTheme=function(r){r===void 0&&(r={}),this.colors.foreground=this._parseColor(r.foreground,_),this.colors.background=this._parseColor(r.background,b),this.colors.cursor=this._parseColor(r.cursor,m,!0),this.colors.cursorAccent=this._parseColor(r.cursorAccent,h,!0),this.colors.selectionTransparent=this._parseColor(r.selection,v,!0),this.colors.selectionOpaque=u.color.blend(this.colors.background,this.colors.selectionTransparent),u.color.isOpaque(this.colors.selectionTransparent)&&(this.colors.selectionTransparent=u.color.opacity(this.colors.selectionTransparent,.3)),this.colors.ansi[0]=this._parseColor(r.black,t.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(r.red,t.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(r.green,t.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(r.yellow,t.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(r.blue,t.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(r.magenta,t.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(r.cyan,t.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(r.white,t.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(r.brightBlack,t.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(r.brightRed,t.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(r.brightGreen,t.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(r.brightYellow,t.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(r.brightBlue,t.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(r.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(r.brightCyan,t.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(r.brightWhite,t.DEFAULT_ANSI_COLORS[15]),this._contrastCache.clear(),this._updateRestoreColors()},c.prototype.restoreColor=function(r){if(r!==void 0)switch(r){case 256:this.colors.foreground=this._restoreColors.foreground;break;case 257:this.colors.background=this._restoreColors.background;break;case 258:this.colors.cursor=this._restoreColors.cursor;break;default:this.colors.ansi[r]=this._restoreColors.ansi[r]}else for(var i=0;i<this._restoreColors.ansi.length;++i)this.colors.ansi[i]=this._restoreColors.ansi[i]},c.prototype._updateRestoreColors=function(){this._restoreColors={foreground:this.colors.foreground,background:this.colors.background,cursor:this.colors.cursor,ansi:a([],this.colors.ansi,!0)}},c.prototype._parseColor=function(r,i,n){if(n===void 0&&(n=this.allowTransparency),r===void 0)return i;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=r,typeof this._ctx.fillStyle!="string")return console.warn("Color: "+r+" is invalid using fallback "+i.css),i;this._ctx.fillRect(0,0,1,1);var d=this._ctx.getImageData(0,0,1,1).data;if(d[3]!==255){if(!n)return console.warn("Color: "+r+" is using transparency, but allowTransparency is false. Using fallback "+i.css+"."),i;var f=this._ctx.fillStyle.substring(5,this._ctx.fillStyle.length-1).split(",").map(function(w){return Number(w)}),y=f[0],S=f[1],E=f[2],L=f[3],C=Math.round(255*L);return{rgba:u.channels.toRgba(y,S,E,C),css:r}}return{css:this._ctx.fillStyle,rgba:u.channels.toRgba(d[0],d[1],d[2],d[3])}},c}();t.ColorManager=g},9631:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeElementFromParent=void 0,t.removeElementFromParent=function(){for(var o,a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];for(var p=0,_=a;p<_.length;p++){var b=_[p];(o=b==null?void 0:b.parentElement)===null||o===void 0||o.removeChild(b)}}},3656:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(o,a,u,p){o.addEventListener(a,u,p);var _=!1;return{dispose:function(){_||(_=!0,o.removeEventListener(a,u,p))}}}},3551:function(l,t,o){var a=this&&this.__decorate||function(h,v,g,c){var r,i=arguments.length,n=i<3?v:c===null?c=Object.getOwnPropertyDescriptor(v,g):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(h,v,g,c);else for(var d=h.length-1;d>=0;d--)(r=h[d])&&(n=(i<3?r(n):i>3?r(v,g,n):r(v,g))||n);return i>3&&n&&Object.defineProperty(v,g,n),n},u=this&&this.__param||function(h,v){return function(g,c){v(g,c,h)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseZone=t.Linkifier=void 0;var p=o(8460),_=o(2585),b=function(){function h(v,g,c){this._bufferService=v,this._logService=g,this._unicodeService=c,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onShowLinkUnderline=new p.EventEmitter,this._onHideLinkUnderline=new p.EventEmitter,this._onLinkTooltip=new p.EventEmitter,this._rowsToLinkify={start:void 0,end:void 0}}return Object.defineProperty(h.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!1,configurable:!0}),h.prototype.attachToDom=function(v,g){this._element=v,this._mouseZoneManager=g},h.prototype.linkifyRows=function(v,g){var c=this;this._mouseZoneManager&&(this._rowsToLinkify.start===void 0||this._rowsToLinkify.end===void 0?(this._rowsToLinkify.start=v,this._rowsToLinkify.end=g):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,v),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,g)),this._mouseZoneManager.clearAll(v,g),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout(function(){return c._linkifyRows()},h._timeBeforeLatency))},h.prototype._linkifyRows=function(){this._rowsTimeoutId=void 0;var v=this._bufferService.buffer;if(this._rowsToLinkify.start!==void 0&&this._rowsToLinkify.end!==void 0){var g=v.ydisp+this._rowsToLinkify.start;if(!(g>=v.lines.length)){for(var c=v.ydisp+Math.min(this._rowsToLinkify.end,this._bufferService.rows)+1,r=Math.ceil(2e3/this._bufferService.cols),i=this._bufferService.buffer.iterator(!1,g,c,r,r);i.hasNext();)for(var n=i.next(),d=0;d<this._linkMatchers.length;d++)this._doLinkifyRow(n.range.first,n.content,this._linkMatchers[d]);this._rowsToLinkify.start=void 0,this._rowsToLinkify.end=void 0}}else this._logService.debug("_rowToLinkify was unset before _linkifyRows was called")},h.prototype.registerLinkMatcher=function(v,g,c){if(c===void 0&&(c={}),!g)throw new Error("handler must be defined");var r={id:this._nextLinkMatcherId++,regex:v,handler:g,matchIndex:c.matchIndex,validationCallback:c.validationCallback,hoverTooltipCallback:c.tooltipCallback,hoverLeaveCallback:c.leaveCallback,willLinkActivate:c.willLinkActivate,priority:c.priority||0};return this._addLinkMatcherToList(r),r.id},h.prototype._addLinkMatcherToList=function(v){if(this._linkMatchers.length!==0){for(var g=this._linkMatchers.length-1;g>=0;g--)if(v.priority<=this._linkMatchers[g].priority)return void this._linkMatchers.splice(g+1,0,v);this._linkMatchers.splice(0,0,v)}else this._linkMatchers.push(v)},h.prototype.deregisterLinkMatcher=function(v){for(var g=0;g<this._linkMatchers.length;g++)if(this._linkMatchers[g].id===v)return this._linkMatchers.splice(g,1),!0;return!1},h.prototype._doLinkifyRow=function(v,g,c){for(var r,i=this,n=new RegExp(c.regex.source,(c.regex.flags||"")+"g"),d=-1,f=function(){var S=r[typeof c.matchIndex!="number"?0:c.matchIndex];if(!S)return y._logService.debug("match found without corresponding matchIndex",r,c),"break";if(d=g.indexOf(S,d+1),n.lastIndex=d+S.length,d<0)return"break";var E=y._bufferService.buffer.stringIndexToBufferIndex(v,d);if(E[0]<0)return"break";var L=y._bufferService.buffer.lines.get(E[0]);if(!L)return"break";var C=L.getFg(E[1]),w=C?C>>9&511:void 0;c.validationCallback?c.validationCallback(S,function(T){i._rowsTimeoutId||T&&i._addLink(E[1],E[0]-i._bufferService.buffer.ydisp,S,c,w)}):y._addLink(E[1],E[0]-y._bufferService.buffer.ydisp,S,c,w)},y=this;(r=n.exec(g))!==null&&f()!=="break";);},h.prototype._addLink=function(v,g,c,r,i){var n=this;if(this._mouseZoneManager&&this._element){var d=this._unicodeService.getStringCellWidth(c),f=v%this._bufferService.cols,y=g+Math.floor(v/this._bufferService.cols),S=(f+d)%this._bufferService.cols,E=y+Math.floor((f+d)/this._bufferService.cols);S===0&&(S=this._bufferService.cols,E--),this._mouseZoneManager.add(new m(f+1,y+1,S+1,E+1,function(L){if(r.handler)return r.handler(L,c);var C=window.open();C?(C.opener=null,C.location.href=c):console.warn("Opening link blocked as opener could not be cleared")},function(){n._onShowLinkUnderline.fire(n._createLinkHoverEvent(f,y,S,E,i)),n._element.classList.add("xterm-cursor-pointer")},function(L){n._onLinkTooltip.fire(n._createLinkHoverEvent(f,y,S,E,i)),r.hoverTooltipCallback&&r.hoverTooltipCallback(L,c,{start:{x:f,y},end:{x:S,y:E}})},function(){n._onHideLinkUnderline.fire(n._createLinkHoverEvent(f,y,S,E,i)),n._element.classList.remove("xterm-cursor-pointer"),r.hoverLeaveCallback&&r.hoverLeaveCallback()},function(L){return!r.willLinkActivate||r.willLinkActivate(L,c)}))}},h.prototype._createLinkHoverEvent=function(v,g,c,r,i){return{x1:v,y1:g,x2:c,y2:r,cols:this._bufferService.cols,fg:i}},h._timeBeforeLatency=200,h=a([u(0,_.IBufferService),u(1,_.ILogService),u(2,_.IUnicodeService)],h)}();t.Linkifier=b;var m=function(h,v,g,c,r,i,n,d,f){this.x1=h,this.y1=v,this.x2=g,this.y2=c,this.clickCallback=r,this.hoverCallback=i,this.tooltipCallback=n,this.leaveCallback=d,this.willLinkActivate=f};t.MouseZone=m},6465:function(l,t,o){var a,u=this&&this.__extends||(a=function(c,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(i[d]=n[d])},a(c,r)},function(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=c}a(c,r),c.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}),p=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},_=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;var b=o(2585),m=o(8460),h=o(844),v=o(3656),g=function(c){function r(i){var n=c.call(this)||this;return n._bufferService=i,n._linkProviders=[],n._linkCacheDisposables=[],n._isMouseOut=!0,n._activeLine=-1,n._onShowLinkUnderline=n.register(new m.EventEmitter),n._onHideLinkUnderline=n.register(new m.EventEmitter),n.register((0,h.getDisposeArrayDisposable)(n._linkCacheDisposables)),n}return u(r,c),Object.defineProperty(r.prototype,"currentLink",{get:function(){return this._currentLink},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),r.prototype.registerLinkProvider=function(i){var n=this;return this._linkProviders.push(i),{dispose:function(){var d=n._linkProviders.indexOf(i);d!==-1&&n._linkProviders.splice(d,1)}}},r.prototype.attachToDom=function(i,n,d){var f=this;this._element=i,this._mouseService=n,this._renderService=d,this.register((0,v.addDisposableDomListener)(this._element,"mouseleave",function(){f._isMouseOut=!0,f._clearCurrentLink()})),this.register((0,v.addDisposableDomListener)(this._element,"mousemove",this._onMouseMove.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"click",this._onClick.bind(this)))},r.prototype._onMouseMove=function(i){if(this._lastMouseEvent=i,this._element&&this._mouseService){var n=this._positionFromMouseEvent(i,this._element,this._mouseService);if(n){this._isMouseOut=!1;for(var d=i.composedPath(),f=0;f<d.length;f++){var y=d[f];if(y.classList.contains("xterm"))break;if(y.classList.contains("xterm-hover"))return}this._lastBufferCell&&n.x===this._lastBufferCell.x&&n.y===this._lastBufferCell.y||(this._onHover(n),this._lastBufferCell=n)}}},r.prototype._onHover=function(i){if(this._activeLine!==i.y)return this._clearCurrentLink(),void this._askForLink(i,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,i)||(this._clearCurrentLink(),this._askForLink(i,!0))},r.prototype._askForLink=function(i,n){var d,f=this;this._activeProviderReplies&&n||((d=this._activeProviderReplies)===null||d===void 0||d.forEach(function(S){S==null||S.forEach(function(E){E.link.dispose&&E.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=i.y);var y=!1;this._linkProviders.forEach(function(S,E){var L;n?!((L=f._activeProviderReplies)===null||L===void 0)&&L.get(E)&&(y=f._checkLinkProviderResult(E,i,y)):S.provideLinks(i.y,function(C){var w,T;if(!f._isMouseOut){var A=C==null?void 0:C.map(function(H){return{link:H}});(w=f._activeProviderReplies)===null||w===void 0||w.set(E,A),y=f._checkLinkProviderResult(E,i,y),((T=f._activeProviderReplies)===null||T===void 0?void 0:T.size)===f._linkProviders.length&&f._removeIntersectingLinks(i.y,f._activeProviderReplies)}})})},r.prototype._removeIntersectingLinks=function(i,n){for(var d=new Set,f=0;f<n.size;f++){var y=n.get(f);if(y)for(var S=0;S<y.length;S++)for(var E=y[S],L=E.link.range.start.y<i?0:E.link.range.start.x,C=E.link.range.end.y>i?this._bufferService.cols:E.link.range.end.x,w=L;w<=C;w++){if(d.has(w)){y.splice(S--,1);break}d.add(w)}}},r.prototype._checkLinkProviderResult=function(i,n,d){var f,y=this;if(!this._activeProviderReplies)return d;for(var S=this._activeProviderReplies.get(i),E=!1,L=0;L<i;L++)this._activeProviderReplies.has(L)&&!this._activeProviderReplies.get(L)||(E=!0);if(!E&&S){var C=S.find(function(T){return y._linkAtPosition(T.link,n)});C&&(d=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviders.length&&!d)for(L=0;L<this._activeProviderReplies.size;L++){var w=(f=this._activeProviderReplies.get(L))===null||f===void 0?void 0:f.find(function(T){return y._linkAtPosition(T.link,n)});if(w){d=!0,this._handleNewLink(w);break}}return d},r.prototype._onClick=function(i){if(this._element&&this._mouseService&&this._currentLink){var n=this._positionFromMouseEvent(i,this._element,this._mouseService);n&&this._linkAtPosition(this._currentLink.link,n)&&this._currentLink.link.activate(i,this._currentLink.link.text)}},r.prototype._clearCurrentLink=function(i,n){this._element&&this._currentLink&&this._lastMouseEvent&&(!i||!n||this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=n)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,h.disposeArray)(this._linkCacheDisposables))},r.prototype._handleNewLink=function(i){var n=this;if(this._element&&this._lastMouseEvent&&this._mouseService){var d=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);d&&this._linkAtPosition(i.link,d)&&(this._currentLink=i,this._currentLink.state={decorations:{underline:i.link.decorations===void 0||i.link.decorations.underline,pointerCursor:i.link.decorations===void 0||i.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,i.link,this._lastMouseEvent),i.link.decorations={},Object.defineProperties(i.link.decorations,{pointerCursor:{get:function(){var f,y;return(y=(f=n._currentLink)===null||f===void 0?void 0:f.state)===null||y===void 0?void 0:y.decorations.pointerCursor},set:function(f){var y,S;((y=n._currentLink)===null||y===void 0?void 0:y.state)&&n._currentLink.state.decorations.pointerCursor!==f&&(n._currentLink.state.decorations.pointerCursor=f,n._currentLink.state.isHovered&&((S=n._element)===null||S===void 0||S.classList.toggle("xterm-cursor-pointer",f)))}},underline:{get:function(){var f,y;return(y=(f=n._currentLink)===null||f===void 0?void 0:f.state)===null||y===void 0?void 0:y.decorations.underline},set:function(f){var y,S,E;((y=n._currentLink)===null||y===void 0?void 0:y.state)&&((E=(S=n._currentLink)===null||S===void 0?void 0:S.state)===null||E===void 0?void 0:E.decorations.underline)!==f&&(n._currentLink.state.decorations.underline=f,n._currentLink.state.isHovered&&n._fireUnderlineEvent(i.link,f))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedBufferChange(function(f){var y=f.start===0?0:f.start+1+n._bufferService.buffer.ydisp;n._clearCurrentLink(y,f.end+1+n._bufferService.buffer.ydisp)})))}},r.prototype._linkHover=function(i,n,d){var f;!((f=this._currentLink)===null||f===void 0)&&f.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(n,!0),this._currentLink.state.decorations.pointerCursor&&i.classList.add("xterm-cursor-pointer")),n.hover&&n.hover(d,n.text)},r.prototype._fireUnderlineEvent=function(i,n){var d=i.range,f=this._bufferService.buffer.ydisp,y=this._createLinkUnderlineEvent(d.start.x-1,d.start.y-f-1,d.end.x,d.end.y-f-1,void 0);(n?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(y)},r.prototype._linkLeave=function(i,n,d){var f;!((f=this._currentLink)===null||f===void 0)&&f.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(n,!1),this._currentLink.state.decorations.pointerCursor&&i.classList.remove("xterm-cursor-pointer")),n.leave&&n.leave(d,n.text)},r.prototype._linkAtPosition=function(i,n){var d=i.range.start.y===i.range.end.y,f=i.range.start.y<n.y,y=i.range.end.y>n.y;return(d&&i.range.start.x<=n.x&&i.range.end.x>=n.x||f&&i.range.end.x>=n.x||y&&i.range.start.x<=n.x||f&&y)&&i.range.start.y<=n.y&&i.range.end.y>=n.y},r.prototype._positionFromMouseEvent=function(i,n,d){var f=d.getCoords(i,n,this._bufferService.cols,this._bufferService.rows);if(f)return{x:f[0],y:f[1]+this._bufferService.buffer.ydisp}},r.prototype._createLinkUnderlineEvent=function(i,n,d,f,y){return{x1:i,y1:n,x2:d,y2:f,cols:this._bufferService.cols,fg:y}},p([_(0,b.IBufferService)],r)}(h.Disposable);t.Linkifier2=g},9042:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},6954:function(l,t,o){var a,u=this&&this.__extends||(a=function(c,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(i[d]=n[d])},a(c,r)},function(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=c}a(c,r),c.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}),p=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},_=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseZoneManager=void 0;var b=o(844),m=o(3656),h=o(4725),v=o(2585),g=function(c){function r(i,n,d,f,y,S){var E=c.call(this)||this;return E._element=i,E._screenElement=n,E._bufferService=d,E._mouseService=f,E._selectionService=y,E._optionsService=S,E._zones=[],E._areZonesActive=!1,E._lastHoverCoords=[void 0,void 0],E._initialSelectionLength=0,E.register((0,m.addDisposableDomListener)(E._element,"mousedown",function(L){return E._onMouseDown(L)})),E._mouseMoveListener=function(L){return E._onMouseMove(L)},E._mouseLeaveListener=function(L){return E._onMouseLeave(L)},E._clickListener=function(L){return E._onClick(L)},E}return u(r,c),r.prototype.dispose=function(){c.prototype.dispose.call(this),this._deactivate()},r.prototype.add=function(i){this._zones.push(i),this._zones.length===1&&this._activate()},r.prototype.clearAll=function(i,n){if(this._zones.length!==0){i&&n||(i=0,n=this._bufferService.rows-1);for(var d=0;d<this._zones.length;d++){var f=this._zones[d];(f.y1>i&&f.y1<=n+1||f.y2>i&&f.y2<=n+1||f.y1<i&&f.y2>n+1)&&(this._currentZone&&this._currentZone===f&&(this._currentZone.leaveCallback(),this._currentZone=void 0),this._zones.splice(d--,1))}this._zones.length===0&&this._deactivate()}},r.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._element.addEventListener("mousemove",this._mouseMoveListener),this._element.addEventListener("mouseleave",this._mouseLeaveListener),this._element.addEventListener("click",this._clickListener))},r.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._element.removeEventListener("mousemove",this._mouseMoveListener),this._element.removeEventListener("mouseleave",this._mouseLeaveListener),this._element.removeEventListener("click",this._clickListener))},r.prototype._onMouseMove=function(i){this._lastHoverCoords[0]===i.pageX&&this._lastHoverCoords[1]===i.pageY||(this._onHover(i),this._lastHoverCoords=[i.pageX,i.pageY])},r.prototype._onHover=function(i){var n=this,d=this._findZoneEventAt(i);d!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),d&&(this._currentZone=d,d.hoverCallback&&d.hoverCallback(i),this._tooltipTimeout=window.setTimeout(function(){return n._onTooltip(i)},this._optionsService.rawOptions.linkTooltipHoverDuration)))},r.prototype._onTooltip=function(i){this._tooltipTimeout=void 0;var n=this._findZoneEventAt(i);n==null||n.tooltipCallback(i)},r.prototype._onMouseDown=function(i){if(this._initialSelectionLength=this._getSelectionLength(),this._areZonesActive){var n=this._findZoneEventAt(i);n!=null&&n.willLinkActivate(i)&&(i.preventDefault(),i.stopImmediatePropagation())}},r.prototype._onMouseLeave=function(i){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},r.prototype._onClick=function(i){var n=this._findZoneEventAt(i),d=this._getSelectionLength();n&&d===this._initialSelectionLength&&(n.clickCallback(i),i.preventDefault(),i.stopImmediatePropagation())},r.prototype._getSelectionLength=function(){var i=this._selectionService.selectionText;return i?i.length:0},r.prototype._findZoneEventAt=function(i){var n=this._mouseService.getCoords(i,this._screenElement,this._bufferService.cols,this._bufferService.rows);if(n)for(var d=n[0],f=n[1],y=0;y<this._zones.length;y++){var S=this._zones[y];if(S.y1===S.y2){if(f===S.y1&&d>=S.x1&&d<S.x2)return S}else if(f===S.y1&&d>=S.x1||f===S.y2&&d<S.x2||f>S.y1&&f<S.y2)return S}},p([_(2,v.IBufferService),_(3,h.IMouseService),_(4,h.ISelectionService),_(5,v.IOptionsService)],r)}(b.Disposable);t.MouseZoneManager=g},6193:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0;var o=function(){function a(u){this._renderCallback=u}return a.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},a.prototype.refresh=function(u,p,_){var b=this;this._rowCount=_,u=u!==void 0?u:0,p=p!==void 0?p:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,p):p,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){return b._innerRefresh()}))},a.prototype._innerRefresh=function(){if(this._rowStart!==void 0&&this._rowEnd!==void 0&&this._rowCount!==void 0){var u=Math.max(this._rowStart,0),p=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0,this._renderCallback(u,p)}},a}();t.RenderDebouncer=o},5596:function(l,t,o){var a,u=this&&this.__extends||(a=function(_,b){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,h){m.__proto__=h}||function(m,h){for(var v in h)Object.prototype.hasOwnProperty.call(h,v)&&(m[v]=h[v])},a(_,b)},function(_,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function m(){this.constructor=_}a(_,b),_.prototype=b===null?Object.create(b):(m.prototype=b.prototype,new m)});Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;var p=function(_){function b(){var m=_!==null&&_.apply(this,arguments)||this;return m._currentDevicePixelRatio=window.devicePixelRatio,m}return u(b,_),b.prototype.setListener=function(m){var h=this;this._listener&&this.clearListener(),this._listener=m,this._outerListener=function(){h._listener&&(h._listener(window.devicePixelRatio,h._currentDevicePixelRatio),h._updateDpr())},this._updateDpr()},b.prototype.dispose=function(){_.prototype.dispose.call(this),this.clearListener()},b.prototype._updateDpr=function(){var m;this._outerListener&&((m=this._resolutionMediaMatchList)===null||m===void 0||m.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},b.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},b}(o(844).Disposable);t.ScreenDprMonitor=p},3236:function(l,t,o){var a,u=this&&this.__extends||(a=function(R,N){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,B){P.__proto__=B}||function(P,B){for(var M in B)Object.prototype.hasOwnProperty.call(B,M)&&(P[M]=B[M])},a(R,N)},function(R,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");function P(){this.constructor=R}a(R,N),R.prototype=N===null?Object.create(N):(P.prototype=N.prototype,new P)});Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var p=o(2950),_=o(1680),b=o(3614),m=o(2584),h=o(5435),v=o(3525),g=o(3551),c=o(9312),r=o(6114),i=o(3656),n=o(9042),d=o(357),f=o(6954),y=o(4567),S=o(1296),E=o(7399),L=o(8460),C=o(8437),w=o(5680),T=o(3230),A=o(4725),H=o(428),O=o(8934),k=o(6465),x=o(5114),D=o(8969),I=o(4774),F=o(4269),W=o(5941),J=o(7641),$=typeof window!="undefined"?window.document:null,G=function(R){function N(P){P===void 0&&(P={});var B=R.call(this,P)||this;return B.browser=r,B._keyDownHandled=!1,B._keyPressHandled=!1,B._unprocessedDeadKey=!1,B._onCursorMove=new L.EventEmitter,B._onKey=new L.EventEmitter,B._onRender=new L.EventEmitter,B._onSelectionChange=new L.EventEmitter,B._onTitleChange=new L.EventEmitter,B._onBell=new L.EventEmitter,B._onFocus=new L.EventEmitter,B._onBlur=new L.EventEmitter,B._onA11yCharEmitter=new L.EventEmitter,B._onA11yTabEmitter=new L.EventEmitter,B._setup(),B.linkifier=B._instantiationService.createInstance(g.Linkifier),B.linkifier2=B.register(B._instantiationService.createInstance(k.Linkifier2)),B.decorationService=B.register(B._instantiationService.createInstance(J.DecorationService)),B.register(B._inputHandler.onRequestBell(function(){return B.bell()})),B.register(B._inputHandler.onRequestRefreshRows(function(M,K){return B.refresh(M,K)})),B.register(B._inputHandler.onRequestSendFocus(function(){return B._reportFocus()})),B.register(B._inputHandler.onRequestReset(function(){return B.reset()})),B.register(B._inputHandler.onRequestWindowsOptionsReport(function(M){return B._reportWindowsOptions(M)})),B.register(B._inputHandler.onColor(function(M){return B._handleColorEvent(M)})),B.register((0,L.forwardEvent)(B._inputHandler.onCursorMove,B._onCursorMove)),B.register((0,L.forwardEvent)(B._inputHandler.onTitleChange,B._onTitleChange)),B.register((0,L.forwardEvent)(B._inputHandler.onA11yChar,B._onA11yCharEmitter)),B.register((0,L.forwardEvent)(B._inputHandler.onA11yTab,B._onA11yTabEmitter)),B.register(B._bufferService.onResize(function(M){return B._afterResize(M.cols,M.rows)})),B}return u(N,R),Object.defineProperty(N.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onBell",{get:function(){return this._onBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onFocus",{get:function(){return this._onFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onBlur",{get:function(){return this._onBlur.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onA11yChar",{get:function(){return this._onA11yCharEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onA11yTab",{get:function(){return this._onA11yTabEmitter.event},enumerable:!1,configurable:!0}),N.prototype._handleColorEvent=function(P){var B,M;if(this._colorManager){for(var K=0,V=P;K<V.length;K++){var X=V[K],Y=void 0,Z="";switch(X.index){case 256:Y="foreground",Z="10";break;case 257:Y="background",Z="11";break;case 258:Y="cursor",Z="12";break;default:Y="ansi",Z="4;"+X.index}if(Y)switch(X.type){case 0:var fe=I.color.toColorRGB(Y==="ansi"?this._colorManager.colors.ansi[X.index]:this._colorManager.colors[Y]);this.coreService.triggerDataEvent(m.C0.ESC+"]"+Z+";"+(0,W.toRgbString)(fe)+m.C0.BEL);break;case 1:Y==="ansi"?this._colorManager.colors.ansi[X.index]=I.rgba.toColor.apply(I.rgba,X.color):this._colorManager.colors[Y]=I.rgba.toColor.apply(I.rgba,X.color);break;case 2:this._colorManager.restoreColor(X.index)}}(B=this._renderService)===null||B===void 0||B.setColors(this._colorManager.colors),(M=this.viewport)===null||M===void 0||M.onThemeChange(this._colorManager.colors)}},N.prototype.dispose=function(){var P,B,M;this._isDisposed||(R.prototype.dispose.call(this),(P=this._renderService)===null||P===void 0||P.dispose(),this._customKeyEventHandler=void 0,this.write=function(){},(M=(B=this.element)===null||B===void 0?void 0:B.parentNode)===null||M===void 0||M.removeChild(this.element))},N.prototype._setup=function(){R.prototype._setup.call(this),this._customKeyEventHandler=void 0},Object.defineProperty(N.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),N.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},N.prototype._updateOptions=function(P){var B,M,K,V;switch(R.prototype._updateOptions.call(this,P),P){case"fontFamily":case"fontSize":(B=this._renderService)===null||B===void 0||B.clear(),(M=this._charSizeService)===null||M===void 0||M.measure();break;case"cursorBlink":case"cursorStyle":this.refresh(this.buffer.y,this.buffer.y);break;case"customGlyphs":case"drawBoldTextInBrightColors":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":case"minimumContrastRatio":this._renderService&&(this._renderService.clear(),this._renderService.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderService&&(this._renderService.setRenderer(this._createRenderer()),this._renderService.onResize(this.cols,this.rows));break;case"scrollback":(K=this.viewport)===null||K===void 0||K.syncScrollArea();break;case"screenReaderMode":this.optionsService.rawOptions.screenReaderMode?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new y.AccessibilityManager(this,this._renderService)):((V=this._accessibilityManager)===null||V===void 0||V.dispose(),this._accessibilityManager=void 0);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"theme":this._setTheme(this.optionsService.rawOptions.theme)}},N.prototype._onTextAreaFocus=function(P){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(m.C0.ESC+"[I"),this.updateCursorStyle(P),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()},N.prototype.blur=function(){var P;return(P=this.textarea)===null||P===void 0?void 0:P.blur()},N.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(m.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()},N.prototype._syncTextArea=function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var P=this.buffer.ybase+this.buffer.y,B=this.buffer.lines.get(P);if(B){var M=Math.min(this.buffer.x,this.cols-1),K=this._renderService.dimensions.actualCellHeight,V=B.getWidth(M),X=this._renderService.dimensions.actualCellWidth*V,Y=this.buffer.y*this._renderService.dimensions.actualCellHeight,Z=M*this._renderService.dimensions.actualCellWidth;this.textarea.style.left=Z+"px",this.textarea.style.top=Y+"px",this.textarea.style.width=X+"px",this.textarea.style.height=K+"px",this.textarea.style.lineHeight=K+"px",this.textarea.style.zIndex="-5"}}},N.prototype._initGlobal=function(){var P=this;this._bindKeys(),this.register((0,i.addDisposableDomListener)(this.element,"copy",function(M){P.hasSelection()&&(0,b.copyHandler)(M,P._selectionService)}));var B=function(M){return(0,b.handlePasteEvent)(M,P.textarea,P.coreService)};this.register((0,i.addDisposableDomListener)(this.textarea,"paste",B)),this.register((0,i.addDisposableDomListener)(this.element,"paste",B)),r.isFirefox?this.register((0,i.addDisposableDomListener)(this.element,"mousedown",function(M){M.button===2&&(0,b.rightClickHandler)(M,P.textarea,P.screenElement,P._selectionService,P.options.rightClickSelectsWord)})):this.register((0,i.addDisposableDomListener)(this.element,"contextmenu",function(M){(0,b.rightClickHandler)(M,P.textarea,P.screenElement,P._selectionService,P.options.rightClickSelectsWord)})),r.isLinux&&this.register((0,i.addDisposableDomListener)(this.element,"auxclick",function(M){M.button===1&&(0,b.moveTextAreaUnderMouseCursor)(M,P.textarea,P.screenElement)}))},N.prototype._bindKeys=function(){var P=this;this.register((0,i.addDisposableDomListener)(this.textarea,"keyup",function(B){return P._keyUp(B)},!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keydown",function(B){return P._keyDown(B)},!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keypress",function(B){return P._keyPress(B)},!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionstart",function(){return P._compositionHelper.compositionstart()})),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionupdate",function(B){return P._compositionHelper.compositionupdate(B)})),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionend",function(){return P._compositionHelper.compositionend()})),this.register((0,i.addDisposableDomListener)(this.textarea,"input",function(B){return P._inputEvent(B)},!0)),this.register(this.onRender(function(){return P._compositionHelper.updateCompositionElements()})),this.register(this.onRender(function(B){return P._queueLinkification(B.start,B.end)}))},N.prototype.open=function(P){var B=this;if(!P)throw new Error("Terminal requires a parent element.");P.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=P.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),P.appendChild(this.element);var M=$.createDocumentFragment();this._viewportElement=$.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),M.appendChild(this._viewportElement),this._viewportScrollArea=$.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=$.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=$.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),M.appendChild(this.screenElement),this.textarea=$.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",n.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register((0,i.addDisposableDomListener)(this.textarea,"focus",function(X){return B._onTextAreaFocus(X)})),this.register((0,i.addDisposableDomListener)(this.textarea,"blur",function(){return B._onTextAreaBlur()})),this._helperContainer.appendChild(this.textarea);var K=this._instantiationService.createInstance(x.CoreBrowserService,this.textarea);this._instantiationService.setService(A.ICoreBrowserService,K),this._charSizeService=this._instantiationService.createInstance(H.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(A.ICharSizeService,this._charSizeService),this._theme=this.options.theme||this._theme,this._colorManager=new w.ColorManager($,this.options.allowTransparency),this.register(this.optionsService.onOptionChange(function(X){return B._colorManager.onOptionsChange(X)})),this._colorManager.setTheme(this._theme),this._characterJoinerService=this._instantiationService.createInstance(F.CharacterJoinerService),this._instantiationService.setService(A.ICharacterJoinerService,this._characterJoinerService);var V=this._createRenderer();this._renderService=this.register(this._instantiationService.createInstance(T.RenderService,V,this.rows,this.screenElement)),this._instantiationService.setService(A.IRenderService,this._renderService),this.register(this._renderService.onRenderedBufferChange(function(X){return B._onRender.fire(X)})),this.onResize(function(X){return B._renderService.resize(X.cols,X.rows)}),this._compositionView=$.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(p.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(M),this._soundService=this._instantiationService.createInstance(d.SoundService),this._instantiationService.setService(A.ISoundService,this._soundService),this._mouseService=this._instantiationService.createInstance(O.MouseService),this._instantiationService.setService(A.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(_.Viewport,function(X){return B.scrollLines(X,!0,1)},this._viewportElement,this._viewportScrollArea,this.element),this.viewport.onThemeChange(this._colorManager.colors),this.register(this._inputHandler.onRequestSyncScrollBar(function(){return B.viewport.syncScrollArea()})),this.register(this.viewport),this.register(this.onCursorMove(function(){B._renderService.onCursorMove(),B._syncTextArea()})),this.register(this.onResize(function(){return B._renderService.onResize(B.cols,B.rows)})),this.register(this.onBlur(function(){return B._renderService.onBlur()})),this.register(this.onFocus(function(){return B._renderService.onFocus()})),this.register(this._renderService.onDimensionsChange(function(){return B.viewport.syncScrollArea()})),this._selectionService=this.register(this._instantiationService.createInstance(c.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(A.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(function(X){return B.scrollLines(X.amount,X.suppressScrollEvent)})),this.register(this._selectionService.onSelectionChange(function(){return B._onSelectionChange.fire()})),this.register(this._selectionService.onRequestRedraw(function(X){return B._renderService.onSelectionChanged(X.start,X.end,X.columnSelectMode)})),this.register(this._selectionService.onLinuxMouseSelection(function(X){B.textarea.value=X,B.textarea.focus(),B.textarea.select()})),this.register(this._onScroll.event(function(X){B.viewport.syncScrollArea(),B._selectionService.refresh()})),this.register((0,i.addDisposableDomListener)(this._viewportElement,"scroll",function(){return B._selectionService.refresh()})),this._mouseZoneManager=this._instantiationService.createInstance(f.MouseZoneManager,this.element,this.screenElement),this.register(this._mouseZoneManager),this.register(this.onScroll(function(){return B._mouseZoneManager.clearAll()})),this.linkifier.attachToDom(this.element,this._mouseZoneManager),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.decorationService.attachToDom(this.screenElement,this._renderService,this._bufferService),this.register((0,i.addDisposableDomListener)(this.element,"mousedown",function(X){return B._selectionService.onMouseDown(X)})),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new y.AccessibilityManager(this,this._renderService)),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},N.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return this._instantiationService.createInstance(v.Renderer,this._colorManager.colors,this.screenElement,this.linkifier,this.linkifier2);case"dom":return this._instantiationService.createInstance(S.DomRenderer,this._colorManager.colors,this.element,this.screenElement,this._viewportElement,this.linkifier,this.linkifier2);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},N.prototype._setTheme=function(P){var B,M,K;this._theme=P,(B=this._colorManager)===null||B===void 0||B.setTheme(P),(M=this._renderService)===null||M===void 0||M.setColors(this._colorManager.colors),(K=this.viewport)===null||K===void 0||K.onThemeChange(this._colorManager.colors)},N.prototype.bindMouse=function(){var P=this,B=this,M=this.element;function K(z){var te,he,_e=B._mouseService.getRawByteCoords(z,B.screenElement,B.cols,B.rows);if(!_e)return!1;switch(z.overrideType||z.type){case"mousemove":he=32,z.buttons===void 0?(te=3,z.button!==void 0&&(te=z.button<3?z.button:3)):te=1&z.buttons?0:4&z.buttons?1:2&z.buttons?2:3;break;case"mouseup":he=0,te=z.button<3?z.button:3;break;case"mousedown":he=1,te=z.button<3?z.button:3;break;case"wheel":z.deltaY!==0&&(he=z.deltaY<0?0:1),te=4;break;default:return!1}return!(he===void 0||te===void 0||te>4)&&B.coreMouseService.triggerMouseEvent({col:_e.x-33,row:_e.y-33,button:te,action:he,ctrl:z.ctrlKey,alt:z.altKey,shift:z.shiftKey})}var V={mouseup:null,wheel:null,mousedrag:null,mousemove:null},X=function(z){return K(z),z.buttons||(P._document.removeEventListener("mouseup",V.mouseup),V.mousedrag&&P._document.removeEventListener("mousemove",V.mousedrag)),P.cancel(z)},Y=function(z){return K(z),P.cancel(z,!0)},Z=function(z){z.buttons&&K(z)},fe=function(z){z.buttons||K(z)};this.register(this.coreMouseService.onProtocolChange(function(z){z?(P.optionsService.rawOptions.logLevel==="debug"&&P._logService.debug("Binding to mouse events:",P.coreMouseService.explainEvents(z)),P.element.classList.add("enable-mouse-events"),P._selectionService.disable()):(P._logService.debug("Unbinding from mouse events."),P.element.classList.remove("enable-mouse-events"),P._selectionService.enable()),8&z?V.mousemove||(M.addEventListener("mousemove",fe),V.mousemove=fe):(M.removeEventListener("mousemove",V.mousemove),V.mousemove=null),16&z?V.wheel||(M.addEventListener("wheel",Y,{passive:!1}),V.wheel=Y):(M.removeEventListener("wheel",V.wheel),V.wheel=null),2&z?V.mouseup||(V.mouseup=X):(P._document.removeEventListener("mouseup",V.mouseup),V.mouseup=null),4&z?V.mousedrag||(V.mousedrag=Z):(P._document.removeEventListener("mousemove",V.mousedrag),V.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,i.addDisposableDomListener)(M,"mousedown",function(z){if(z.preventDefault(),P.focus(),P.coreMouseService.areMouseEventsActive&&!P._selectionService.shouldForceSelection(z))return K(z),V.mouseup&&P._document.addEventListener("mouseup",V.mouseup),V.mousedrag&&P._document.addEventListener("mousemove",V.mousedrag),P.cancel(z)})),this.register((0,i.addDisposableDomListener)(M,"wheel",function(z){if(!V.wheel){if(!P.buffer.hasScrollback){var te=P.viewport.getLinesScrolled(z);if(te===0)return;for(var he=m.C0.ESC+(P.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(z.deltaY<0?"A":"B"),_e="",Ue=0;Ue<Math.abs(te);Ue++)_e+=he;return P.coreService.triggerDataEvent(_e,!0),P.cancel(z,!0)}return P.viewport.onWheel(z)?P.cancel(z):void 0}},{passive:!1})),this.register((0,i.addDisposableDomListener)(M,"touchstart",function(z){if(!P.coreMouseService.areMouseEventsActive)return P.viewport.onTouchStart(z),P.cancel(z)},{passive:!0})),this.register((0,i.addDisposableDomListener)(M,"touchmove",function(z){if(!P.coreMouseService.areMouseEventsActive)return P.viewport.onTouchMove(z)?void 0:P.cancel(z)},{passive:!1}))},N.prototype.refresh=function(P,B){var M;(M=this._renderService)===null||M===void 0||M.refreshRows(P,B)},N.prototype._queueLinkification=function(P,B){var M;(M=this.linkifier)===null||M===void 0||M.linkifyRows(P,B)},N.prototype.updateCursorStyle=function(P){var B;!((B=this._selectionService)===null||B===void 0)&&B.shouldColumnSelect(P)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},N.prototype._showCursor=function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))},N.prototype.scrollLines=function(P,B,M){M===void 0&&(M=0),R.prototype.scrollLines.call(this,P,B,M),this.refresh(0,this.rows-1)},N.prototype.paste=function(P){(0,b.paste)(P,this.textarea,this.coreService)},N.prototype.attachCustomKeyEventHandler=function(P){this._customKeyEventHandler=P},N.prototype.registerLinkMatcher=function(P,B,M){var K=this.linkifier.registerLinkMatcher(P,B,M);return this.refresh(0,this.rows-1),K},N.prototype.deregisterLinkMatcher=function(P){this.linkifier.deregisterLinkMatcher(P)&&this.refresh(0,this.rows-1)},N.prototype.registerLinkProvider=function(P){return this.linkifier2.registerLinkProvider(P)},N.prototype.registerCharacterJoiner=function(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");var B=this._characterJoinerService.register(P);return this.refresh(0,this.rows-1),B},N.prototype.deregisterCharacterJoiner=function(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(P)&&this.refresh(0,this.rows-1)},Object.defineProperty(N.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!1,configurable:!0}),N.prototype.addMarker=function(P){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+P)},N.prototype.registerDecoration=function(P){return this.decorationService.registerDecoration(P)},N.prototype.hasSelection=function(){return!!this._selectionService&&this._selectionService.hasSelection},N.prototype.select=function(P,B,M){this._selectionService.setSelection(P,B,M)},N.prototype.getSelection=function(){return this._selectionService?this._selectionService.selectionText:""},N.prototype.getSelectionPosition=function(){if(this._selectionService&&this._selectionService.hasSelection)return{startColumn:this._selectionService.selectionStart[0],startRow:this._selectionService.selectionStart[1],endColumn:this._selectionService.selectionEnd[0],endRow:this._selectionService.selectionEnd[1]}},N.prototype.clearSelection=function(){var P;(P=this._selectionService)===null||P===void 0||P.clearSelection()},N.prototype.selectAll=function(){var P;(P=this._selectionService)===null||P===void 0||P.selectAll()},N.prototype.selectLines=function(P,B){var M;(M=this._selectionService)===null||M===void 0||M.selectLines(P,B)},N.prototype._keyDown=function(P){if(this._keyDownHandled=!1,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;if(!this._compositionHelper.keydown(P))return this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;P.key!=="Dead"&&P.key!=="AltGraph"||(this._unprocessedDeadKey=!0);var B=(0,E.evaluateKeyboardEvent)(P,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(P),B.type===3||B.type===2){var M=this.rows-1;return this.scrollLines(B.type===2?-M:M),this.cancel(P,!0)}return B.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,P)||(B.cancel&&this.cancel(P,!0),!B.key||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(B.key!==m.C0.ETX&&B.key!==m.C0.CR||(this.textarea.value=""),this._onKey.fire({key:B.key,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(B.key,!0),this.optionsService.rawOptions.screenReaderMode?void(this._keyDownHandled=!0):this.cancel(P,!0))))},N.prototype._isThirdLevelShift=function(P,B){var M=P.isMac&&!this.options.macOptionIsMeta&&B.altKey&&!B.ctrlKey&&!B.metaKey||P.isWindows&&B.altKey&&B.ctrlKey&&!B.metaKey||P.isWindows&&B.getModifierState("AltGraph");return B.type==="keypress"?M:M&&(!B.keyCode||B.keyCode>47)},N.prototype._keyUp=function(P){this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1||(function(B){return B.keyCode===16||B.keyCode===17||B.keyCode===18}(P)||this.focus(),this.updateCursorStyle(P),this._keyPressHandled=!1)},N.prototype._keyPress=function(P){var B;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;if(this.cancel(P),P.charCode)B=P.charCode;else if(P.which===null||P.which===void 0)B=P.keyCode;else{if(P.which===0||P.charCode===0)return!1;B=P.which}return!(!B||(P.altKey||P.ctrlKey||P.metaKey)&&!this._isThirdLevelShift(this.browser,P)||(B=String.fromCharCode(B),this._onKey.fire({key:B,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(B,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))},N.prototype._inputEvent=function(P){if(P.data&&P.inputType==="insertText"&&!P.composed&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;var B=P.data;return this.coreService.triggerDataEvent(B,!0),this.cancel(P),!0}return!1},N.prototype.bell=function(){var P;this._soundBell()&&((P=this._soundService)===null||P===void 0||P.playBellSound()),this._onBell.fire()},N.prototype.resize=function(P,B){P!==this.cols||B!==this.rows?R.prototype.resize.call(this,P,B):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()},N.prototype._afterResize=function(P,B){var M,K;(M=this._charSizeService)===null||M===void 0||M.measure(),(K=this.viewport)===null||K===void 0||K.syncScrollArea(!0)},N.prototype.clear=function(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var P=1;P<this.rows;P++)this.buffer.lines.push(this.buffer.getBlankLine(C.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}},N.prototype.reset=function(){var P,B;this.options.rows=this.rows,this.options.cols=this.cols;var M=this._customKeyEventHandler;this._setup(),R.prototype.reset.call(this),(P=this._selectionService)===null||P===void 0||P.reset(),this._customKeyEventHandler=M,this.refresh(0,this.rows-1),(B=this.viewport)===null||B===void 0||B.syncScrollArea()},N.prototype.clearTextureAtlas=function(){var P;(P=this._renderService)===null||P===void 0||P.clearTextureAtlas()},N.prototype._reportFocus=function(){var P;!((P=this.element)===null||P===void 0)&&P.classList.contains("focus")?this.coreService.triggerDataEvent(m.C0.ESC+"[I"):this.coreService.triggerDataEvent(m.C0.ESC+"[O")},N.prototype._reportWindowsOptions=function(P){if(this._renderService)switch(P){case h.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var B=this._renderService.dimensions.scaledCanvasWidth.toFixed(0),M=this._renderService.dimensions.scaledCanvasHeight.toFixed(0);this.coreService.triggerDataEvent(m.C0.ESC+"[4;"+M+";"+B+"t");break;case h.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var K=this._renderService.dimensions.scaledCellWidth.toFixed(0),V=this._renderService.dimensions.scaledCellHeight.toFixed(0);this.coreService.triggerDataEvent(m.C0.ESC+"[6;"+V+";"+K+"t")}},N.prototype.cancel=function(P,B){if(this.options.cancelEvents||B)return P.preventDefault(),P.stopPropagation(),!1},N.prototype._visualBell=function(){return!1},N.prototype._soundBell=function(){return this.options.bellStyle==="sound"},N}(D.CoreTerminal);t.Terminal=G},9924:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0;var o=function(){function a(u,p){p===void 0&&(p=1e3),this._renderCallback=u,this._debounceThresholdMS=p,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return a.prototype.dispose=function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)},a.prototype.refresh=function(u,p,_){var b=this;this._rowCount=_,u=u!==void 0?u:0,p=p!==void 0?p:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,p):p;var m=Date.now();if(m-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=m,this._innerRefresh();else if(!this._additionalRefreshRequested){var h=m-this._lastRefreshMs,v=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(function(){b._lastRefreshMs=Date.now(),b._innerRefresh(),b._additionalRefreshRequested=!1,b._refreshTimeoutID=void 0},v)}},a.prototype._innerRefresh=function(){if(this._rowStart!==void 0&&this._rowEnd!==void 0&&this._rowCount!==void 0){var u=Math.max(this._rowStart,0),p=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,p)}},a}();t.TimeBasedDebouncer=o},1680:function(l,t,o){var a,u=this&&this.__extends||(a=function(c,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(i[d]=n[d])},a(c,r)},function(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=c}a(c,r),c.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}),p=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},_=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var b=o(844),m=o(3656),h=o(4725),v=o(2585),g=function(c){function r(i,n,d,f,y,S,E,L){var C=c.call(this)||this;return C._scrollLines=i,C._viewportElement=n,C._scrollArea=d,C._element=f,C._bufferService=y,C._optionsService=S,C._charSizeService=E,C._renderService=L,C.scrollBarWidth=0,C._currentRowHeight=0,C._currentScaledCellHeight=0,C._lastRecordedBufferLength=0,C._lastRecordedViewportHeight=0,C._lastRecordedBufferHeight=0,C._lastTouchY=0,C._lastScrollTop=0,C._lastHadScrollBar=!1,C._wheelPartialScroll=0,C._refreshAnimationFrame=null,C._ignoreNextScrollEvent=!1,C.scrollBarWidth=C._viewportElement.offsetWidth-C._scrollArea.offsetWidth||15,C._lastHadScrollBar=!0,C.register((0,m.addDisposableDomListener)(C._viewportElement,"scroll",C._onScroll.bind(C))),C._activeBuffer=C._bufferService.buffer,C.register(C._bufferService.buffers.onBufferActivate(function(w){return C._activeBuffer=w.activeBuffer})),C._renderDimensions=C._renderService.dimensions,C.register(C._renderService.onDimensionsChange(function(w){return C._renderDimensions=w})),setTimeout(function(){return C.syncScrollArea()},0),C}return u(r,c),r.prototype.onThemeChange=function(i){this._viewportElement.style.backgroundColor=i.background.css},r.prototype._refresh=function(i){var n=this;if(i)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=requestAnimationFrame(function(){return n._innerRefresh()}))},r.prototype._innerRefresh=function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.scaledCellHeight/window.devicePixelRatio,this._currentScaledCellHeight=this._renderService.dimensions.scaledCellHeight,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var i=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.canvasHeight);this._lastRecordedBufferHeight!==i&&(this._lastRecordedBufferHeight=i,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var n=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==n&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=n),this._optionsService.rawOptions.scrollback===0?this.scrollBarWidth=0:this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this._lastHadScrollBar=this.scrollBarWidth>0;var d=window.getComputedStyle(this._element),f=parseInt(d.paddingLeft)+parseInt(d.paddingRight);this._viewportElement.style.width=(this._renderService.dimensions.actualCellWidth*this._bufferService.cols+this.scrollBarWidth+(this._lastHadScrollBar?f:0)).toString()+"px",this._refreshAnimationFrame=null},r.prototype.syncScrollArea=function(i){if(i===void 0&&(i=!1),this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(i);this._lastRecordedViewportHeight===this._renderService.dimensions.canvasHeight&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.scaledCellHeight===this._currentScaledCellHeight?this._lastHadScrollBar!==this._optionsService.rawOptions.scrollback>0&&this._refresh(i):this._refresh(i)},r.prototype._onScroll=function(i){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);var n=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(n)}},r.prototype._bubbleScroll=function(i,n){var d=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(n<0&&this._viewportElement.scrollTop!==0||n>0&&d<this._lastRecordedBufferHeight)||(i.cancelable&&i.preventDefault(),!1)},r.prototype.onWheel=function(i){var n=this._getPixelsScrolled(i);return n!==0&&(this._viewportElement.scrollTop+=n,this._bubbleScroll(i,n))},r.prototype._getPixelsScrolled=function(i){if(i.deltaY===0||i.shiftKey)return 0;var n=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_LINE?n*=this._currentRowHeight:i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=this._currentRowHeight*this._bufferService.rows),n},r.prototype.getLinesScrolled=function(i){if(i.deltaY===0||i.shiftKey)return 0;var n=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(n/=this._currentRowHeight+0,this._wheelPartialScroll+=n,n=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=this._bufferService.rows),n},r.prototype._applyScrollModifier=function(i,n){var d=this._optionsService.rawOptions.fastScrollModifier;return d==="alt"&&n.altKey||d==="ctrl"&&n.ctrlKey||d==="shift"&&n.shiftKey?i*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:i*this._optionsService.rawOptions.scrollSensitivity},r.prototype.onTouchStart=function(i){this._lastTouchY=i.touches[0].pageY},r.prototype.onTouchMove=function(i){var n=this._lastTouchY-i.touches[0].pageY;return this._lastTouchY=i.touches[0].pageY,n!==0&&(this._viewportElement.scrollTop+=n,this._bubbleScroll(i,n))},p([_(4,v.IBufferService),_(5,v.IOptionsService),_(6,h.ICharSizeService),_(7,h.IRenderService)],r)}(b.Disposable);t.Viewport=g},2950:function(l,t,o){var a=this&&this.__decorate||function(m,h,v,g){var c,r=arguments.length,i=r<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,v):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(m,h,v,g);else for(var n=m.length-1;n>=0;n--)(c=m[n])&&(i=(r<3?c(i):r>3?c(h,v,i):c(h,v))||i);return r>3&&i&&Object.defineProperty(h,v,i),i},u=this&&this.__param||function(m,h){return function(v,g){h(v,g,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;var p=o(4725),_=o(2585),b=function(){function m(h,v,g,c,r,i){this._textarea=h,this._compositionView=v,this._bufferService=g,this._optionsService=c,this._coreService=r,this._renderService=i,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return Object.defineProperty(m.prototype,"isComposing",{get:function(){return this._isComposing},enumerable:!1,configurable:!0}),m.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")},m.prototype.compositionupdate=function(h){var v=this;this._compositionView.textContent=h.data,this.updateCompositionElements(),setTimeout(function(){v._compositionPosition.end=v._textarea.value.length},0)},m.prototype.compositionend=function(){this._finalizeComposition(!0)},m.prototype.keydown=function(h){if(this._isComposing||this._isSendingComposition){if(h.keyCode===229||h.keyCode===16||h.keyCode===17||h.keyCode===18)return!1;this._finalizeComposition(!1)}return h.keyCode!==229||(this._handleAnyTextareaChanges(),!1)},m.prototype._finalizeComposition=function(h){var v=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,h){var g={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(function(){if(v._isSendingComposition){v._isSendingComposition=!1;var r;g.start+=v._dataAlreadySent.length,(r=v._isComposing?v._textarea.value.substring(g.start,g.end):v._textarea.value.substring(g.start)).length>0&&v._coreService.triggerDataEvent(r,!0)}},0)}else{this._isSendingComposition=!1;var c=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(c,!0)}},m.prototype._handleAnyTextareaChanges=function(){var h=this,v=this._textarea.value;setTimeout(function(){if(!h._isComposing){var g=h._textarea.value.replace(v,"");g.length>0&&(h._dataAlreadySent=g,h._coreService.triggerDataEvent(g,!0))}},0)},m.prototype.updateCompositionElements=function(h){var v=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var g=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),c=this._renderService.dimensions.actualCellHeight,r=this._bufferService.buffer.y*this._renderService.dimensions.actualCellHeight,i=g*this._renderService.dimensions.actualCellWidth;this._compositionView.style.left=i+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=c+"px",this._compositionView.style.lineHeight=c+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var n=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(n.width,1)+"px",this._textarea.style.height=Math.max(n.height,1)+"px",this._textarea.style.lineHeight=n.height+"px"}h||setTimeout(function(){return v.updateCompositionElements(!0)},0)}},a([u(2,_.IBufferService),u(3,_.IOptionsService),u(4,_.ICoreService),u(5,p.IRenderService)],m)}();t.CompositionHelper=b},9806:(l,t)=>{function o(a,u){var p=u.getBoundingClientRect();return[a.clientX-p.left,a.clientY-p.top]}Object.defineProperty(t,"__esModule",{value:!0}),t.getRawByteCoords=t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=o,t.getCoords=function(a,u,p,_,b,m,h,v){if(b){var g=o(a,u);if(g)return g[0]=Math.ceil((g[0]+(v?m/2:0))/m),g[1]=Math.ceil(g[1]/h),g[0]=Math.min(Math.max(g[0],1),p+(v?1:0)),g[1]=Math.min(Math.max(g[1],1),_),g}},t.getRawByteCoords=function(a){if(a)return{x:a[0]+32,y:a[1]+32}}},9504:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;var a=o(2584);function u(v,g,c,r){var i=v-p(c,v),n=g-p(c,g),d=Math.abs(i-n)-function(f,y,S){for(var E=0,L=f-p(S,f),C=y-p(S,y),w=0;w<Math.abs(L-C);w++){var T=_(f,y)==="A"?-1:1,A=S.buffer.lines.get(L+T*w);A!=null&&A.isWrapped&&E++}return E}(v,g,c);return h(d,m(_(v,g),r))}function p(v,g){for(var c=0,r=v.buffer.lines.get(g),i=r==null?void 0:r.isWrapped;i&&g>=0&&g<v.rows;)c++,i=(r=v.buffer.lines.get(--g))==null?void 0:r.isWrapped;return c}function _(v,g){return v>g?"A":"B"}function b(v,g,c,r,i,n){for(var d=v,f=g,y="";d!==c||f!==r;)d+=i?1:-1,i&&d>n.cols-1?(y+=n.buffer.translateBufferLineToString(f,!1,v,d),d=0,v=0,f++):!i&&d<0&&(y+=n.buffer.translateBufferLineToString(f,!1,0,v+1),v=d=n.cols-1,f--);return y+n.buffer.translateBufferLineToString(f,!1,v,d)}function m(v,g){var c=g?"O":"[";return a.C0.ESC+c+v}function h(v,g){v=Math.floor(v);for(var c="",r=0;r<v;r++)c+=g;return c}t.moveToCellSequence=function(v,g,c,r){var i,n=c.buffer.x,d=c.buffer.y;if(!c.buffer.hasScrollback)return function(y,S,E,L,C,w){return u(S,L,C,w).length===0?"":h(b(y,S,y,S-p(C,S),!1,C).length,m("D",w))}(n,d,0,g,c,r)+u(d,g,c,r)+function(y,S,E,L,C,w){var T;T=u(S,L,C,w).length>0?L-p(C,L):S;var A=L,H=function(O,k,x,D,I,F){var W;return W=u(x,D,I,F).length>0?D-p(I,D):k,O<x&&W<=D||O>=x&&W<D?"C":"D"}(y,S,E,L,C,w);return h(b(y,T,E,A,H==="C",C).length,m(H,w))}(n,d,v,g,c,r);if(d===g)return i=n>v?"D":"C",h(Math.abs(n-v),m(i,r));i=d>g?"D":"C";var f=Math.abs(d-g);return h(function(y,S){return S.cols-y}(d>g?v:n,c)+(f-1)*c.cols+1+((d>g?n:v)-1),m(i,r))}},4389:function(l,t,o){var a=this&&this.__assign||function(){return a=Object.assign||function(c){for(var r,i=1,n=arguments.length;i<n;i++)for(var d in r=arguments[i])Object.prototype.hasOwnProperty.call(r,d)&&(c[d]=r[d]);return c},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var u=o(3236),p=o(9042),_=o(7975),b=o(7090),m=o(5741),h=o(8285),v=["cols","rows"],g=function(){function c(r){var i=this;this._core=new u.Terminal(r),this._addonManager=new m.AddonManager,this._publicOptions=a({},this._core.options);var n=function(S){return i._core.options[S]},d=function(S,E){i._checkReadonlyOptions(S),i._core.options[S]=E};for(var f in this._core.options){var y={get:n.bind(this,f),set:d.bind(this,f)};Object.defineProperty(this._publicOptions,f,y)}}return c.prototype._checkReadonlyOptions=function(r){if(v.includes(r))throw new Error('Option "'+r+'" can only be set in the constructor')},c.prototype._checkProposedApi=function(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")},Object.defineProperty(c.prototype,"onBell",{get:function(){return this._core.onBell},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onBinary",{get:function(){return this._core.onBinary},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onData",{get:function(){return this._core.onData},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"element",{get:function(){return this._core.element},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"parser",{get:function(){return this._checkProposedApi(),this._parser||(this._parser=new _.ParserApi(this._core)),this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"unicode",{get:function(){return this._checkProposedApi(),new b.UnicodeApi(this._core)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"rows",{get:function(){return this._core.rows},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"cols",{get:function(){return this._core.cols},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"buffer",{get:function(){return this._checkProposedApi(),this._buffer||(this._buffer=new h.BufferNamespaceApi(this._core)),this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"markers",{get:function(){return this._checkProposedApi(),this._core.markers},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"modes",{get:function(){var r=this._core.coreService.decPrivateModes,i="none";switch(this._core.coreMouseService.activeProtocol){case"X10":i="x10";break;case"VT200":i="vt200";break;case"DRAG":i="drag";break;case"ANY":i="any"}return{applicationCursorKeysMode:r.applicationCursorKeys,applicationKeypadMode:r.applicationKeypad,bracketedPasteMode:r.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:i,originMode:r.origin,reverseWraparoundMode:r.reverseWraparound,sendFocusMode:r.sendFocus,wraparoundMode:r.wraparound}},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"options",{get:function(){return this._publicOptions},set:function(r){for(var i in r)this._publicOptions[i]=r[i]},enumerable:!1,configurable:!0}),c.prototype.blur=function(){this._core.blur()},c.prototype.focus=function(){this._core.focus()},c.prototype.resize=function(r,i){this._verifyIntegers(r,i),this._core.resize(r,i)},c.prototype.open=function(r){this._core.open(r)},c.prototype.attachCustomKeyEventHandler=function(r){this._core.attachCustomKeyEventHandler(r)},c.prototype.registerLinkMatcher=function(r,i,n){return this._checkProposedApi(),this._core.registerLinkMatcher(r,i,n)},c.prototype.deregisterLinkMatcher=function(r){this._checkProposedApi(),this._core.deregisterLinkMatcher(r)},c.prototype.registerLinkProvider=function(r){return this._checkProposedApi(),this._core.registerLinkProvider(r)},c.prototype.registerCharacterJoiner=function(r){return this._checkProposedApi(),this._core.registerCharacterJoiner(r)},c.prototype.deregisterCharacterJoiner=function(r){this._checkProposedApi(),this._core.deregisterCharacterJoiner(r)},c.prototype.registerMarker=function(r){return r===void 0&&(r=0),this._checkProposedApi(),this._verifyIntegers(r),this._core.addMarker(r)},c.prototype.registerDecoration=function(r){var i,n,d;return this._checkProposedApi(),this._verifyPositiveIntegers((i=r.x)!==null&&i!==void 0?i:0,(n=r.width)!==null&&n!==void 0?n:0,(d=r.height)!==null&&d!==void 0?d:0),this._core.registerDecoration(r)},c.prototype.addMarker=function(r){return this.registerMarker(r)},c.prototype.hasSelection=function(){return this._core.hasSelection()},c.prototype.select=function(r,i,n){this._verifyIntegers(r,i,n),this._core.select(r,i,n)},c.prototype.getSelection=function(){return this._core.getSelection()},c.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},c.prototype.clearSelection=function(){this._core.clearSelection()},c.prototype.selectAll=function(){this._core.selectAll()},c.prototype.selectLines=function(r,i){this._verifyIntegers(r,i),this._core.selectLines(r,i)},c.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},c.prototype.scrollLines=function(r){this._verifyIntegers(r),this._core.scrollLines(r)},c.prototype.scrollPages=function(r){this._verifyIntegers(r),this._core.scrollPages(r)},c.prototype.scrollToTop=function(){this._core.scrollToTop()},c.prototype.scrollToBottom=function(){this._core.scrollToBottom()},c.prototype.scrollToLine=function(r){this._verifyIntegers(r),this._core.scrollToLine(r)},c.prototype.clear=function(){this._core.clear()},c.prototype.write=function(r,i){this._core.write(r,i)},c.prototype.writeUtf8=function(r,i){this._core.write(r,i)},c.prototype.writeln=function(r,i){this._core.write(r),this._core.write(`\r
`,i)},c.prototype.paste=function(r){this._core.paste(r)},c.prototype.getOption=function(r){return this._core.optionsService.getOption(r)},c.prototype.setOption=function(r,i){this._checkReadonlyOptions(r),this._core.optionsService.setOption(r,i)},c.prototype.refresh=function(r,i){this._verifyIntegers(r,i),this._core.refresh(r,i)},c.prototype.reset=function(){this._core.reset()},c.prototype.clearTextureAtlas=function(){this._core.clearTextureAtlas()},c.prototype.loadAddon=function(r){return this._addonManager.loadAddon(this,r)},Object.defineProperty(c,"strings",{get:function(){return p},enumerable:!1,configurable:!0}),c.prototype._verifyIntegers=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var n=0,d=r;n<d.length;n++){var f=d[n];if(f===1/0||isNaN(f)||f%1!=0)throw new Error("This API only accepts integers")}},c.prototype._verifyPositiveIntegers=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var n=0,d=r;n<d.length;n++){var f=d[n];if(f&&(f===1/0||isNaN(f)||f%1!=0||f<0))throw new Error("This API only accepts positive integers")}},c}();t.Terminal=g},1546:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var a=o(643),u=o(8803),p=o(1420),_=o(3734),b=o(1752),m=o(4774),h=o(9631),v=o(8978),g=function(){function c(r,i,n,d,f,y,S,E){this._container=r,this._alpha=d,this._colors=f,this._rendererId=y,this._bufferService=S,this._optionsService=E,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+i+"-layer"),this._canvas.style.zIndex=n.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return c.prototype.dispose=function(){var r;(0,h.removeElementFromParent)(this._canvas),(r=this._charAtlas)===null||r===void 0||r.dispose()},c.prototype._initCanvas=function(){this._ctx=(0,b.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},c.prototype.onOptionsChanged=function(){},c.prototype.onBlur=function(){},c.prototype.onFocus=function(){},c.prototype.onCursorMove=function(){},c.prototype.onGridChanged=function(r,i){},c.prototype.onSelectionChanged=function(r,i,n){n===void 0&&(n=!1)},c.prototype.setColors=function(r){this._refreshCharAtlas(r)},c.prototype._setTransparency=function(r){if(r!==this._alpha){var i=this._canvas;this._alpha=r,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,i),this._refreshCharAtlas(this._colors),this.onGridChanged(0,this._bufferService.rows-1)}},c.prototype._refreshCharAtlas=function(r){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=(0,p.acquireCharAtlas)(this._optionsService.rawOptions,this._rendererId,r,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},c.prototype.resize=function(r){this._scaledCellWidth=r.scaledCellWidth,this._scaledCellHeight=r.scaledCellHeight,this._scaledCharWidth=r.scaledCharWidth,this._scaledCharHeight=r.scaledCharHeight,this._scaledCharLeft=r.scaledCharLeft,this._scaledCharTop=r.scaledCharTop,this._canvas.width=r.scaledCanvasWidth,this._canvas.height=r.scaledCanvasHeight,this._canvas.style.width=r.canvasWidth+"px",this._canvas.style.height=r.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(this._colors)},c.prototype.clearTextureAtlas=function(){var r;(r=this._charAtlas)===null||r===void 0||r.clear()},c.prototype._fillCells=function(r,i,n,d){this._ctx.fillRect(r*this._scaledCellWidth,i*this._scaledCellHeight,n*this._scaledCellWidth,d*this._scaledCellHeight)},c.prototype._fillMiddleLineAtCells=function(r,i,n){n===void 0&&(n=1);var d=Math.ceil(.5*this._scaledCellHeight);this._ctx.fillRect(r*this._scaledCellWidth,(i+1)*this._scaledCellHeight-d-window.devicePixelRatio,n*this._scaledCellWidth,window.devicePixelRatio)},c.prototype._fillBottomLineAtCells=function(r,i,n){n===void 0&&(n=1),this._ctx.fillRect(r*this._scaledCellWidth,(i+1)*this._scaledCellHeight-window.devicePixelRatio-1,n*this._scaledCellWidth,window.devicePixelRatio)},c.prototype._fillLeftLineAtCell=function(r,i,n){this._ctx.fillRect(r*this._scaledCellWidth,i*this._scaledCellHeight,window.devicePixelRatio*n,this._scaledCellHeight)},c.prototype._strokeRectAtCell=function(r,i,n,d){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(r*this._scaledCellWidth+window.devicePixelRatio/2,i*this._scaledCellHeight+window.devicePixelRatio/2,n*this._scaledCellWidth-window.devicePixelRatio,d*this._scaledCellHeight-window.devicePixelRatio)},c.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},c.prototype._clearCells=function(r,i,n,d){this._alpha?this._ctx.clearRect(r*this._scaledCellWidth,i*this._scaledCellHeight,n*this._scaledCellWidth,d*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(r*this._scaledCellWidth,i*this._scaledCellHeight,n*this._scaledCellWidth,d*this._scaledCellHeight))},c.prototype._fillCharTrueColor=function(r,i,n){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=u.TEXT_BASELINE,this._clipRow(n);var d=!1;this._optionsService.rawOptions.customGlyphs!==!1&&(d=(0,v.tryDrawCustomChar)(this._ctx,r.getChars(),i*this._scaledCellWidth,n*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),d||this._ctx.fillText(r.getChars(),i*this._scaledCellWidth+this._scaledCharLeft,n*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},c.prototype._drawChars=function(r,i,n){var d,f,y,S=this._getContrastColor(r);S||r.isFgRGB()||r.isBgRGB()?this._drawUncachedChars(r,i,n,S):(r.isInverse()?(f=r.isBgDefault()?u.INVERTED_DEFAULT_COLOR:r.getBgColor(),y=r.isFgDefault()?u.INVERTED_DEFAULT_COLOR:r.getFgColor()):(y=r.isBgDefault()?a.DEFAULT_COLOR:r.getBgColor(),f=r.isFgDefault()?a.DEFAULT_COLOR:r.getFgColor()),f+=this._optionsService.rawOptions.drawBoldTextInBrightColors&&r.isBold()&&f<8?8:0,this._currentGlyphIdentifier.chars=r.getChars()||a.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=r.getCode()||a.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=y,this._currentGlyphIdentifier.fg=f,this._currentGlyphIdentifier.bold=!!r.isBold(),this._currentGlyphIdentifier.dim=!!r.isDim(),this._currentGlyphIdentifier.italic=!!r.isItalic(),!((d=this._charAtlas)===null||d===void 0)&&d.draw(this._ctx,this._currentGlyphIdentifier,i*this._scaledCellWidth+this._scaledCharLeft,n*this._scaledCellHeight+this._scaledCharTop)||this._drawUncachedChars(r,i,n))},c.prototype._drawUncachedChars=function(r,i,n,d){if(this._ctx.save(),this._ctx.font=this._getFont(!!r.isBold(),!!r.isItalic()),this._ctx.textBaseline=u.TEXT_BASELINE,r.isInverse())if(d)this._ctx.fillStyle=d.css;else if(r.isBgDefault())this._ctx.fillStyle=m.color.opaque(this._colors.background).css;else if(r.isBgRGB())this._ctx.fillStyle="rgb("+_.AttributeData.toColorRGB(r.getBgColor()).join(",")+")";else{var f=r.getBgColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&r.isBold()&&f<8&&(f+=8),this._ctx.fillStyle=this._colors.ansi[f].css}else if(d)this._ctx.fillStyle=d.css;else if(r.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(r.isFgRGB())this._ctx.fillStyle="rgb("+_.AttributeData.toColorRGB(r.getFgColor()).join(",")+")";else{var y=r.getFgColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&r.isBold()&&y<8&&(y+=8),this._ctx.fillStyle=this._colors.ansi[y].css}this._clipRow(n),r.isDim()&&(this._ctx.globalAlpha=u.DIM_OPACITY);var S=!1;this._optionsService.rawOptions.customGlyphs!==!1&&(S=(0,v.tryDrawCustomChar)(this._ctx,r.getChars(),i*this._scaledCellWidth,n*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),S||this._ctx.fillText(r.getChars(),i*this._scaledCellWidth+this._scaledCharLeft,n*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight),this._ctx.restore()},c.prototype._clipRow=function(r){this._ctx.beginPath(),this._ctx.rect(0,r*this._scaledCellHeight,this._bufferService.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},c.prototype._getFont=function(r,i){return(i?"italic":"")+" "+(r?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight)+" "+this._optionsService.rawOptions.fontSize*window.devicePixelRatio+"px "+this._optionsService.rawOptions.fontFamily},c.prototype._getContrastColor=function(r){if(this._optionsService.rawOptions.minimumContrastRatio!==1){var i=this._colors.contrastCache.getColor(r.bg,r.fg);if(i!==void 0)return i||void 0;var n=r.getFgColor(),d=r.getFgColorMode(),f=r.getBgColor(),y=r.getBgColorMode(),S=!!r.isInverse(),E=!!r.isInverse();if(S){var L=n;n=f,f=L;var C=d;d=y,y=C}var w=this._resolveBackgroundRgba(y,f,S),T=this._resolveForegroundRgba(d,n,S,E),A=m.rgba.ensureContrastRatio(w,T,this._optionsService.rawOptions.minimumContrastRatio);if(A){var H={css:m.channels.toCss(A>>24&255,A>>16&255,A>>8&255),rgba:A};return this._colors.contrastCache.setColor(r.bg,r.fg,H),H}this._colors.contrastCache.setColor(r.bg,r.fg,null)}},c.prototype._resolveBackgroundRgba=function(r,i,n){switch(r){case 16777216:case 33554432:return this._colors.ansi[i].rgba;case 50331648:return i<<8;default:return n?this._colors.foreground.rgba:this._colors.background.rgba}},c.prototype._resolveForegroundRgba=function(r,i,n,d){switch(r){case 16777216:case 33554432:return this._optionsService.rawOptions.drawBoldTextInBrightColors&&d&&i<8&&(i+=8),this._colors.ansi[i].rgba;case 50331648:return i<<8;default:return n?this._colors.background.rgba:this._colors.foreground.rgba}},c}();t.BaseRenderLayer=g},2512:function(l,t,o){var a,u=this&&this.__extends||(a=function(i,n){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,f){d.__proto__=f}||function(d,f){for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(d[y]=f[y])},a(i,n)},function(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function d(){this.constructor=i}a(i,n),i.prototype=n===null?Object.create(n):(d.prototype=n.prototype,new d)}),p=this&&this.__decorate||function(i,n,d,f){var y,S=arguments.length,E=S<3?n:f===null?f=Object.getOwnPropertyDescriptor(n,d):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(i,n,d,f);else for(var L=i.length-1;L>=0;L--)(y=i[L])&&(E=(S<3?y(E):S>3?y(n,d,E):y(n,d))||E);return S>3&&E&&Object.defineProperty(n,d,E),E},_=this&&this.__param||function(i,n){return function(d,f){n(d,f,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CursorRenderLayer=void 0;var b=o(1546),m=o(511),h=o(2585),v=o(4725),g=600,c=function(i){function n(d,f,y,S,E,L,C,w,T){var A=i.call(this,d,"cursor",f,!0,y,S,L,C)||this;return A._onRequestRedraw=E,A._coreService=w,A._coreBrowserService=T,A._cell=new m.CellData,A._state={x:0,y:0,isFocused:!1,style:"",width:0},A._cursorRenderers={bar:A._renderBarCursor.bind(A),block:A._renderBlockCursor.bind(A),underline:A._renderUnderlineCursor.bind(A)},A}return u(n,i),n.prototype.dispose=function(){this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=void 0),i.prototype.dispose.call(this)},n.prototype.resize=function(d){i.prototype.resize.call(this,d),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},n.prototype.reset=function(){var d;this._clearCursor(),(d=this._cursorBlinkStateManager)===null||d===void 0||d.restartBlinkAnimation(),this.onOptionsChanged()},n.prototype.onBlur=function(){var d;(d=this._cursorBlinkStateManager)===null||d===void 0||d.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},n.prototype.onFocus=function(){var d;(d=this._cursorBlinkStateManager)===null||d===void 0||d.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},n.prototype.onOptionsChanged=function(){var d,f=this;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new r(this._coreBrowserService.isFocused,function(){f._render(!0)})):((d=this._cursorBlinkStateManager)===null||d===void 0||d.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},n.prototype.onCursorMove=function(){var d;(d=this._cursorBlinkStateManager)===null||d===void 0||d.restartBlinkAnimation()},n.prototype.onGridChanged=function(d,f){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()},n.prototype._render=function(d){if(this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden){var f=this._bufferService.buffer.ybase+this._bufferService.buffer.y,y=f-this._bufferService.buffer.ydisp;if(y<0||y>=this._bufferService.rows)this._clearCursor();else{var S=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(f).loadCell(S,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var E=this._optionsService.rawOptions.cursorStyle;return E&&E!=="block"?this._cursorRenderers[E](S,y,this._cell):this._renderBlurCursor(S,y,this._cell),this._ctx.restore(),this._state.x=S,this._state.y=y,this._state.isFocused=!1,this._state.style=E,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===S&&this._state.y===y&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](S,y,this._cell),this._ctx.restore(),this._state.x=S,this._state.y=y,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}}else this._clearCursor()},n.prototype._clearCursor=function(){this._state&&(window.devicePixelRatio<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},n.prototype._renderBarCursor=function(d,f,y){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(d,f,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()},n.prototype._renderBlockCursor=function(d,f,y){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(d,f,y.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(y,d,f),this._ctx.restore()},n.prototype._renderUnderlineCursor=function(d,f,y){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(d,f),this._ctx.restore()},n.prototype._renderBlurCursor=function(d,f,y){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(d,f,y.getWidth(),1),this._ctx.restore()},p([_(5,h.IBufferService),_(6,h.IOptionsService),_(7,h.ICoreService),_(8,v.ICoreBrowserService)],n)}(b.BaseRenderLayer);t.CursorRenderLayer=c;var r=function(){function i(n,d){this._renderCallback=d,this.isCursorVisible=!0,n&&this._restartInterval()}return Object.defineProperty(i.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},i.prototype.restartBlinkAnimation=function(){var n=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){n._renderCallback(),n._animationFrame=void 0})))},i.prototype._restartInterval=function(n){var d=this;n===void 0&&(n=g),this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=window.setTimeout(function(){if(d._animationTimeRestarted){var f=g-(Date.now()-d._animationTimeRestarted);if(d._animationTimeRestarted=void 0,f>0)return void d._restartInterval(f)}d.isCursorVisible=!1,d._animationFrame=window.requestAnimationFrame(function(){d._renderCallback(),d._animationFrame=void 0}),d._blinkInterval=window.setInterval(function(){if(d._animationTimeRestarted){var y=g-(Date.now()-d._animationTimeRestarted);return d._animationTimeRestarted=void 0,void d._restartInterval(y)}d.isCursorVisible=!d.isCursorVisible,d._animationFrame=window.requestAnimationFrame(function(){d._renderCallback(),d._animationFrame=void 0})},g)},n)},i.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},i.prototype.resume=function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()},i}()},8978:(l,t,o)=>{var a,u,p,_,b,m,h,v,g,c,r,i,n,d,f,y,S,E,L,C,w,T,A,H,O,k,x,D,I,F,W,J,$,G,R,N,P,B,M,K,V,X,Y,Z,fe,z,te,he,_e,Ue,mi,bi,Si,Ci,wi,Li,Ei,ki,Ai,xi,Ri,Ti,lt,ht,ut,ft,dt,pt,_t,vt,gt,yt,mt,bt,St,Ct,wt,Lt,Et,kt,At,xt,Rt,Tt,Mt,Ot,Dt,Pt,Bt,It,Ht,jt,Ft,Ut,Nt,Wt,qt,zt,Kt,$t,Vt,Jt,Xt,Gt,Yt,Zt,Qt,ei,ti,ii,ri,ni,Mi,Oi,Di,Pi,Bi,Ii,Hi,ji,Fi,Ui,Ni,Wi,qi,zi,Ki,$i;Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var _r=o(1752);t.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258A":[{x:0,y:0,w:6,h:8}],"\u258B":[{x:0,y:0,w:5,h:8}],"\u258C":[{x:0,y:0,w:4,h:8}],"\u258D":[{x:0,y:0,w:3,h:8}],"\u258E":[{x:0,y:0,w:2,h:8}],"\u258F":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:9,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259A":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259B":[{x:0,y:0,w:4,h:8},{x:0,y:0,w:4,h:8}],"\u259C":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259D":[{x:4,y:0,w:4,h:4}],"\u259E":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259F":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u{1FB70}":[{x:1,y:0,w:1,h:8}],"\u{1FB71}":[{x:2,y:0,w:1,h:8}],"\u{1FB72}":[{x:3,y:0,w:1,h:8}],"\u{1FB73}":[{x:4,y:0,w:1,h:8}],"\u{1FB74}":[{x:5,y:0,w:1,h:8}],"\u{1FB75}":[{x:6,y:0,w:1,h:8}],"\u{1FB76}":[{x:0,y:1,w:8,h:1}],"\u{1FB77}":[{x:0,y:2,w:8,h:1}],"\u{1FB78}":[{x:0,y:3,w:8,h:1}],"\u{1FB79}":[{x:0,y:4,w:8,h:1}],"\u{1FB7A}":[{x:0,y:5,w:8,h:1}],"\u{1FB7B}":[{x:0,y:6,w:8,h:1}],"\u{1FB7C}":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB7D}":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7E}":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7F}":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB80}":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB81}":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB82}":[{x:0,y:0,w:8,h:2}],"\u{1FB83}":[{x:0,y:0,w:8,h:3}],"\u{1FB84}":[{x:0,y:0,w:8,h:5}],"\u{1FB85}":[{x:0,y:0,w:8,h:6}],"\u{1FB86}":[{x:0,y:0,w:8,h:7}],"\u{1FB87}":[{x:6,y:0,w:2,h:8}],"\u{1FB88}":[{x:5,y:0,w:3,h:8}],"\u{1FB89}":[{x:3,y:0,w:5,h:8}],"\u{1FB8A}":[{x:2,y:0,w:6,h:8}],"\u{1FB8B}":[{x:1,y:0,w:7,h:8}],"\u{1FB95}":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\u{1FB96}":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\u{1FB97}":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var rn={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"\u2500":(a={},a[1]="M0,.5 L1,.5",a),"\u2501":(u={},u[3]="M0,.5 L1,.5",u),"\u2502":(p={},p[1]="M.5,0 L.5,1",p),"\u2503":(_={},_[3]="M.5,0 L.5,1",_),"\u250C":(b={},b[1]="M0.5,1 L.5,.5 L1,.5",b),"\u250F":(m={},m[3]="M0.5,1 L.5,.5 L1,.5",m),"\u2510":(h={},h[1]="M0,.5 L.5,.5 L.5,1",h),"\u2513":(v={},v[3]="M0,.5 L.5,.5 L.5,1",v),"\u2514":(g={},g[1]="M.5,0 L.5,.5 L1,.5",g),"\u2517":(c={},c[3]="M.5,0 L.5,.5 L1,.5",c),"\u2518":(r={},r[1]="M.5,0 L.5,.5 L0,.5",r),"\u251B":(i={},i[3]="M.5,0 L.5,.5 L0,.5",i),"\u251C":(n={},n[1]="M.5,0 L.5,1 M.5,.5 L1,.5",n),"\u2523":(d={},d[3]="M.5,0 L.5,1 M.5,.5 L1,.5",d),"\u2524":(f={},f[1]="M.5,0 L.5,1 M.5,.5 L0,.5",f),"\u252B":(y={},y[3]="M.5,0 L.5,1 M.5,.5 L0,.5",y),"\u252C":(S={},S[1]="M0,.5 L1,.5 M.5,.5 L.5,1",S),"\u2533":(E={},E[3]="M0,.5 L1,.5 M.5,.5 L.5,1",E),"\u2534":(L={},L[1]="M0,.5 L1,.5 M.5,.5 L.5,0",L),"\u253B":(C={},C[3]="M0,.5 L1,.5 M.5,.5 L.5,0",C),"\u253C":(w={},w[1]="M0,.5 L1,.5 M.5,0 L.5,1",w),"\u254B":(T={},T[3]="M0,.5 L1,.5 M.5,0 L.5,1",T),"\u2574":(A={},A[1]="M.5,.5 L0,.5",A),"\u2578":(H={},H[3]="M.5,.5 L0,.5",H),"\u2575":(O={},O[1]="M.5,.5 L.5,0",O),"\u2579":(k={},k[3]="M.5,.5 L.5,0",k),"\u2576":(x={},x[1]="M.5,.5 L1,.5",x),"\u257A":(D={},D[3]="M.5,.5 L1,.5",D),"\u2577":(I={},I[1]="M.5,.5 L.5,1",I),"\u257B":(F={},F[3]="M.5,.5 L.5,1",F),"\u2550":(W={},W[1]=function(U,j){return"M0,"+(.5-j)+" L1,"+(.5-j)+" M0,"+(.5+j)+" L1,"+(.5+j)},W),"\u2551":(J={},J[1]=function(U,j){return"M"+(.5-U)+",0 L"+(.5-U)+",1 M"+(.5+U)+",0 L"+(.5+U)+",1"},J),"\u2552":($={},$[1]=function(U,j){return"M.5,1 L.5,"+(.5-j)+" L1,"+(.5-j)+" M.5,"+(.5+j)+" L1,"+(.5+j)},$),"\u2553":(G={},G[1]=function(U,j){return"M"+(.5-U)+",1 L"+(.5-U)+",.5 L1,.5 M"+(.5+U)+",.5 L"+(.5+U)+",1"},G),"\u2554":(R={},R[1]=function(U,j){return"M1,"+(.5-j)+" L"+(.5-U)+","+(.5-j)+" L"+(.5-U)+",1 M1,"+(.5+j)+" L"+(.5+U)+","+(.5+j)+" L"+(.5+U)+",1"},R),"\u2555":(N={},N[1]=function(U,j){return"M0,"+(.5-j)+" L.5,"+(.5-j)+" L.5,1 M0,"+(.5+j)+" L.5,"+(.5+j)},N),"\u2556":(P={},P[1]=function(U,j){return"M"+(.5+U)+",1 L"+(.5+U)+",.5 L0,.5 M"+(.5-U)+",.5 L"+(.5-U)+",1"},P),"\u2557":(B={},B[1]=function(U,j){return"M0,"+(.5+j)+" L"+(.5-U)+","+(.5+j)+" L"+(.5-U)+",1 M0,"+(.5-j)+" L"+(.5+U)+","+(.5-j)+" L"+(.5+U)+",1"},B),"\u2558":(M={},M[1]=function(U,j){return"M.5,0 L.5,"+(.5+j)+" L1,"+(.5+j)+" M.5,"+(.5-j)+" L1,"+(.5-j)},M),"\u2559":(K={},K[1]=function(U,j){return"M1,.5 L"+(.5-U)+",.5 L"+(.5-U)+",0 M"+(.5+U)+",.5 L"+(.5+U)+",0"},K),"\u255A":(V={},V[1]=function(U,j){return"M1,"+(.5-j)+" L"+(.5+U)+","+(.5-j)+" L"+(.5+U)+",0 M1,"+(.5+j)+" L"+(.5-U)+","+(.5+j)+" L"+(.5-U)+",0"},V),"\u255B":(X={},X[1]=function(U,j){return"M0,"+(.5+j)+" L.5,"+(.5+j)+" L.5,0 M0,"+(.5-j)+" L.5,"+(.5-j)},X),"\u255C":(Y={},Y[1]=function(U,j){return"M0,.5 L"+(.5+U)+",.5 L"+(.5+U)+",0 M"+(.5-U)+",.5 L"+(.5-U)+",0"},Y),"\u255D":(Z={},Z[1]=function(U,j){return"M0,"+(.5-j)+" L"+(.5-U)+","+(.5-j)+" L"+(.5-U)+",0 M0,"+(.5+j)+" L"+(.5+U)+","+(.5+j)+" L"+(.5+U)+",0"},Z),"\u255E":(fe={},fe[1]=function(U,j){return"M.5,0 L.5,1 M.5,"+(.5-j)+" L1,"+(.5-j)+" M.5,"+(.5+j)+" L1,"+(.5+j)},fe),"\u255F":(z={},z[1]=function(U,j){return"M"+(.5-U)+",0 L"+(.5-U)+",1 M"+(.5+U)+",0 L"+(.5+U)+",1 M"+(.5+U)+",.5 L1,.5"},z),"\u2560":(te={},te[1]=function(U,j){return"M"+(.5-U)+",0 L"+(.5-U)+",1 M1,"+(.5+j)+" L"+(.5+U)+","+(.5+j)+" L"+(.5+U)+",1 M1,"+(.5-j)+" L"+(.5+U)+","+(.5-j)+" L"+(.5+U)+",0"},te),"\u2561":(he={},he[1]=function(U,j){return"M.5,0 L.5,1 M0,"+(.5-j)+" L.5,"+(.5-j)+" M0,"+(.5+j)+" L.5,"+(.5+j)},he),"\u2562":(_e={},_e[1]=function(U,j){return"M0,.5 L"+(.5-U)+",.5 M"+(.5-U)+",0 L"+(.5-U)+",1 M"+(.5+U)+",0 L"+(.5+U)+",1"},_e),"\u2563":(Ue={},Ue[1]=function(U,j){return"M"+(.5+U)+",0 L"+(.5+U)+",1 M0,"+(.5+j)+" L"+(.5-U)+","+(.5+j)+" L"+(.5-U)+",1 M0,"+(.5-j)+" L"+(.5-U)+","+(.5-j)+" L"+(.5-U)+",0"},Ue),"\u2564":(mi={},mi[1]=function(U,j){return"M0,"+(.5-j)+" L1,"+(.5-j)+" M0,"+(.5+j)+" L1,"+(.5+j)+" M.5,"+(.5+j)+" L.5,1"},mi),"\u2565":(bi={},bi[1]=function(U,j){return"M0,.5 L1,.5 M"+(.5-U)+",.5 L"+(.5-U)+",1 M"+(.5+U)+",.5 L"+(.5+U)+",1"},bi),"\u2566":(Si={},Si[1]=function(U,j){return"M0,"+(.5-j)+" L1,"+(.5-j)+" M0,"+(.5+j)+" L"+(.5-U)+","+(.5+j)+" L"+(.5-U)+",1 M1,"+(.5+j)+" L"+(.5+U)+","+(.5+j)+" L"+(.5+U)+",1"},Si),"\u2567":(Ci={},Ci[1]=function(U,j){return"M.5,0 L.5,"+(.5-j)+" M0,"+(.5-j)+" L1,"+(.5-j)+" M0,"+(.5+j)+" L1,"+(.5+j)},Ci),"\u2568":(wi={},wi[1]=function(U,j){return"M0,.5 L1,.5 M"+(.5-U)+",.5 L"+(.5-U)+",0 M"+(.5+U)+",.5 L"+(.5+U)+",0"},wi),"\u2569":(Li={},Li[1]=function(U,j){return"M0,"+(.5+j)+" L1,"+(.5+j)+" M0,"+(.5-j)+" L"+(.5-U)+","+(.5-j)+" L"+(.5-U)+",0 M1,"+(.5-j)+" L"+(.5+U)+","+(.5-j)+" L"+(.5+U)+",0"},Li),"\u256A":(Ei={},Ei[1]=function(U,j){return"M.5,0 L.5,1 M0,"+(.5-j)+" L1,"+(.5-j)+" M0,"+(.5+j)+" L1,"+(.5+j)},Ei),"\u256B":(ki={},ki[1]=function(U,j){return"M0,.5 L1,.5 M"+(.5-U)+",0 L"+(.5-U)+",1 M"+(.5+U)+",0 L"+(.5+U)+",1"},ki),"\u256C":(Ai={},Ai[1]=function(U,j){return"M0,"+(.5+j)+" L"+(.5-U)+","+(.5+j)+" L"+(.5-U)+",1 M1,"+(.5+j)+" L"+(.5+U)+","+(.5+j)+" L"+(.5+U)+",1 M0,"+(.5-j)+" L"+(.5-U)+","+(.5-j)+" L"+(.5-U)+",0 M1,"+(.5-j)+" L"+(.5+U)+","+(.5-j)+" L"+(.5+U)+",0"},Ai),"\u2571":(xi={},xi[1]="M1,0 L0,1",xi),"\u2572":(Ri={},Ri[1]="M0,0 L1,1",Ri),"\u2573":(Ti={},Ti[1]="M1,0 L0,1 M0,0 L1,1",Ti),"\u257C":(lt={},lt[1]="M.5,.5 L0,.5",lt[3]="M.5,.5 L1,.5",lt),"\u257D":(ht={},ht[1]="M.5,.5 L.5,0",ht[3]="M.5,.5 L.5,1",ht),"\u257E":(ut={},ut[1]="M.5,.5 L1,.5",ut[3]="M.5,.5 L0,.5",ut),"\u257F":(ft={},ft[1]="M.5,.5 L.5,1",ft[3]="M.5,.5 L.5,0",ft),"\u250D":(dt={},dt[1]="M.5,.5 L.5,1",dt[3]="M.5,.5 L1,.5",dt),"\u250E":(pt={},pt[1]="M.5,.5 L1,.5",pt[3]="M.5,.5 L.5,1",pt),"\u2511":(_t={},_t[1]="M.5,.5 L.5,1",_t[3]="M.5,.5 L0,.5",_t),"\u2512":(vt={},vt[1]="M.5,.5 L0,.5",vt[3]="M.5,.5 L.5,1",vt),"\u2515":(gt={},gt[1]="M.5,.5 L.5,0",gt[3]="M.5,.5 L1,.5",gt),"\u2516":(yt={},yt[1]="M.5,.5 L1,.5",yt[3]="M.5,.5 L.5,0",yt),"\u2519":(mt={},mt[1]="M.5,.5 L.5,0",mt[3]="M.5,.5 L0,.5",mt),"\u251A":(bt={},bt[1]="M.5,.5 L0,.5",bt[3]="M.5,.5 L.5,0",bt),"\u251D":(St={},St[1]="M.5,0 L.5,1",St[3]="M.5,.5 L1,.5",St),"\u251E":(Ct={},Ct[1]="M0.5,1 L.5,.5 L1,.5",Ct[3]="M.5,.5 L.5,0",Ct),"\u251F":(wt={},wt[1]="M.5,0 L.5,.5 L1,.5",wt[3]="M.5,.5 L.5,1",wt),"\u2520":(Lt={},Lt[1]="M.5,.5 L1,.5",Lt[3]="M.5,0 L.5,1",Lt),"\u2521":(Et={},Et[1]="M.5,.5 L.5,1",Et[3]="M.5,0 L.5,.5 L1,.5",Et),"\u2522":(kt={},kt[1]="M.5,.5 L.5,0",kt[3]="M0.5,1 L.5,.5 L1,.5",kt),"\u2525":(At={},At[1]="M.5,0 L.5,1",At[3]="M.5,.5 L0,.5",At),"\u2526":(xt={},xt[1]="M0,.5 L.5,.5 L.5,1",xt[3]="M.5,.5 L.5,0",xt),"\u2527":(Rt={},Rt[1]="M.5,0 L.5,.5 L0,.5",Rt[3]="M.5,.5 L.5,1",Rt),"\u2528":(Tt={},Tt[1]="M.5,.5 L0,.5",Tt[3]="M.5,0 L.5,1",Tt),"\u2529":(Mt={},Mt[1]="M.5,.5 L.5,1",Mt[3]="M.5,0 L.5,.5 L0,.5",Mt),"\u252A":(Ot={},Ot[1]="M.5,.5 L.5,0",Ot[3]="M0,.5 L.5,.5 L.5,1",Ot),"\u252D":(Dt={},Dt[1]="M0.5,1 L.5,.5 L1,.5",Dt[3]="M.5,.5 L0,.5",Dt),"\u252E":(Pt={},Pt[1]="M0,.5 L.5,.5 L.5,1",Pt[3]="M.5,.5 L1,.5",Pt),"\u252F":(Bt={},Bt[1]="M.5,.5 L.5,1",Bt[3]="M0,.5 L1,.5",Bt),"\u2530":(It={},It[1]="M0,.5 L1,.5",It[3]="M.5,.5 L.5,1",It),"\u2531":(Ht={},Ht[1]="M.5,.5 L1,.5",Ht[3]="M0,.5 L.5,.5 L.5,1",Ht),"\u2532":(jt={},jt[1]="M.5,.5 L0,.5",jt[3]="M0.5,1 L.5,.5 L1,.5",jt),"\u2535":(Ft={},Ft[1]="M.5,0 L.5,.5 L1,.5",Ft[3]="M.5,.5 L0,.5",Ft),"\u2536":(Ut={},Ut[1]="M.5,0 L.5,.5 L0,.5",Ut[3]="M.5,.5 L1,.5",Ut),"\u2537":(Nt={},Nt[1]="M.5,.5 L.5,0",Nt[3]="M0,.5 L1,.5",Nt),"\u2538":(Wt={},Wt[1]="M0,.5 L1,.5",Wt[3]="M.5,.5 L.5,0",Wt),"\u2539":(qt={},qt[1]="M.5,.5 L1,.5",qt[3]="M.5,0 L.5,.5 L0,.5",qt),"\u253A":(zt={},zt[1]="M.5,.5 L0,.5",zt[3]="M.5,0 L.5,.5 L1,.5",zt),"\u253D":(Kt={},Kt[1]="M.5,0 L.5,1 M.5,.5 L1,.5",Kt[3]="M.5,.5 L0,.5",Kt),"\u253E":($t={},$t[1]="M.5,0 L.5,1 M.5,.5 L0,.5",$t[3]="M.5,.5 L1,.5",$t),"\u253F":(Vt={},Vt[1]="M.5,0 L.5,1",Vt[3]="M0,.5 L1,.5",Vt),"\u2540":(Jt={},Jt[1]="M0,.5 L1,.5 M.5,.5 L.5,1",Jt[3]="M.5,.5 L.5,0",Jt),"\u2541":(Xt={},Xt[1]="M.5,.5 L.5,0 M0,.5 L1,.5",Xt[3]="M.5,.5 L.5,1",Xt),"\u2542":(Gt={},Gt[1]="M0,.5 L1,.5",Gt[3]="M.5,0 L.5,1",Gt),"\u2543":(Yt={},Yt[1]="M0.5,1 L.5,.5 L1,.5",Yt[3]="M.5,0 L.5,.5 L0,.5",Yt),"\u2544":(Zt={},Zt[1]="M0,.5 L.5,.5 L.5,1",Zt[3]="M.5,0 L.5,.5 L1,.5",Zt),"\u2545":(Qt={},Qt[1]="M.5,0 L.5,.5 L1,.5",Qt[3]="M0,.5 L.5,.5 L.5,1",Qt),"\u2546":(ei={},ei[1]="M.5,0 L.5,.5 L0,.5",ei[3]="M0.5,1 L.5,.5 L1,.5",ei),"\u2547":(ti={},ti[1]="M.5,.5 L.5,1",ti[3]="M.5,.5 L.5,0 M0,.5 L1,.5",ti),"\u2548":(ii={},ii[1]="M.5,.5 L.5,0",ii[3]="M0,.5 L1,.5 M.5,.5 L.5,1",ii),"\u2549":(ri={},ri[1]="M.5,.5 L1,.5",ri[3]="M.5,0 L.5,1 M.5,.5 L0,.5",ri),"\u254A":(ni={},ni[1]="M.5,.5 L0,.5",ni[3]="M.5,0 L.5,1 M.5,.5 L1,.5",ni),"\u254C":(Mi={},Mi[1]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",Mi),"\u254D":(Oi={},Oi[3]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",Oi),"\u2504":(Di={},Di[1]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",Di),"\u2505":(Pi={},Pi[3]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",Pi),"\u2508":(Bi={},Bi[1]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",Bi),"\u2509":(Ii={},Ii[3]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",Ii),"\u254E":(Hi={},Hi[1]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",Hi),"\u254F":(ji={},ji[3]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",ji),"\u2506":(Fi={},Fi[1]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",Fi),"\u2507":(Ui={},Ui[3]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",Ui),"\u250A":(Ni={},Ni[1]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",Ni),"\u250B":(Wi={},Wi[3]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",Wi),"\u256D":(qi={},qi[1]="C.5,1,.5,.5,1,.5",qi),"\u256E":(zi={},zi[1]="C.5,1,.5,.5,0,.5",zi),"\u256F":(Ki={},Ki[1]="C.5,0,.5,.5,0,.5",Ki),"\u2570":($i={},$i[1]="C.5,0,.5,.5,1,.5",$i)},t.tryDrawCustomChar=function(U,j,ve,$e,Ve,ee){var ge=t.blockElementDefinitions[j];if(ge)return function(ne,me,Xe,Ge,Ne,We){for(var ue=0;ue<me.length;ue++){var oe=me[ue],Q=Ne/8,Ee=We/8;ne.fillRect(Xe+oe.x*Q,Ge+oe.y*Ee,oe.w*Q,oe.h*Ee)}}(U,ge,ve,$e,Ve,ee),!0;var ye=rn[j];if(ye)return function(ne,me,Xe,Ge,Ne,We){var ue,oe=vr.get(me);oe||(oe=new Map,vr.set(me,oe));var Q=ne.fillStyle;if(typeof Q!="string")throw new Error('Unexpected fillStyle type "'+Q+'"');var Ee=oe.get(Q);if(!Ee){var de=me[0].length,Oe=me.length,De=document.createElement("canvas");De.width=de,De.height=Oe;var si=(0,_r.throwIfFalsy)(De.getContext("2d")),xe=new ImageData(de,Oe),qe=void 0,Pe=void 0,Vi=void 0,Ji=void 0;if(Q.startsWith("#"))qe=parseInt(Q.substr(1,2),16),Pe=parseInt(Q.substr(3,2),16),Vi=parseInt(Q.substr(5,2),16),Ji=Q.length>7&&parseInt(Q.substr(7,2),16)||1;else{if(!Q.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'+Q+'" when drawing pattern glyph');qe=(ue=Q.substring(5,Q.length-1).split(",").map(function(on){return parseFloat(on)}))[0],Pe=ue[1],Vi=ue[2],Ji=ue[3]}for(var Be=0;Be<Oe;Be++)for(var Ie=0;Ie<de;Ie++)xe.data[4*(Be*de+Ie)]=qe,xe.data[4*(Be*de+Ie)+1]=Pe,xe.data[4*(Be*de+Ie)+2]=Vi,xe.data[4*(Be*de+Ie)+3]=me[Be][Ie]*(255*Ji);si.putImageData(xe,0,0),Ee=(0,_r.throwIfFalsy)(ne.createPattern(De,null)),oe.set(Q,Ee)}ne.fillStyle=Ee,ne.fillRect(Xe,Ge,Ne,We)}(U,ye,ve,$e,Ve,ee),!0;var Je=t.boxDrawingDefinitions[j];return!!Je&&(function(ne,me,Xe,Ge,Ne,We){ne.strokeStyle=ne.fillStyle;for(var ue=0,oe=Object.entries(me);ue<oe.length;ue++){var Q=oe[ue],Ee=Q[0],de=Q[1];ne.beginPath(),ne.lineWidth=window.devicePixelRatio*Number.parseInt(Ee);for(var Oe=0,De=(typeof de=="function"?de(.15,.15/We*Ne):de).split(" ");Oe<De.length;Oe++){var si=De[Oe],xe=si[0],qe=nn[xe];if(qe){var Pe=si.substring(1).split(",");Pe[0]&&Pe[1]&&qe(ne,sn(Pe,Ne,We,Xe,Ge))}else console.error('Could not find drawing instructions for "'+xe+'"')}ne.stroke(),ne.closePath()}}(U,Je,ve,$e,Ve,ee),!0)};var vr=new Map;function gr(U,j,ve){return ve===void 0&&(ve=0),Math.max(Math.min(U,j),ve)}var nn={C:function(U,j){return U.bezierCurveTo(j[0],j[1],j[2],j[3],j[4],j[5])},L:function(U,j){return U.lineTo(j[0],j[1])},M:function(U,j){return U.moveTo(j[0],j[1])}};function sn(U,j,ve,$e,Ve){var ee=U.map(function(Je){return parseFloat(Je)||parseInt(Je)});if(ee.length<2)throw new Error("Too few arguments for instruction");for(var ge=0;ge<ee.length;ge+=2)ee[ge]*=j,ee[ge]!==0&&(ee[ge]=gr(Math.round(ee[ge]+.5)-.5,j,0)),ee[ge]+=$e;for(var ye=1;ye<ee.length;ye+=2)ee[ye]*=ve,ee[ye]!==0&&(ee[ye]=gr(Math.round(ee[ye]+.5)-.5,ve,0)),ee[ye]+=Ve;return ee}},3700:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GridCache=void 0;var o=function(){function a(){this.cache=[]}return a.prototype.resize=function(u,p){for(var _=0;_<u;_++){this.cache.length<=_&&this.cache.push([]);for(var b=this.cache[_].length;b<p;b++)this.cache[_].push(void 0);this.cache[_].length=p}this.cache.length=u},a.prototype.clear=function(){for(var u=0;u<this.cache.length;u++)for(var p=0;p<this.cache[u].length;p++)this.cache[u][p]=void 0},a}();t.GridCache=o},5098:function(l,t,o){var a,u=this&&this.__extends||(a=function(c,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(i[d]=n[d])},a(c,r)},function(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=c}a(c,r),c.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}),p=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},_=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var b=o(1546),m=o(8803),h=o(2040),v=o(2585),g=function(c){function r(i,n,d,f,y,S,E,L){var C=c.call(this,i,"link",n,!0,d,f,E,L)||this;return y.onShowLinkUnderline(function(w){return C._onShowLinkUnderline(w)}),y.onHideLinkUnderline(function(w){return C._onHideLinkUnderline(w)}),S.onShowLinkUnderline(function(w){return C._onShowLinkUnderline(w)}),S.onHideLinkUnderline(function(w){return C._onHideLinkUnderline(w)}),C}return u(r,c),r.prototype.resize=function(i){c.prototype.resize.call(this,i),this._state=void 0},r.prototype.reset=function(){this._clearCurrentLink()},r.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var i=this._state.y2-this._state.y1-1;i>0&&this._clearCells(0,this._state.y1+1,this._state.cols,i),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},r.prototype._onShowLinkUnderline=function(i){if(i.fg===m.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:i.fg&&(0,h.is256Color)(i.fg)?this._ctx.fillStyle=this._colors.ansi[i.fg].css:this._ctx.fillStyle=this._colors.foreground.css,i.y1===i.y2)this._fillBottomLineAtCells(i.x1,i.y1,i.x2-i.x1);else{this._fillBottomLineAtCells(i.x1,i.y1,i.cols-i.x1);for(var n=i.y1+1;n<i.y2;n++)this._fillBottomLineAtCells(0,n,i.cols);this._fillBottomLineAtCells(0,i.y2,i.x2)}this._state=i},r.prototype._onHideLinkUnderline=function(i){this._clearCurrentLink()},p([_(6,v.IBufferService),_(7,v.IOptionsService)],r)}(b.BaseRenderLayer);t.LinkRenderLayer=g},3525:function(l,t,o){var a,u=this&&this.__extends||(a=function(y,S){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,L){E.__proto__=L}||function(E,L){for(var C in L)Object.prototype.hasOwnProperty.call(L,C)&&(E[C]=L[C])},a(y,S)},function(y,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");function E(){this.constructor=y}a(y,S),y.prototype=S===null?Object.create(S):(E.prototype=S.prototype,new E)}),p=this&&this.__decorate||function(y,S,E,L){var C,w=arguments.length,T=w<3?S:L===null?L=Object.getOwnPropertyDescriptor(S,E):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(y,S,E,L);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(T=(w<3?C(T):w>3?C(S,E,T):C(S,E))||T);return w>3&&T&&Object.defineProperty(S,E,T),T},_=this&&this.__param||function(y,S){return function(E,L){S(E,L,y)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var b=o(9596),m=o(4149),h=o(2512),v=o(5098),g=o(844),c=o(4725),r=o(2585),i=o(1420),n=o(8460),d=1,f=function(y){function S(E,L,C,w,T,A,H,O){var k=y.call(this)||this;k._colors=E,k._screenElement=L,k._bufferService=A,k._charSizeService=H,k._optionsService=O,k._id=d++,k._onRequestRedraw=new n.EventEmitter;var x=k._optionsService.rawOptions.allowTransparency;return k._renderLayers=[T.createInstance(b.TextRenderLayer,k._screenElement,0,k._colors,x,k._id),T.createInstance(m.SelectionRenderLayer,k._screenElement,1,k._colors,k._id),T.createInstance(v.LinkRenderLayer,k._screenElement,2,k._colors,k._id,C,w),T.createInstance(h.CursorRenderLayer,k._screenElement,3,k._colors,k._id,k._onRequestRedraw)],k.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},k._devicePixelRatio=window.devicePixelRatio,k._updateDimensions(),k.onOptionsChanged(),k}return u(S,y),Object.defineProperty(S.prototype,"onRequestRedraw",{get:function(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),S.prototype.dispose=function(){for(var E=0,L=this._renderLayers;E<L.length;E++)L[E].dispose();y.prototype.dispose.call(this),(0,i.removeTerminalFromCache)(this._id)},S.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._bufferService.cols,this._bufferService.rows))},S.prototype.setColors=function(E){this._colors=E;for(var L=0,C=this._renderLayers;L<C.length;L++){var w=C[L];w.setColors(this._colors),w.reset()}},S.prototype.onResize=function(E,L){this._updateDimensions();for(var C=0,w=this._renderLayers;C<w.length;C++)w[C].resize(this.dimensions);this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},S.prototype.onCharSizeChanged=function(){this.onResize(this._bufferService.cols,this._bufferService.rows)},S.prototype.onBlur=function(){this._runOperation(function(E){return E.onBlur()})},S.prototype.onFocus=function(){this._runOperation(function(E){return E.onFocus()})},S.prototype.onSelectionChanged=function(E,L,C){C===void 0&&(C=!1),this._runOperation(function(w){return w.onSelectionChanged(E,L,C)})},S.prototype.onCursorMove=function(){this._runOperation(function(E){return E.onCursorMove()})},S.prototype.onOptionsChanged=function(){this._runOperation(function(E){return E.onOptionsChanged()})},S.prototype.clear=function(){this._runOperation(function(E){return E.reset()})},S.prototype._runOperation=function(E){for(var L=0,C=this._renderLayers;L<C.length;L++)E(C[L])},S.prototype.renderRows=function(E,L){for(var C=0,w=this._renderLayers;C<w.length;C++)w[C].onGridChanged(E,L)},S.prototype.clearTextureAtlas=function(){for(var E=0,L=this._renderLayers;E<L.length;E++)L[E].clearTextureAtlas()},S.prototype._updateDimensions=function(){this._charSizeService.hasValidSize&&(this.dimensions.scaledCharWidth=Math.floor(this._charSizeService.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.rawOptions.lineHeight),this.dimensions.scaledCharTop=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._bufferService.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._bufferService.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols)},p([_(4,r.IInstantiationService),_(5,r.IBufferService),_(6,c.ICharSizeService),_(7,r.IOptionsService)],S)}(g.Disposable);t.Renderer=f},1752:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfFalsy=void 0,t.throwIfFalsy=function(o){if(!o)throw new Error("value must not be falsy");return o}},4149:function(l,t,o){var a,u=this&&this.__extends||(a=function(v,g){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,r){c.__proto__=r}||function(c,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(c[i]=r[i])},a(v,g)},function(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function c(){this.constructor=v}a(v,g),v.prototype=g===null?Object.create(g):(c.prototype=g.prototype,new c)}),p=this&&this.__decorate||function(v,g,c,r){var i,n=arguments.length,d=n<3?g:r===null?r=Object.getOwnPropertyDescriptor(g,c):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(v,g,c,r);else for(var f=v.length-1;f>=0;f--)(i=v[f])&&(d=(n<3?i(d):n>3?i(g,c,d):i(g,c))||d);return n>3&&d&&Object.defineProperty(g,c,d),d},_=this&&this.__param||function(v,g){return function(c,r){g(c,r,v)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRenderLayer=void 0;var b=o(1546),m=o(2585),h=function(v){function g(c,r,i,n,d,f){var y=v.call(this,c,"selection",r,!0,i,n,d,f)||this;return y._clearState(),y}return u(g,v),g.prototype._clearState=function(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}},g.prototype.resize=function(c){v.prototype.resize.call(this,c),this._clearState()},g.prototype.reset=function(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())},g.prototype.onSelectionChanged=function(c,r,i){if(this._didStateChange(c,r,i,this._bufferService.buffer.ydisp))if(this._clearAll(),c&&r){var n=c[1]-this._bufferService.buffer.ydisp,d=r[1]-this._bufferService.buffer.ydisp,f=Math.max(n,0),y=Math.min(d,this._bufferService.rows-1);if(f>=this._bufferService.rows||y<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=this._colors.selectionTransparent.css,i){var S=c[0],E=r[0]-S,L=y-f+1;this._fillCells(S,f,E,L)}else{S=n===f?c[0]:0;var C=f===d?r[0]:this._bufferService.cols;this._fillCells(S,f,C-S,1);var w=Math.max(y-f-1,0);if(this._fillCells(0,f+1,this._bufferService.cols,w),f!==y){var T=d===y?r[0]:this._bufferService.cols;this._fillCells(0,y,T,1)}}this._state.start=[c[0],c[1]],this._state.end=[r[0],r[1]],this._state.columnSelectMode=i,this._state.ydisp=this._bufferService.buffer.ydisp}}else this._clearState()},g.prototype._didStateChange=function(c,r,i,n){return!this._areCoordinatesEqual(c,this._state.start)||!this._areCoordinatesEqual(r,this._state.end)||i!==this._state.columnSelectMode||n!==this._state.ydisp},g.prototype._areCoordinatesEqual=function(c,r){return!(!c||!r)&&c[0]===r[0]&&c[1]===r[1]},p([_(4,m.IBufferService),_(5,m.IOptionsService)],g)}(b.BaseRenderLayer);t.SelectionRenderLayer=h},9596:function(l,t,o){var a,u=this&&this.__extends||(a=function(d,f){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,S){y.__proto__=S}||function(y,S){for(var E in S)Object.prototype.hasOwnProperty.call(S,E)&&(y[E]=S[E])},a(d,f)},function(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function y(){this.constructor=d}a(d,f),d.prototype=f===null?Object.create(f):(y.prototype=f.prototype,new y)}),p=this&&this.__decorate||function(d,f,y,S){var E,L=arguments.length,C=L<3?f:S===null?S=Object.getOwnPropertyDescriptor(f,y):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(d,f,y,S);else for(var w=d.length-1;w>=0;w--)(E=d[w])&&(C=(L<3?E(C):L>3?E(f,y,C):E(f,y))||C);return L>3&&C&&Object.defineProperty(f,y,C),C},_=this&&this.__param||function(d,f){return function(y,S){f(y,S,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TextRenderLayer=void 0;var b=o(3700),m=o(1546),h=o(3734),v=o(643),g=o(511),c=o(2585),r=o(4725),i=o(4269),n=function(d){function f(y,S,E,L,C,w,T,A){var H=d.call(this,y,"text",S,L,E,C,w,T)||this;return H._characterJoinerService=A,H._characterWidth=0,H._characterFont="",H._characterOverlapCache={},H._workCell=new g.CellData,H._state=new b.GridCache,H}return u(f,d),f.prototype.resize=function(y){d.prototype.resize.call(this,y);var S=this._getFont(!1,!1);this._characterWidth===y.scaledCharWidth&&this._characterFont===S||(this._characterWidth=y.scaledCharWidth,this._characterFont=S,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)},f.prototype.reset=function(){this._state.clear(),this._clearAll()},f.prototype._forEachCell=function(y,S,E){for(var L=y;L<=S;L++)for(var C=L+this._bufferService.buffer.ydisp,w=this._bufferService.buffer.lines.get(C),T=this._characterJoinerService.getJoinedCharacters(C),A=0;A<this._bufferService.cols;A++){w.loadCell(A,this._workCell);var H=this._workCell,O=!1,k=A;if(H.getWidth()!==0){if(T.length>0&&A===T[0][0]){O=!0;var x=T.shift();H=new i.JoinedCellData(this._workCell,w.translateToString(!0,x[0],x[1]),x[1]-x[0]),k=x[1]-1}!O&&this._isOverlapping(H)&&k<w.length-1&&w.getCodePoint(k+1)===v.NULL_CELL_CODE&&(H.content&=-12582913,H.content|=2<<22),E(H,A,L),A=k}}},f.prototype._drawBackground=function(y,S){var E=this,L=this._ctx,C=this._bufferService.cols,w=0,T=0,A=null;L.save(),this._forEachCell(y,S,function(H,O,k){var x=null;H.isInverse()?x=H.isFgDefault()?E._colors.foreground.css:H.isFgRGB()?"rgb("+h.AttributeData.toColorRGB(H.getFgColor()).join(",")+")":E._colors.ansi[H.getFgColor()].css:H.isBgRGB()?x="rgb("+h.AttributeData.toColorRGB(H.getBgColor()).join(",")+")":H.isBgPalette()&&(x=E._colors.ansi[H.getBgColor()].css),A===null&&(w=O,T=k),k!==T?(L.fillStyle=A||"",E._fillCells(w,T,C-w,1),w=O,T=k):A!==x&&(L.fillStyle=A||"",E._fillCells(w,T,O-w,1),w=O,T=k),A=x}),A!==null&&(L.fillStyle=A,this._fillCells(w,T,C-w,1)),L.restore()},f.prototype._drawForeground=function(y,S){var E=this;this._forEachCell(y,S,function(L,C,w){if(!L.isInvisible()&&(E._drawChars(L,C,w),L.isUnderline()||L.isStrikethrough())){if(E._ctx.save(),L.isInverse())if(L.isBgDefault())E._ctx.fillStyle=E._colors.background.css;else if(L.isBgRGB())E._ctx.fillStyle="rgb("+h.AttributeData.toColorRGB(L.getBgColor()).join(",")+")";else{var T=L.getBgColor();E._optionsService.rawOptions.drawBoldTextInBrightColors&&L.isBold()&&T<8&&(T+=8),E._ctx.fillStyle=E._colors.ansi[T].css}else if(L.isFgDefault())E._ctx.fillStyle=E._colors.foreground.css;else if(L.isFgRGB())E._ctx.fillStyle="rgb("+h.AttributeData.toColorRGB(L.getFgColor()).join(",")+")";else{var A=L.getFgColor();E._optionsService.rawOptions.drawBoldTextInBrightColors&&L.isBold()&&A<8&&(A+=8),E._ctx.fillStyle=E._colors.ansi[A].css}L.isStrikethrough()&&E._fillMiddleLineAtCells(C,w,L.getWidth()),L.isUnderline()&&E._fillBottomLineAtCells(C,w,L.getWidth()),E._ctx.restore()}})},f.prototype.onGridChanged=function(y,S){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,y,this._bufferService.cols,S-y+1),this._drawBackground(y,S),this._drawForeground(y,S))},f.prototype.onOptionsChanged=function(){this._setTransparency(this._optionsService.rawOptions.allowTransparency)},f.prototype._isOverlapping=function(y){if(y.getWidth()!==1||y.getCode()<256)return!1;var S=y.getChars();if(this._characterOverlapCache.hasOwnProperty(S))return this._characterOverlapCache[S];this._ctx.save(),this._ctx.font=this._characterFont;var E=Math.floor(this._ctx.measureText(S).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[S]=E,E},p([_(5,c.IBufferService),_(6,c.IOptionsService),_(7,r.ICharacterJoinerService)],f)}(m.BaseRenderLayer);t.TextRenderLayer=n},9616:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseCharAtlas=void 0;var o=function(){function a(){this._didWarmUp=!1}return a.prototype.dispose=function(){},a.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},a.prototype._doWarmUp=function(){},a.prototype.clear=function(){},a.prototype.beginFrame=function(){},a}();t.BaseCharAtlas=o},1420:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireCharAtlas=void 0;var a=o(2040),u=o(1906),p=[];t.acquireCharAtlas=function(_,b,m,h,v){for(var g=(0,a.generateConfig)(h,v,_,m),c=0;c<p.length;c++){var r=(i=p[c]).ownedBy.indexOf(b);if(r>=0){if((0,a.configEquals)(i.config,g))return i.atlas;i.ownedBy.length===1?(i.atlas.dispose(),p.splice(c,1)):i.ownedBy.splice(r,1);break}}for(c=0;c<p.length;c++){var i=p[c];if((0,a.configEquals)(i.config,g))return i.ownedBy.push(b),i.atlas}var n={atlas:new u.DynamicCharAtlas(document,g),config:g,ownedBy:[b]};return p.push(n),n.atlas},t.removeTerminalFromCache=function(_){for(var b=0;b<p.length;b++){var m=p[b].ownedBy.indexOf(_);if(m!==-1){p[b].ownedBy.length===1?(p[b].atlas.dispose(),p.splice(b,1)):p[b].ownedBy.splice(m,1);break}}}},2040:function(l,t,o){var a=this&&this.__spreadArray||function(p,_,b){if(b||arguments.length===2)for(var m,h=0,v=_.length;h<v;h++)!m&&h in _||(m||(m=Array.prototype.slice.call(_,0,h)),m[h]=_[h]);return p.concat(m||Array.prototype.slice.call(_))};Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var u=o(643);t.generateConfig=function(p,_,b,m){var h={foreground:m.foreground,background:m.background,cursor:void 0,cursorAccent:void 0,selection:void 0,ansi:a([],m.ansi,!0)};return{devicePixelRatio:window.devicePixelRatio,scaledCharWidth:p,scaledCharHeight:_,fontFamily:b.fontFamily,fontSize:b.fontSize,fontWeight:b.fontWeight,fontWeightBold:b.fontWeightBold,allowTransparency:b.allowTransparency,colors:h}},t.configEquals=function(p,_){for(var b=0;b<p.colors.ansi.length;b++)if(p.colors.ansi[b].rgba!==_.colors.ansi[b].rgba)return!1;return p.devicePixelRatio===_.devicePixelRatio&&p.fontFamily===_.fontFamily&&p.fontSize===_.fontSize&&p.fontWeight===_.fontWeight&&p.fontWeightBold===_.fontWeightBold&&p.allowTransparency===_.allowTransparency&&p.scaledCharWidth===_.scaledCharWidth&&p.scaledCharHeight===_.scaledCharHeight&&p.colors.foreground===_.colors.foreground&&p.colors.background===_.colors.background},t.is256Color=function(p){return p<u.DEFAULT_COLOR}},8803:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CHAR_ATLAS_CELL_SPACING=t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var a=o(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=a.isFirefox||a.isLegacyEdge?"bottom":"ideographic",t.CHAR_ATLAS_CELL_SPACING=1},1906:function(l,t,o){var a,u=this&&this.__extends||(a=function(S,E){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,C){L.__proto__=C}||function(L,C){for(var w in C)Object.prototype.hasOwnProperty.call(C,w)&&(L[w]=C[w])},a(S,E)},function(S,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function L(){this.constructor=S}a(S,E),S.prototype=E===null?Object.create(E):(L.prototype=E.prototype,new L)});Object.defineProperty(t,"__esModule",{value:!0}),t.NoneCharAtlas=t.DynamicCharAtlas=t.getGlyphCacheKey=void 0;var p=o(8803),_=o(9616),b=o(5680),m=o(7001),h=o(6114),v=o(1752),g=o(4774),c=1024,r=1024,i={css:"rgba(0, 0, 0, 0)",rgba:0};function n(S){return S.code<<21|S.bg<<12|S.fg<<3|(S.bold?0:4)+(S.dim?0:2)+(S.italic?0:1)}t.getGlyphCacheKey=n;var d=function(S){function E(L,C){var w=S.call(this)||this;w._config=C,w._drawToCacheCount=0,w._glyphsWaitingOnBitmap=[],w._bitmapCommitTimeout=null,w._bitmap=null,w._cacheCanvas=L.createElement("canvas"),w._cacheCanvas.width=c,w._cacheCanvas.height=r,w._cacheCtx=(0,v.throwIfFalsy)(w._cacheCanvas.getContext("2d",{alpha:!0}));var T=L.createElement("canvas");T.width=w._config.scaledCharWidth,T.height=w._config.scaledCharHeight,w._tmpCtx=(0,v.throwIfFalsy)(T.getContext("2d",{alpha:w._config.allowTransparency})),w._width=Math.floor(c/w._config.scaledCharWidth),w._height=Math.floor(r/w._config.scaledCharHeight);var A=w._width*w._height;return w._cacheMap=new m.LRUMap(A),w._cacheMap.prealloc(A),w}return u(E,S),E.prototype.dispose=function(){this._bitmapCommitTimeout!==null&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},E.prototype.beginFrame=function(){this._drawToCacheCount=0},E.prototype.clear=function(){if(this._cacheMap.size>0){var L=this._width*this._height;this._cacheMap=new m.LRUMap(L),this._cacheMap.prealloc(L)}this._cacheCtx.clearRect(0,0,c,r),this._tmpCtx.clearRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight)},E.prototype.draw=function(L,C,w,T){if(C.code===32)return!0;if(!this._canCache(C))return!1;var A=n(C),H=this._cacheMap.get(A);if(H!=null)return this._drawFromCache(L,H,w,T),!0;if(this._drawToCacheCount<100){var O;O=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var k=this._drawToCache(C,O);return this._cacheMap.set(A,k),this._drawFromCache(L,k,w,T),!0}return!1},E.prototype._canCache=function(L){return L.code<256},E.prototype._toCoordinateX=function(L){return L%this._width*this._config.scaledCharWidth},E.prototype._toCoordinateY=function(L){return Math.floor(L/this._width)*this._config.scaledCharHeight},E.prototype._drawFromCache=function(L,C,w,T){if(!C.isEmpty){var A=this._toCoordinateX(C.index),H=this._toCoordinateY(C.index);L.drawImage(C.inBitmap?this._bitmap:this._cacheCanvas,A,H,this._config.scaledCharWidth,this._config.scaledCharHeight,w,T,this._config.scaledCharWidth,this._config.scaledCharHeight)}},E.prototype._getColorFromAnsiIndex=function(L){return L<this._config.colors.ansi.length?this._config.colors.ansi[L]:b.DEFAULT_ANSI_COLORS[L]},E.prototype._getBackgroundColor=function(L){return this._config.allowTransparency?i:L.bg===p.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:L.bg<256?this._getColorFromAnsiIndex(L.bg):this._config.colors.background},E.prototype._getForegroundColor=function(L){return L.fg===p.INVERTED_DEFAULT_COLOR?g.color.opaque(this._config.colors.background):L.fg<256?this._getColorFromAnsiIndex(L.fg):this._config.colors.foreground},E.prototype._drawToCache=function(L,C){this._drawToCacheCount++,this._tmpCtx.save();var w=this._getBackgroundColor(L);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=w.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var T=L.bold?this._config.fontWeightBold:this._config.fontWeight,A=L.italic?"italic":"";this._tmpCtx.font=A+" "+T+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline=p.TEXT_BASELINE,this._tmpCtx.fillStyle=this._getForegroundColor(L).css,L.dim&&(this._tmpCtx.globalAlpha=p.DIM_OPACITY),this._tmpCtx.fillText(L.chars,0,this._config.scaledCharHeight);var H=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),O=!1;if(this._config.allowTransparency||(O=y(H,w)),O&&L.chars==="_"&&!this._config.allowTransparency)for(var k=1;k<=5&&(this._tmpCtx.fillText(L.chars,0,this._config.scaledCharHeight-k),O=y(H=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),w));k++);this._tmpCtx.restore();var x=this._toCoordinateX(C),D=this._toCoordinateY(C);this._cacheCtx.putImageData(H,x,D);var I={index:C,isEmpty:O,inBitmap:!1};return this._addGlyphToBitmap(I),I},E.prototype._addGlyphToBitmap=function(L){var C=this;!("createImageBitmap"in window)||h.isFirefox||h.isSafari||(this._glyphsWaitingOnBitmap.push(L),this._bitmapCommitTimeout===null&&(this._bitmapCommitTimeout=window.setTimeout(function(){return C._generateBitmap()},100)))},E.prototype._generateBitmap=function(){var L=this,C=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then(function(w){L._bitmap=w;for(var T=0;T<C.length;T++)C[T].inBitmap=!0}),this._bitmapCommitTimeout=null},E}(_.BaseCharAtlas);t.DynamicCharAtlas=d;var f=function(S){function E(L,C){return S.call(this)||this}return u(E,S),E.prototype.draw=function(L,C,w,T){return!1},E}(_.BaseCharAtlas);function y(S,E){for(var L=!0,C=E.rgba>>>24,w=E.rgba>>>16&255,T=E.rgba>>>8&255,A=0;A<S.data.length;A+=4)S.data[A]===C&&S.data[A+1]===w&&S.data[A+2]===T?S.data[A+3]=0:L=!1;return L}t.NoneCharAtlas=f},7001:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LRUMap=void 0;var o=function(){function a(u){this.capacity=u,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return a.prototype._unlinkNode=function(u){var p=u.prev,_=u.next;u===this._head&&(this._head=_),u===this._tail&&(this._tail=p),p!==null&&(p.next=_),_!==null&&(_.prev=p)},a.prototype._appendNode=function(u){var p=this._tail;p!==null&&(p.next=u),u.prev=p,u.next=null,this._tail=u,this._head===null&&(this._head=u)},a.prototype.prealloc=function(u){for(var p=this._nodePool,_=0;_<u;_++)p.push({prev:null,next:null,key:null,value:null})},a.prototype.get=function(u){var p=this._map[u];return p!==void 0?(this._unlinkNode(p),this._appendNode(p),p.value):null},a.prototype.peekValue=function(u){var p=this._map[u];return p!==void 0?p.value:null},a.prototype.peek=function(){var u=this._head;return u===null?null:u.value},a.prototype.set=function(u,p){var _=this._map[u];if(_!==void 0)_=this._map[u],this._unlinkNode(_),_.value=p;else if(this.size>=this.capacity)_=this._head,this._unlinkNode(_),delete this._map[_.key],_.key=u,_.value=p,this._map[u]=_;else{var b=this._nodePool;b.length>0?((_=b.pop()).key=u,_.value=p):_={prev:null,next:null,key:u,value:p},this._map[u]=_,this.size++}this._appendNode(_)},a}();t.LRUMap=o},1296:function(l,t,o){var a,u=this&&this.__extends||(a=function(L,C){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,T){w.__proto__=T}||function(w,T){for(var A in T)Object.prototype.hasOwnProperty.call(T,A)&&(w[A]=T[A])},a(L,C)},function(L,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function w(){this.constructor=L}a(L,C),L.prototype=C===null?Object.create(C):(w.prototype=C.prototype,new w)}),p=this&&this.__decorate||function(L,C,w,T){var A,H=arguments.length,O=H<3?C:T===null?T=Object.getOwnPropertyDescriptor(C,w):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(L,C,w,T);else for(var k=L.length-1;k>=0;k--)(A=L[k])&&(O=(H<3?A(O):H>3?A(C,w,O):A(C,w))||O);return H>3&&O&&Object.defineProperty(C,w,O),O},_=this&&this.__param||function(L,C){return function(w,T){C(w,T,L)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;var b=o(3787),m=o(8803),h=o(844),v=o(4725),g=o(2585),c=o(8460),r=o(4774),i=o(9631),n="xterm-dom-renderer-owner-",d="xterm-fg-",f="xterm-bg-",y="xterm-focus",S=1,E=function(L){function C(w,T,A,H,O,k,x,D,I,F){var W=L.call(this)||this;return W._colors=w,W._element=T,W._screenElement=A,W._viewportElement=H,W._linkifier=O,W._linkifier2=k,W._charSizeService=D,W._optionsService=I,W._bufferService=F,W._terminalClass=S++,W._rowElements=[],W._rowContainer=document.createElement("div"),W._rowContainer.classList.add("xterm-rows"),W._rowContainer.style.lineHeight="normal",W._rowContainer.setAttribute("aria-hidden","true"),W._refreshRowElements(W._bufferService.cols,W._bufferService.rows),W._selectionContainer=document.createElement("div"),W._selectionContainer.classList.add("xterm-selection"),W._selectionContainer.setAttribute("aria-hidden","true"),W.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},W._updateDimensions(),W._injectCss(),W._rowFactory=x.createInstance(b.DomRendererRowFactory,document,W._colors),W._element.classList.add(n+W._terminalClass),W._screenElement.appendChild(W._rowContainer),W._screenElement.appendChild(W._selectionContainer),W._linkifier.onShowLinkUnderline(function(J){return W._onLinkHover(J)}),W._linkifier.onHideLinkUnderline(function(J){return W._onLinkLeave(J)}),W._linkifier2.onShowLinkUnderline(function(J){return W._onLinkHover(J)}),W._linkifier2.onHideLinkUnderline(function(J){return W._onLinkLeave(J)}),W}return u(C,L),Object.defineProperty(C.prototype,"onRequestRedraw",{get:function(){return new c.EventEmitter().event},enumerable:!1,configurable:!0}),C.prototype.dispose=function(){this._element.classList.remove(n+this._terminalClass),(0,i.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement),L.prototype.dispose.call(this)},C.prototype._updateDimensions=function(){this.dimensions.scaledCharWidth=this._charSizeService.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.rawOptions.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._bufferService.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._bufferService.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows;for(var w=0,T=this._rowElements;w<T.length;w++){var A=T[w];A.style.width=this.dimensions.canvasWidth+"px",A.style.height=this.dimensions.actualCellHeight+"px",A.style.lineHeight=this.dimensions.actualCellHeight+"px",A.style.overflow="hidden"}this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var H=this._terminalSelector+" .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.textContent=H,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},C.prototype.setColors=function(w){this._colors=w,this._injectCss()},C.prototype._injectCss=function(){var w=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var T=this._terminalSelector+" .xterm-rows { color: "+this._colors.foreground.css+"; font-family: "+this._optionsService.rawOptions.fontFamily+"; font-size: "+this._optionsService.rawOptions.fontSize+"px;}";T+=this._terminalSelector+" span:not(."+b.BOLD_CLASS+") { font-weight: "+this._optionsService.rawOptions.fontWeight+";}"+this._terminalSelector+" span."+b.BOLD_CLASS+" { font-weight: "+this._optionsService.rawOptions.fontWeightBold+";}"+this._terminalSelector+" span."+b.ITALIC_CLASS+" { font-style: italic;}",T+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",T+="@keyframes blink_block_"+this._terminalClass+" { 0% {  background-color: "+this._colors.cursor.css+";  color: "+this._colors.cursorAccent.css+"; } 50% {  background-color: "+this._colors.cursorAccent.css+";  color: "+this._colors.cursor.css+"; }}",T+=this._terminalSelector+" .xterm-rows:not(.xterm-focus) ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_BLOCK_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+b.CURSOR_CLASS+"."+b.CURSOR_BLINK_CLASS+":not(."+b.CURSOR_STYLE_BLOCK_CLASS+") { animation: blink_box_shadow_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+b.CURSOR_CLASS+"."+b.CURSOR_BLINK_CLASS+"."+b.CURSOR_STYLE_BLOCK_CLASS+" { animation: blink_block_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" .xterm-rows ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_BAR_CLASS+" { box-shadow: "+this._optionsService.rawOptions.cursorWidth+"px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" .xterm-rows ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",T+=this._terminalSelector+" .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" .xterm-selection div { position: absolute; background-color: "+this._colors.selectionTransparent.css+";}",this._colors.ansi.forEach(function(A,H){T+=w._terminalSelector+" ."+d+H+" { color: "+A.css+"; }"+w._terminalSelector+" ."+f+H+" { background-color: "+A.css+"; }"}),T+=this._terminalSelector+" ."+d+m.INVERTED_DEFAULT_COLOR+" { color: "+r.color.opaque(this._colors.background).css+"; }"+this._terminalSelector+" ."+f+m.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.textContent=T},C.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},C.prototype._refreshRowElements=function(w,T){for(var A=this._rowElements.length;A<=T;A++){var H=document.createElement("div");this._rowContainer.appendChild(H),this._rowElements.push(H)}for(;this._rowElements.length>T;)this._rowContainer.removeChild(this._rowElements.pop())},C.prototype.onResize=function(w,T){this._refreshRowElements(w,T),this._updateDimensions()},C.prototype.onCharSizeChanged=function(){this._updateDimensions()},C.prototype.onBlur=function(){this._rowContainer.classList.remove(y)},C.prototype.onFocus=function(){this._rowContainer.classList.add(y)},C.prototype.onSelectionChanged=function(w,T,A){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(w&&T){var H=w[1]-this._bufferService.buffer.ydisp,O=T[1]-this._bufferService.buffer.ydisp,k=Math.max(H,0),x=Math.min(O,this._bufferService.rows-1);if(!(k>=this._bufferService.rows||x<0)){var D=document.createDocumentFragment();if(A)D.appendChild(this._createSelectionElement(k,w[0],T[0],x-k+1));else{var I=H===k?w[0]:0,F=k===O?T[0]:this._bufferService.cols;D.appendChild(this._createSelectionElement(k,I,F));var W=x-k-1;if(D.appendChild(this._createSelectionElement(k+1,0,this._bufferService.cols,W)),k!==x){var J=O===x?T[0]:this._bufferService.cols;D.appendChild(this._createSelectionElement(x,0,J))}}this._selectionContainer.appendChild(D)}}},C.prototype._createSelectionElement=function(w,T,A,H){H===void 0&&(H=1);var O=document.createElement("div");return O.style.height=H*this.dimensions.actualCellHeight+"px",O.style.top=w*this.dimensions.actualCellHeight+"px",O.style.left=T*this.dimensions.actualCellWidth+"px",O.style.width=this.dimensions.actualCellWidth*(A-T)+"px",O},C.prototype.onCursorMove=function(){},C.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss()},C.prototype.clear=function(){for(var w=0,T=this._rowElements;w<T.length;w++)T[w].innerText=""},C.prototype.renderRows=function(w,T){for(var A=this._bufferService.buffer.ybase+this._bufferService.buffer.y,H=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),O=this._optionsService.rawOptions.cursorBlink,k=w;k<=T;k++){var x=this._rowElements[k];x.innerText="";var D=k+this._bufferService.buffer.ydisp,I=this._bufferService.buffer.lines.get(D),F=this._optionsService.rawOptions.cursorStyle;x.appendChild(this._rowFactory.createRow(I,D,D===A,F,H,O,this.dimensions.actualCellWidth,this._bufferService.cols))}},Object.defineProperty(C.prototype,"_terminalSelector",{get:function(){return"."+n+this._terminalClass},enumerable:!1,configurable:!0}),C.prototype._onLinkHover=function(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!0)},C.prototype._onLinkLeave=function(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!1)},C.prototype._setCellUnderline=function(w,T,A,H,O,k){for(;w!==T||A!==H;){var x=this._rowElements[A];if(!x)return;var D=x.children[w];D&&(D.style.textDecoration=k?"underline":"none"),++w>=O&&(w=0,A++)}},p([_(6,g.IInstantiationService),_(7,v.ICharSizeService),_(8,g.IOptionsService),_(9,g.IBufferService)],C)}(h.Disposable);t.DomRenderer=E},3787:function(l,t,o){var a=this&&this.__decorate||function(i,n,d,f){var y,S=arguments.length,E=S<3?n:f===null?f=Object.getOwnPropertyDescriptor(n,d):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(i,n,d,f);else for(var L=i.length-1;L>=0;L--)(y=i[L])&&(E=(S<3?y(E):S>3?y(n,d,E):y(n,d))||E);return S>3&&E&&Object.defineProperty(n,d,E),E},u=this&&this.__param||function(i,n){return function(d,f){n(d,f,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;var p=o(8803),_=o(643),b=o(511),m=o(2585),h=o(4774),v=o(4725),g=o(4269);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var c=function(){function i(n,d,f,y,S){this._document=n,this._colors=d,this._characterJoinerService=f,this._optionsService=y,this._coreService=S,this._workCell=new b.CellData}return i.prototype.setColors=function(n){this._colors=n},i.prototype.createRow=function(n,d,f,y,S,E,L,C){for(var w=this._document.createDocumentFragment(),T=this._characterJoinerService.getJoinedCharacters(d),A=0,H=Math.min(n.length,C)-1;H>=0;H--)if(n.loadCell(H,this._workCell).getCode()!==_.NULL_CELL_CODE||f&&H===S){A=H+1;break}for(H=0;H<A;H++){n.loadCell(H,this._workCell);var O=this._workCell.getWidth();if(O!==0){var k=!1,x=H,D=this._workCell;if(T.length>0&&H===T[0][0]){k=!0;var I=T.shift();D=new g.JoinedCellData(this._workCell,n.translateToString(!0,I[0],I[1]),I[1]-I[0]),x=I[1]-1,O=D.getWidth()}var F=this._document.createElement("span");if(O>1&&(F.style.width=L*O+"px"),k&&(F.style.display="inline",S>=H&&S<=x&&(S=H)),!this._coreService.isCursorHidden&&f&&H===S)switch(F.classList.add(t.CURSOR_CLASS),E&&F.classList.add(t.CURSOR_BLINK_CLASS),y){case"bar":F.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":F.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:F.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}D.isBold()&&F.classList.add(t.BOLD_CLASS),D.isItalic()&&F.classList.add(t.ITALIC_CLASS),D.isDim()&&F.classList.add(t.DIM_CLASS),D.isUnderline()&&F.classList.add(t.UNDERLINE_CLASS),D.isInvisible()?F.textContent=_.WHITESPACE_CELL_CHAR:F.textContent=D.getChars()||_.WHITESPACE_CELL_CHAR,D.isStrikethrough()&&F.classList.add(t.STRIKETHROUGH_CLASS);var W=D.getFgColor(),J=D.getFgColorMode(),$=D.getBgColor(),G=D.getBgColorMode(),R=!!D.isInverse();if(R){var N=W;W=$,$=N;var P=J;J=G,G=P}switch(J){case 16777216:case 33554432:D.isBold()&&W<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(W+=8),this._applyMinimumContrast(F,this._colors.background,this._colors.ansi[W])||F.classList.add("xterm-fg-"+W);break;case 50331648:var B=h.rgba.toColor(W>>16&255,W>>8&255,255&W);this._applyMinimumContrast(F,this._colors.background,B)||this._addStyle(F,"color:#"+r(W.toString(16),"0",6));break;default:this._applyMinimumContrast(F,this._colors.background,this._colors.foreground)||R&&F.classList.add("xterm-fg-"+p.INVERTED_DEFAULT_COLOR)}switch(G){case 16777216:case 33554432:F.classList.add("xterm-bg-"+$);break;case 50331648:this._addStyle(F,"background-color:#"+r($.toString(16),"0",6));break;default:R&&F.classList.add("xterm-bg-"+p.INVERTED_DEFAULT_COLOR)}w.appendChild(F),H=x}}return w},i.prototype._applyMinimumContrast=function(n,d,f){if(this._optionsService.rawOptions.minimumContrastRatio===1)return!1;var y=this._colors.contrastCache.getColor(this._workCell.bg,this._workCell.fg);return y===void 0&&(y=h.color.ensureContrastRatio(d,f,this._optionsService.rawOptions.minimumContrastRatio),this._colors.contrastCache.setColor(this._workCell.bg,this._workCell.fg,y!=null?y:null)),!!y&&(this._addStyle(n,"color:"+y.css),!0)},i.prototype._addStyle=function(n,d){n.setAttribute("style",""+(n.getAttribute("style")||"")+d+";")},a([u(2,v.ICharacterJoinerService),u(3,m.IOptionsService),u(4,m.ICoreService)],i)}();function r(i,n,d){for(;i.length<d;)i=n+i;return i}t.DomRendererRowFactory=c},456:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0;var o=function(){function a(u){this._bufferService=u,this.isSelectAllActive=!1,this.selectionStartLength=0}return a.prototype.clearSelection=function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(a.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){var u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?u%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)-1]:[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[u,this.selectionStart[1]]}return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd}},enumerable:!1,configurable:!0}),a.prototype.areSelectionValuesReversed=function(){var u=this.selectionStart,p=this.selectionEnd;return!(!u||!p)&&(u[1]>p[1]||u[1]===p[1]&&u[0]>p[0])},a.prototype.onTrim=function(u){return this.selectionStart&&(this.selectionStart[1]-=u),this.selectionEnd&&(this.selectionEnd[1]-=u),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},a}();t.SelectionModel=o},428:function(l,t,o){var a=this&&this.__decorate||function(h,v,g,c){var r,i=arguments.length,n=i<3?v:c===null?c=Object.getOwnPropertyDescriptor(v,g):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(h,v,g,c);else for(var d=h.length-1;d>=0;d--)(r=h[d])&&(n=(i<3?r(n):i>3?r(v,g,n):r(v,g))||n);return i>3&&n&&Object.defineProperty(v,g,n),n},u=this&&this.__param||function(h,v){return function(g,c){v(g,c,h)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;var p=o(2585),_=o(8460),b=function(){function h(v,g,c){this._optionsService=c,this.width=0,this.height=0,this._onCharSizeChange=new _.EventEmitter,this._measureStrategy=new m(v,g,this._optionsService)}return Object.defineProperty(h.prototype,"hasValidSize",{get:function(){return this.width>0&&this.height>0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onCharSizeChange",{get:function(){return this._onCharSizeChange.event},enumerable:!1,configurable:!0}),h.prototype.measure=function(){var v=this._measureStrategy.measure();v.width===this.width&&v.height===this.height||(this.width=v.width,this.height=v.height,this._onCharSizeChange.fire())},a([u(2,p.IOptionsService)],h)}();t.CharSizeService=b;var m=function(){function h(v,g,c){this._document=v,this._parentElement=g,this._optionsService=c,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return h.prototype.measure=function(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var v=this._measureElement.getBoundingClientRect();return v.width!==0&&v.height!==0&&(this._result.width=v.width,this._result.height=Math.ceil(v.height)),this._result},h}()},4269:function(l,t,o){var a,u=this&&this.__extends||(a=function(r,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,d){n.__proto__=d}||function(n,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(n[f]=d[f])},a(r,i)},function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=r}a(r,i),r.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}),p=this&&this.__decorate||function(r,i,n,d){var f,y=arguments.length,S=y<3?i:d===null?d=Object.getOwnPropertyDescriptor(i,n):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(r,i,n,d);else for(var E=r.length-1;E>=0;E--)(f=r[E])&&(S=(y<3?f(S):y>3?f(i,n,S):f(i,n))||S);return y>3&&S&&Object.defineProperty(i,n,S),S},_=this&&this.__param||function(r,i){return function(n,d){i(n,d,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;var b=o(3734),m=o(643),h=o(511),v=o(2585),g=function(r){function i(n,d,f){var y=r.call(this)||this;return y.content=0,y.combinedData="",y.fg=n.fg,y.bg=n.bg,y.combinedData=d,y._width=f,y}return u(i,r),i.prototype.isCombined=function(){return 2097152},i.prototype.getWidth=function(){return this._width},i.prototype.getChars=function(){return this.combinedData},i.prototype.getCode=function(){return 2097151},i.prototype.setFromCharData=function(n){throw new Error("not implemented")},i.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},i}(b.AttributeData);t.JoinedCellData=g;var c=function(){function r(i){this._bufferService=i,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new h.CellData}return r.prototype.register=function(i){var n={id:this._nextCharacterJoinerId++,handler:i};return this._characterJoiners.push(n),n.id},r.prototype.deregister=function(i){for(var n=0;n<this._characterJoiners.length;n++)if(this._characterJoiners[n].id===i)return this._characterJoiners.splice(n,1),!0;return!1},r.prototype.getJoinedCharacters=function(i){if(this._characterJoiners.length===0)return[];var n=this._bufferService.buffer.lines.get(i);if(!n||n.length===0)return[];for(var d=[],f=n.translateToString(!0),y=0,S=0,E=0,L=n.getFg(0),C=n.getBg(0),w=0;w<n.getTrimmedLength();w++)if(n.loadCell(w,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==L||this._workCell.bg!==C){if(w-y>1)for(var T=this._getJoinedRanges(f,E,S,n,y),A=0;A<T.length;A++)d.push(T[A]);y=w,E=S,L=this._workCell.fg,C=this._workCell.bg}S+=this._workCell.getChars().length||m.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-y>1)for(T=this._getJoinedRanges(f,E,S,n,y),A=0;A<T.length;A++)d.push(T[A]);return d},r.prototype._getJoinedRanges=function(i,n,d,f,y){var S=i.substring(n,d),E=[];try{E=this._characterJoiners[0].handler(S)}catch(T){console.error(T)}for(var L=1;L<this._characterJoiners.length;L++)try{for(var C=this._characterJoiners[L].handler(S),w=0;w<C.length;w++)r._mergeRanges(E,C[w])}catch(T){console.error(T)}return this._stringRangesToCellRanges(E,f,y),E},r.prototype._stringRangesToCellRanges=function(i,n,d){var f=0,y=!1,S=0,E=i[f];if(E){for(var L=d;L<this._bufferService.cols;L++){var C=n.getWidth(L),w=n.getString(L).length||m.WHITESPACE_CELL_CHAR.length;if(C!==0){if(!y&&E[0]<=S&&(E[0]=L,y=!0),E[1]<=S){if(E[1]=L,!(E=i[++f]))break;E[0]<=S?(E[0]=L,y=!0):y=!1}S+=w}}E&&(E[1]=this._bufferService.cols)}},r._mergeRanges=function(i,n){for(var d=!1,f=0;f<i.length;f++){var y=i[f];if(d){if(n[1]<=y[0])return i[f-1][1]=n[1],i;if(n[1]<=y[1])return i[f-1][1]=Math.max(n[1],y[1]),i.splice(f,1),i;i.splice(f,1),f--}else{if(n[1]<=y[0])return i.splice(f,0,n),i;if(n[1]<=y[1])return y[0]=Math.min(n[0],y[0]),i;n[0]<y[1]&&(y[0]=Math.min(n[0],y[0]),d=!0)}}return d?i[i.length-1][1]=n[1]:i.push(n),i},r=p([_(0,v.IBufferService)],r)}();t.CharacterJoinerService=c},5114:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;var o=function(){function a(u){this._textarea=u}return Object.defineProperty(a.prototype,"isFocused",{get:function(){return(this._textarea.getRootNode?this._textarea.getRootNode():document).activeElement===this._textarea&&document.hasFocus()},enumerable:!1,configurable:!0}),a}();t.CoreBrowserService=o},7641:function(l,t,o){var a,u=this&&this.__extends||(a=function(c,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(i[d]=n[d])},a(c,r)},function(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=c}a(c,r),c.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}),p=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},_=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Decoration=t.DecorationService=void 0;var b=o(8460),m=o(844),h=o(2585),v=function(c){function r(i){var n=c.call(this)||this;return n._instantiationService=i,n._decorations=[],n}return u(r,c),r.prototype.attachToDom=function(i,n){var d=this;this._renderService=n,this._screenElement=i,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),i.appendChild(this._container),this.register(this._renderService.onRenderedBufferChange(function(){return d.refresh()})),this.register(this._renderService.onDimensionsChange(function(){return d.refresh(!0)}))},r.prototype.registerDecoration=function(i){var n=this;if(!i.marker.isDisposed&&this._container){var d=this._instantiationService.createInstance(g,i,this._container);return this._decorations.push(d),d.onDispose(function(){return n._decorations.splice(n._decorations.indexOf(d),1)}),this._queueRefresh(),d}},r.prototype._queueRefresh=function(){var i=this;this._animationFrame===void 0&&(this._animationFrame=window.requestAnimationFrame(function(){i.refresh(),i._animationFrame=void 0}))},r.prototype.refresh=function(i){if(this._renderService)for(var n=0,d=this._decorations;n<d.length;n++)d[n].render(this._renderService,i)},r.prototype.dispose=function(){for(var i=0,n=this._decorations;i<n.length;i++)n[i].dispose();this._screenElement&&this._container&&this._screenElement.contains(this._container)&&this._screenElement.removeChild(this._container)},p([_(0,h.IInstantiationService)],r)}(m.Disposable);t.DecorationService=v;var g=function(c){function r(i,n,d){var f,y=c.call(this)||this;return y._container=n,y._bufferService=d,y.isDisposed=!1,y._onDispose=new b.EventEmitter,y._onRender=new b.EventEmitter,y.x=(f=i.x)!==null&&f!==void 0?f:0,y._marker=i.marker,y._marker.onDispose(function(){return y.dispose()}),y.anchor=i.anchor||"left",y.width=i.width||1,y.height=i.height||1,y}return u(r,c),Object.defineProperty(r.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"marker",{get:function(){return this._marker},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),r.prototype.render=function(i,n){this._element&&!n||this._createElement(i,n),this._container&&this._element&&!this._container.contains(this._element)&&this._container.append(this._element),this._refreshStyle(i),this._element&&this._onRender.fire(this._element)},r.prototype._createElement=function(i,n){n&&this._element&&this._container.contains(this._element)&&this._container.removeChild(this._element),this._element=document.createElement("div"),this._element.classList.add("xterm-decoration"),this._element.style.width=this.width*i.dimensions.actualCellWidth+"px",this._element.style.height=this.height*i.dimensions.actualCellHeight+"px",this._element.style.top=(this.marker.line-this._bufferService.buffers.active.ydisp)*i.dimensions.actualCellHeight+"px",this._element.style.lineHeight=i.dimensions.actualCellHeight+"px",this.x&&this.x>this._bufferService.cols&&(this._element.style.display="none"),this.anchor==="right"?this._element.style.right=this.x?this.x*i.dimensions.actualCellWidth+"px":"":this._element.style.left=this.x?this.x*i.dimensions.actualCellWidth+"px":""},r.prototype._refreshStyle=function(i){if(this._element){var n=this.marker.line-this._bufferService.buffers.active.ydisp;n<0||n>this._bufferService.rows?this._element.style.display="none":(this._element.style.top=n*i.dimensions.actualCellHeight+"px",this._element.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block")}},r.prototype.dispose=function(){this.isDisposed||(this._element&&this._container.contains(this._element)&&this._container.removeChild(this._element),this.isDisposed=!0,this._onDispose.fire())},p([_(2,h.IBufferService)],r)}(m.Disposable);t.Decoration=g},8934:function(l,t,o){var a=this&&this.__decorate||function(m,h,v,g){var c,r=arguments.length,i=r<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,v):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(m,h,v,g);else for(var n=m.length-1;n>=0;n--)(c=m[n])&&(i=(r<3?c(i):r>3?c(h,v,i):c(h,v))||i);return r>3&&i&&Object.defineProperty(h,v,i),i},u=this&&this.__param||function(m,h){return function(v,g){h(v,g,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;var p=o(4725),_=o(9806),b=function(){function m(h,v){this._renderService=h,this._charSizeService=v}return m.prototype.getCoords=function(h,v,g,c,r){return(0,_.getCoords)(h,v,g,c,this._charSizeService.hasValidSize,this._renderService.dimensions.actualCellWidth,this._renderService.dimensions.actualCellHeight,r)},m.prototype.getRawByteCoords=function(h,v,g,c){var r=this.getCoords(h,v,g,c);return(0,_.getRawByteCoords)(r)},a([u(0,p.IRenderService),u(1,p.ICharSizeService)],m)}();t.MouseService=b},3230:function(l,t,o){var a,u=this&&this.__extends||(a=function(n,d){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,y){f.__proto__=y}||function(f,y){for(var S in y)Object.prototype.hasOwnProperty.call(y,S)&&(f[S]=y[S])},a(n,d)},function(n,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function f(){this.constructor=n}a(n,d),n.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}),p=this&&this.__decorate||function(n,d,f,y){var S,E=arguments.length,L=E<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,f):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(n,d,f,y);else for(var C=n.length-1;C>=0;C--)(S=n[C])&&(L=(E<3?S(L):E>3?S(d,f,L):S(d,f))||L);return E>3&&L&&Object.defineProperty(d,f,L),L},_=this&&this.__param||function(n,d){return function(f,y){d(f,y,n)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;var b=o(6193),m=o(8460),h=o(844),v=o(5596),g=o(3656),c=o(2585),r=o(4725),i=function(n){function d(f,y,S,E,L,C){var w=n.call(this)||this;if(w._renderer=f,w._rowCount=y,w._charSizeService=L,w._isPaused=!1,w._needsFullRefresh=!1,w._isNextRenderRedrawOnly=!0,w._needsSelectionRefresh=!1,w._canvasWidth=0,w._canvasHeight=0,w._selectionState={start:void 0,end:void 0,columnSelectMode:!1},w._onDimensionsChange=new m.EventEmitter,w._onRender=new m.EventEmitter,w._onRefreshRequest=new m.EventEmitter,w.register({dispose:function(){return w._renderer.dispose()}}),w._renderDebouncer=new b.RenderDebouncer(function(A,H){return w._renderRows(A,H)}),w.register(w._renderDebouncer),w._screenDprMonitor=new v.ScreenDprMonitor,w._screenDprMonitor.setListener(function(){return w.onDevicePixelRatioChange()}),w.register(w._screenDprMonitor),w.register(C.onResize(function(){return w._fullRefresh()})),w.register(C.buffers.onBufferActivate(function(){var A;return(A=w._renderer)===null||A===void 0?void 0:A.clear()})),w.register(E.onOptionChange(function(){return w._renderer.onOptionsChanged()})),w.register(w._charSizeService.onCharSizeChange(function(){return w.onCharSizeChanged()})),w._renderer.onRequestRedraw(function(A){return w.refreshRows(A.start,A.end,!0)}),w.register((0,g.addDisposableDomListener)(window,"resize",function(){return w.onDevicePixelRatioChange()})),"IntersectionObserver"in window){var T=new IntersectionObserver(function(A){return w._onIntersectionChange(A[A.length-1])},{threshold:0});T.observe(S),w.register({dispose:function(){return T.disconnect()}})}return w}return u(d,n),Object.defineProperty(d.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onRenderedBufferChange",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!1,configurable:!0}),d.prototype._onIntersectionChange=function(f){this._isPaused=f.isIntersecting===void 0?f.intersectionRatio===0:!f.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},d.prototype.refreshRows=function(f,y,S){S===void 0&&(S=!1),this._isPaused?this._needsFullRefresh=!0:(S||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(f,y,this._rowCount))},d.prototype._renderRows=function(f,y){this._renderer.renderRows(f,y),this._needsSelectionRefresh&&(this._renderer.onSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRender.fire({start:f,end:y}),this._isNextRenderRedrawOnly=!0},d.prototype.resize=function(f,y){this._rowCount=y,this._fireOnCanvasResize()},d.prototype.changeOptions=function(){this._renderer.onOptionsChanged(),this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize()},d.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},d.prototype.dispose=function(){n.prototype.dispose.call(this)},d.prototype.setRenderer=function(f){var y=this;this._renderer.dispose(),this._renderer=f,this._renderer.onRequestRedraw(function(S){return y.refreshRows(S.start,S.end,!0)}),this._needsSelectionRefresh=!0,this._fullRefresh()},d.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)},d.prototype.clearTextureAtlas=function(){var f,y;(y=(f=this._renderer)===null||f===void 0?void 0:f.clearTextureAtlas)===null||y===void 0||y.call(f),this._fullRefresh()},d.prototype.setColors=function(f){this._renderer.setColors(f),this._fullRefresh()},d.prototype.onDevicePixelRatioChange=function(){this._charSizeService.measure(),this._renderer.onDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1)},d.prototype.onResize=function(f,y){this._renderer.onResize(f,y),this._fullRefresh()},d.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},d.prototype.onBlur=function(){this._renderer.onBlur()},d.prototype.onFocus=function(){this._renderer.onFocus()},d.prototype.onSelectionChanged=function(f,y,S){this._selectionState.start=f,this._selectionState.end=y,this._selectionState.columnSelectMode=S,this._renderer.onSelectionChanged(f,y,S)},d.prototype.onCursorMove=function(){this._renderer.onCursorMove()},d.prototype.clear=function(){this._renderer.clear()},p([_(3,c.IOptionsService),_(4,r.ICharSizeService),_(5,c.IBufferService)],d)}(h.Disposable);t.RenderService=i},9312:function(l,t,o){var a,u=this&&this.__extends||(a=function(E,L){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,w){C.__proto__=w}||function(C,w){for(var T in w)Object.prototype.hasOwnProperty.call(w,T)&&(C[T]=w[T])},a(E,L)},function(E,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function C(){this.constructor=E}a(E,L),E.prototype=L===null?Object.create(L):(C.prototype=L.prototype,new C)}),p=this&&this.__decorate||function(E,L,C,w){var T,A=arguments.length,H=A<3?L:w===null?w=Object.getOwnPropertyDescriptor(L,C):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(E,L,C,w);else for(var O=E.length-1;O>=0;O--)(T=E[O])&&(H=(A<3?T(H):A>3?T(L,C,H):T(L,C))||H);return A>3&&H&&Object.defineProperty(L,C,H),H},_=this&&this.__param||function(E,L){return function(C,w){L(C,w,E)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;var b=o(6114),m=o(456),h=o(511),v=o(8460),g=o(4725),c=o(2585),r=o(9806),i=o(9504),n=o(844),d=o(4841),f=String.fromCharCode(160),y=new RegExp(f,"g"),S=function(E){function L(C,w,T,A,H,O,k,x){var D=E.call(this)||this;return D._element=C,D._screenElement=w,D._linkifier=T,D._bufferService=A,D._coreService=H,D._mouseService=O,D._optionsService=k,D._renderService=x,D._dragScrollAmount=0,D._enabled=!0,D._workCell=new h.CellData,D._mouseDownTimeStamp=0,D._oldHasSelection=!1,D._oldSelectionStart=void 0,D._oldSelectionEnd=void 0,D._onLinuxMouseSelection=D.register(new v.EventEmitter),D._onRedrawRequest=D.register(new v.EventEmitter),D._onSelectionChange=D.register(new v.EventEmitter),D._onRequestScrollLines=D.register(new v.EventEmitter),D._mouseMoveListener=function(I){return D._onMouseMove(I)},D._mouseUpListener=function(I){return D._onMouseUp(I)},D._coreService.onUserInput(function(){D.hasSelection&&D.clearSelection()}),D._trimListener=D._bufferService.buffer.lines.onTrim(function(I){return D._onTrim(I)}),D.register(D._bufferService.buffers.onBufferActivate(function(I){return D._onBufferActivate(I)})),D.enable(),D._model=new m.SelectionModel(D._bufferService),D._activeSelectionMode=0,D}return u(L,E),Object.defineProperty(L.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onRequestRedraw",{get:function(){return this._onRedrawRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onRequestScrollLines",{get:function(){return this._onRequestScrollLines.event},enumerable:!1,configurable:!0}),L.prototype.dispose=function(){this._removeMouseDownListeners()},L.prototype.reset=function(){this.clearSelection()},L.prototype.disable=function(){this.clearSelection(),this._enabled=!1},L.prototype.enable=function(){this._enabled=!0},Object.defineProperty(L.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"hasSelection",{get:function(){var C=this._model.finalSelectionStart,w=this._model.finalSelectionEnd;return!(!C||!w||C[0]===w[0]&&C[1]===w[1])},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"selectionText",{get:function(){var C=this._model.finalSelectionStart,w=this._model.finalSelectionEnd;if(!C||!w)return"";var T=this._bufferService.buffer,A=[];if(this._activeSelectionMode===3){if(C[0]===w[0])return"";for(var H=C[1];H<=w[1];H++){var O=T.translateBufferLineToString(H,!0,C[0],w[0]);A.push(O)}}else{var k=C[1]===w[1]?w[0]:void 0;for(A.push(T.translateBufferLineToString(C[1],!0,C[0],k)),H=C[1]+1;H<=w[1]-1;H++){var x=T.lines.get(H);O=T.translateBufferLineToString(H,!0),x!=null&&x.isWrapped?A[A.length-1]+=O:A.push(O)}C[1]!==w[1]&&(x=T.lines.get(w[1]),O=T.translateBufferLineToString(w[1],!0,0,w[0]),x&&x.isWrapped?A[A.length-1]+=O:A.push(O))}return A.map(function(D){return D.replace(y," ")}).join(b.isWindows?`\r
`:`
`)},enumerable:!1,configurable:!0}),L.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},L.prototype.refresh=function(C){var w=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(function(){return w._refresh()})),b.isLinux&&C&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},L.prototype._refresh=function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})},L.prototype._isClickInSelection=function(C){var w=this._getMouseBufferCoords(C),T=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!!(T&&A&&w)&&this._areCoordsInSelection(w,T,A)},L.prototype._areCoordsInSelection=function(C,w,T){return C[1]>w[1]&&C[1]<T[1]||w[1]===T[1]&&C[1]===w[1]&&C[0]>=w[0]&&C[0]<T[0]||w[1]<T[1]&&C[1]===T[1]&&C[0]<T[0]||w[1]<T[1]&&C[1]===w[1]&&C[0]>=w[0]},L.prototype._selectWordAtCursor=function(C,w){var T,A,H=(A=(T=this._linkifier.currentLink)===null||T===void 0?void 0:T.link)===null||A===void 0?void 0:A.range;if(H)return this._model.selectionStart=[H.start.x-1,H.start.y-1],this._model.selectionStartLength=(0,d.getRangeLength)(H,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var O=this._getMouseBufferCoords(C);return!!O&&(this._selectWordAt(O,w),this._model.selectionEnd=void 0,!0)},L.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},L.prototype.selectLines=function(C,w){this._model.clearSelection(),C=Math.max(C,0),w=Math.min(w,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,C],this._model.selectionEnd=[this._bufferService.cols,w],this.refresh(),this._onSelectionChange.fire()},L.prototype._onTrim=function(C){this._model.onTrim(C)&&this.refresh()},L.prototype._getMouseBufferCoords=function(C){var w=this._mouseService.getCoords(C,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(w)return w[0]--,w[1]--,w[1]+=this._bufferService.buffer.ydisp,w},L.prototype._getMouseEventScrollAmount=function(C){var w=(0,r.getCoordsRelativeToElement)(C,this._screenElement)[1],T=this._renderService.dimensions.canvasHeight;return w>=0&&w<=T?0:(w>T&&(w-=T),w=Math.min(Math.max(w,-50),50),(w/=50)/Math.abs(w)+Math.round(14*w))},L.prototype.shouldForceSelection=function(C){return b.isMac?C.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:C.shiftKey},L.prototype.onMouseDown=function(C){if(this._mouseDownTimeStamp=C.timeStamp,(C.button!==2||!this.hasSelection)&&C.button===0){if(!this._enabled){if(!this.shouldForceSelection(C))return;C.stopPropagation()}C.preventDefault(),this._dragScrollAmount=0,this._enabled&&C.shiftKey?this._onIncrementalClick(C):C.detail===1?this._onSingleClick(C):C.detail===2?this._onDoubleClick(C):C.detail===3&&this._onTripleClick(C),this._addMouseDownListeners(),this.refresh(!0)}},L.prototype._addMouseDownListeners=function(){var C=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=window.setInterval(function(){return C._dragScroll()},50)},L.prototype._removeMouseDownListeners=function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0},L.prototype._onIncrementalClick=function(C){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(C))},L.prototype._onSingleClick=function(C){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(C)?3:0,this._model.selectionStart=this._getMouseBufferCoords(C),this._model.selectionStart){this._model.selectionEnd=void 0;var w=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);w&&w.length!==this._model.selectionStart[0]&&w.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}},L.prototype._onDoubleClick=function(C){this._selectWordAtCursor(C,!0)&&(this._activeSelectionMode=1)},L.prototype._onTripleClick=function(C){var w=this._getMouseBufferCoords(C);w&&(this._activeSelectionMode=2,this._selectLineAt(w[1]))},L.prototype.shouldColumnSelect=function(C){return C.altKey&&!(b.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)},L.prototype._onMouseMove=function(C){if(C.stopImmediatePropagation(),this._model.selectionStart){var w=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(C),this._model.selectionEnd){this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(C),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var T=this._bufferService.buffer;if(this._model.selectionEnd[1]<T.lines.length){var A=T.lines.get(this._model.selectionEnd[1]);A&&A.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}w&&w[0]===this._model.selectionEnd[0]&&w[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}},L.prototype._dragScroll=function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var C=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(C.ydisp+this._bufferService.rows,C.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=C.ydisp),this.refresh()}},L.prototype._onMouseUp=function(C){var w=C.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&w<500&&C.altKey&&this._optionsService.getOption("altClickMovesCursor")){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var T=this._mouseService.getCoords(C,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(T&&T[0]!==void 0&&T[1]!==void 0){var A=(0,i.moveToCellSequence)(T[0]-1,T[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(A,!0)}}}else this._fireEventIfSelectionChanged()},L.prototype._fireEventIfSelectionChanged=function(){var C=this._model.finalSelectionStart,w=this._model.finalSelectionEnd,T=!(!C||!w||C[0]===w[0]&&C[1]===w[1]);T?C&&w&&(this._oldSelectionStart&&this._oldSelectionEnd&&C[0]===this._oldSelectionStart[0]&&C[1]===this._oldSelectionStart[1]&&w[0]===this._oldSelectionEnd[0]&&w[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(C,w,T)):this._oldHasSelection&&this._fireOnSelectionChange(C,w,T)},L.prototype._fireOnSelectionChange=function(C,w,T){this._oldSelectionStart=C,this._oldSelectionEnd=w,this._oldHasSelection=T,this._onSelectionChange.fire()},L.prototype._onBufferActivate=function(C){var w=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=C.activeBuffer.lines.onTrim(function(T){return w._onTrim(T)})},L.prototype._convertViewportColToCharacterIndex=function(C,w){for(var T=w[0],A=0;w[0]>=A;A++){var H=C.loadCell(A,this._workCell).getChars().length;this._workCell.getWidth()===0?T--:H>1&&w[0]!==A&&(T+=H-1)}return T},L.prototype.setSelection=function(C,w,T){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[C,w],this._model.selectionStartLength=T,this.refresh()},L.prototype.rightClickSelect=function(C){this._isClickInSelection(C)||(this._selectWordAtCursor(C,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())},L.prototype._getWordAt=function(C,w,T,A){if(T===void 0&&(T=!0),A===void 0&&(A=!0),!(C[0]>=this._bufferService.cols)){var H=this._bufferService.buffer,O=H.lines.get(C[1]);if(O){var k=H.translateBufferLineToString(C[1],!1),x=this._convertViewportColToCharacterIndex(O,C),D=x,I=C[0]-x,F=0,W=0,J=0,$=0;if(k.charAt(x)===" "){for(;x>0&&k.charAt(x-1)===" ";)x--;for(;D<k.length&&k.charAt(D+1)===" ";)D++}else{var G=C[0],R=C[0];O.getWidth(G)===0&&(F++,G--),O.getWidth(R)===2&&(W++,R++);var N=O.getString(R).length;for(N>1&&($+=N-1,D+=N-1);G>0&&x>0&&!this._isCharWordSeparator(O.loadCell(G-1,this._workCell));){O.loadCell(G-1,this._workCell);var P=this._workCell.getChars().length;this._workCell.getWidth()===0?(F++,G--):P>1&&(J+=P-1,x-=P-1),x--,G--}for(;R<O.length&&D+1<k.length&&!this._isCharWordSeparator(O.loadCell(R+1,this._workCell));){O.loadCell(R+1,this._workCell);var B=this._workCell.getChars().length;this._workCell.getWidth()===2?(W++,R++):B>1&&($+=B-1,D+=B-1),D++,R++}}D++;var M=x+I-F+J,K=Math.min(this._bufferService.cols,D-x+F+W-J-$);if(w||k.slice(x,D).trim()!==""){if(T&&M===0&&O.getCodePoint(0)!==32){var V=H.lines.get(C[1]-1);if(V&&O.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){var X=this._getWordAt([this._bufferService.cols-1,C[1]-1],!1,!0,!1);if(X){var Y=this._bufferService.cols-X.start;M-=Y,K+=Y}}}if(A&&M+K===this._bufferService.cols&&O.getCodePoint(this._bufferService.cols-1)!==32){var Z=H.lines.get(C[1]+1);if((Z==null?void 0:Z.isWrapped)&&Z.getCodePoint(0)!==32){var fe=this._getWordAt([0,C[1]+1],!1,!1,!0);fe&&(K+=fe.length)}}return{start:M,length:K}}}}},L.prototype._selectWordAt=function(C,w){var T=this._getWordAt(C,w);if(T){for(;T.start<0;)T.start+=this._bufferService.cols,C[1]--;this._model.selectionStart=[T.start,C[1]],this._model.selectionStartLength=T.length}},L.prototype._selectToWordAt=function(C){var w=this._getWordAt(C,!0);if(w){for(var T=C[1];w.start<0;)w.start+=this._bufferService.cols,T--;if(!this._model.areSelectionValuesReversed())for(;w.start+w.length>this._bufferService.cols;)w.length-=this._bufferService.cols,T++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?w.start:w.start+w.length,T]}},L.prototype._isCharWordSeparator=function(C){return C.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(C.getChars())>=0},L.prototype._selectLineAt=function(C){var w=this._bufferService.buffer.getWrappedRangeForLine(C);this._model.selectionStart=[0,w.first],this._model.selectionEnd=[this._bufferService.cols,w.last],this._model.selectionStartLength=0},p([_(3,c.IBufferService),_(4,c.ICoreService),_(5,g.IMouseService),_(6,c.IOptionsService),_(7,g.IRenderService)],L)}(n.Disposable);t.SelectionService=S},4725:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.ICharacterJoinerService=t.ISoundService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;var a=o(8343);t.ICharSizeService=(0,a.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,a.createDecorator)("CoreBrowserService"),t.IMouseService=(0,a.createDecorator)("MouseService"),t.IRenderService=(0,a.createDecorator)("RenderService"),t.ISelectionService=(0,a.createDecorator)("SelectionService"),t.ISoundService=(0,a.createDecorator)("SoundService"),t.ICharacterJoinerService=(0,a.createDecorator)("CharacterJoinerService"),t.IDecorationService=(0,a.createDecorator)("DecorationService")},357:function(l,t,o){var a=this&&this.__decorate||function(b,m,h,v){var g,c=arguments.length,r=c<3?m:v===null?v=Object.getOwnPropertyDescriptor(m,h):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(b,m,h,v);else for(var i=b.length-1;i>=0;i--)(g=b[i])&&(r=(c<3?g(r):c>3?g(m,h,r):g(m,h))||r);return c>3&&r&&Object.defineProperty(m,h,r),r},u=this&&this.__param||function(b,m){return function(h,v){m(h,v,b)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SoundService=void 0;var p=o(2585),_=function(){function b(m){this._optionsService=m}return Object.defineProperty(b,"audioContext",{get:function(){if(!b._audioContext){var m=window.AudioContext||window.webkitAudioContext;if(!m)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;b._audioContext=new m}return b._audioContext},enumerable:!1,configurable:!0}),b.prototype.playBellSound=function(){var m=b.audioContext;if(m){var h=m.createBufferSource();m.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._optionsService.rawOptions.bellSound)),function(v){h.buffer=v,h.connect(m.destination),h.start(0)})}},b.prototype._base64ToArrayBuffer=function(m){for(var h=window.atob(m),v=h.length,g=new Uint8Array(v),c=0;c<v;c++)g[c]=h.charCodeAt(c);return g.buffer},b.prototype._removeMimeType=function(m){return m.split(",")[1]},b=a([u(0,p.IOptionsService)],b)}();t.SoundService=_},6349:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;var a=o(8460),u=function(){function p(_){this._maxLength=_,this.onDeleteEmitter=new a.EventEmitter,this.onInsertEmitter=new a.EventEmitter,this.onTrimEmitter=new a.EventEmitter,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(p.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"maxLength",{get:function(){return this._maxLength},set:function(_){if(this._maxLength!==_){for(var b=new Array(_),m=0;m<Math.min(_,this.length);m++)b[m]=this._array[this._getCyclicIndex(m)];this._array=b,this._maxLength=_,this._startIndex=0}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"length",{get:function(){return this._length},set:function(_){if(_>this._length)for(var b=this._length;b<_;b++)this._array[b]=void 0;this._length=_},enumerable:!1,configurable:!0}),p.prototype.get=function(_){return this._array[this._getCyclicIndex(_)]},p.prototype.set=function(_,b){this._array[this._getCyclicIndex(_)]=b},p.prototype.push=function(_){this._array[this._getCyclicIndex(this._length)]=_,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},p.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(p.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!1,configurable:!0}),p.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},p.prototype.splice=function(_,b){for(var m=[],h=2;h<arguments.length;h++)m[h-2]=arguments[h];if(b){for(var v=_;v<this._length-b;v++)this._array[this._getCyclicIndex(v)]=this._array[this._getCyclicIndex(v+b)];this._length-=b,this.onDeleteEmitter.fire({index:_,amount:b})}for(v=this._length-1;v>=_;v--)this._array[this._getCyclicIndex(v+m.length)]=this._array[this._getCyclicIndex(v)];for(v=0;v<m.length;v++)this._array[this._getCyclicIndex(_+v)]=m[v];if(m.length&&this.onInsertEmitter.fire({index:_,amount:m.length}),this._length+m.length>this._maxLength){var g=this._length+m.length-this._maxLength;this._startIndex+=g,this._length=this._maxLength,this.onTrimEmitter.fire(g)}else this._length+=m.length},p.prototype.trimStart=function(_){_>this._length&&(_=this._length),this._startIndex+=_,this._length-=_,this.onTrimEmitter.fire(_)},p.prototype.shiftElements=function(_,b,m){if(!(b<=0)){if(_<0||_>=this._length)throw new Error("start argument out of range");if(_+m<0)throw new Error("Cannot shift elements in list beyond index 0");if(m>0){for(var h=b-1;h>=0;h--)this.set(_+h+m,this.get(_+h));var v=_+b+m-this._length;if(v>0)for(this._length+=v;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(h=0;h<b;h++)this.set(_+h+m,this.get(_+h))}},p.prototype._getCyclicIndex=function(_){return(this._startIndex+_)%this._maxLength},p}();t.CircularList=u},1439:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function o(a,u){if(u===void 0&&(u=5),typeof a!="object")return a;var p=Array.isArray(a)?[]:{};for(var _ in a)p[_]=u<=1?a[_]:a[_]&&o(a[_],u-1);return p}},8969:function(l,t,o){var a,u=this&&this.__extends||(a=function(C,w){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,A){T.__proto__=A}||function(T,A){for(var H in A)Object.prototype.hasOwnProperty.call(A,H)&&(T[H]=A[H])},a(C,w)},function(C,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function T(){this.constructor=C}a(C,w),C.prototype=w===null?Object.create(w):(T.prototype=w.prototype,new T)});Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;var p=o(844),_=o(2585),b=o(4348),m=o(7866),h=o(744),v=o(7302),g=o(6975),c=o(8460),r=o(1753),i=o(3730),n=o(1480),d=o(7994),f=o(9282),y=o(5435),S=o(5981),E=!1,L=function(C){function w(T){var A=C.call(this)||this;return A._onBinary=new c.EventEmitter,A._onData=new c.EventEmitter,A._onLineFeed=new c.EventEmitter,A._onResize=new c.EventEmitter,A._onScroll=new c.EventEmitter,A._instantiationService=new b.InstantiationService,A.optionsService=new v.OptionsService(T),A._instantiationService.setService(_.IOptionsService,A.optionsService),A._bufferService=A.register(A._instantiationService.createInstance(h.BufferService)),A._instantiationService.setService(_.IBufferService,A._bufferService),A._logService=A._instantiationService.createInstance(m.LogService),A._instantiationService.setService(_.ILogService,A._logService),A.coreService=A.register(A._instantiationService.createInstance(g.CoreService,function(){return A.scrollToBottom()})),A._instantiationService.setService(_.ICoreService,A.coreService),A.coreMouseService=A._instantiationService.createInstance(r.CoreMouseService),A._instantiationService.setService(_.ICoreMouseService,A.coreMouseService),A._dirtyRowService=A._instantiationService.createInstance(i.DirtyRowService),A._instantiationService.setService(_.IDirtyRowService,A._dirtyRowService),A.unicodeService=A._instantiationService.createInstance(n.UnicodeService),A._instantiationService.setService(_.IUnicodeService,A.unicodeService),A._charsetService=A._instantiationService.createInstance(d.CharsetService),A._instantiationService.setService(_.ICharsetService,A._charsetService),A._inputHandler=new y.InputHandler(A._bufferService,A._charsetService,A.coreService,A._dirtyRowService,A._logService,A.optionsService,A.coreMouseService,A.unicodeService),A.register((0,c.forwardEvent)(A._inputHandler.onLineFeed,A._onLineFeed)),A.register(A._inputHandler),A.register((0,c.forwardEvent)(A._bufferService.onResize,A._onResize)),A.register((0,c.forwardEvent)(A.coreService.onData,A._onData)),A.register((0,c.forwardEvent)(A.coreService.onBinary,A._onBinary)),A.register(A.optionsService.onOptionChange(function(H){return A._updateOptions(H)})),A.register(A._bufferService.onScroll(function(H){A._onScroll.fire({position:A._bufferService.buffer.ydisp,source:0}),A._dirtyRowService.markRangeDirty(A._bufferService.buffer.scrollTop,A._bufferService.buffer.scrollBottom)})),A.register(A._inputHandler.onScroll(function(H){A._onScroll.fire({position:A._bufferService.buffer.ydisp,source:0}),A._dirtyRowService.markRangeDirty(A._bufferService.buffer.scrollTop,A._bufferService.buffer.scrollBottom)})),A._writeBuffer=new S.WriteBuffer(function(H,O){return A._inputHandler.parse(H,O)}),A}return u(w,C),Object.defineProperty(w.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"onScroll",{get:function(){var T=this;return this._onScrollApi||(this._onScrollApi=new c.EventEmitter,this.register(this._onScroll.event(function(A){var H;(H=T._onScrollApi)===null||H===void 0||H.fire(A.position)}))),this._onScrollApi.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"cols",{get:function(){return this._bufferService.cols},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"rows",{get:function(){return this._bufferService.rows},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"buffers",{get:function(){return this._bufferService.buffers},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"options",{get:function(){return this.optionsService.options},set:function(T){for(var A in T)this.optionsService.options[A]=T[A]},enumerable:!1,configurable:!0}),w.prototype.dispose=function(){var T;this._isDisposed||(C.prototype.dispose.call(this),(T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0)},w.prototype.write=function(T,A){this._writeBuffer.write(T,A)},w.prototype.writeSync=function(T,A){this._logService.logLevel<=_.LogLevelEnum.WARN&&!E&&(this._logService.warn("writeSync is unreliable and will be removed soon."),E=!0),this._writeBuffer.writeSync(T,A)},w.prototype.resize=function(T,A){isNaN(T)||isNaN(A)||(T=Math.max(T,h.MINIMUM_COLS),A=Math.max(A,h.MINIMUM_ROWS),this._bufferService.resize(T,A))},w.prototype.scroll=function(T,A){A===void 0&&(A=!1),this._bufferService.scroll(T,A)},w.prototype.scrollLines=function(T,A,H){this._bufferService.scrollLines(T,A,H)},w.prototype.scrollPages=function(T){this._bufferService.scrollPages(T)},w.prototype.scrollToTop=function(){this._bufferService.scrollToTop()},w.prototype.scrollToBottom=function(){this._bufferService.scrollToBottom()},w.prototype.scrollToLine=function(T){this._bufferService.scrollToLine(T)},w.prototype.registerEscHandler=function(T,A){return this._inputHandler.registerEscHandler(T,A)},w.prototype.registerDcsHandler=function(T,A){return this._inputHandler.registerDcsHandler(T,A)},w.prototype.registerCsiHandler=function(T,A){return this._inputHandler.registerCsiHandler(T,A)},w.prototype.registerOscHandler=function(T,A){return this._inputHandler.registerOscHandler(T,A)},w.prototype._setup=function(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()},w.prototype.reset=function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()},w.prototype._updateOptions=function(T){var A;switch(T){case"scrollback":this.buffers.resize(this.cols,this.rows);break;case"windowsMode":this.optionsService.rawOptions.windowsMode?this._enableWindowsMode():((A=this._windowsMode)===null||A===void 0||A.dispose(),this._windowsMode=void 0)}},w.prototype._enableWindowsMode=function(){var T=this;if(!this._windowsMode){var A=[];A.push(this.onLineFeed(f.updateWindowsModeWrappedState.bind(null,this._bufferService))),A.push(this.registerCsiHandler({final:"H"},function(){return(0,f.updateWindowsModeWrappedState)(T._bufferService),!1})),this._windowsMode={dispose:function(){for(var H=0,O=A;H<O.length;H++)O[H].dispose()}}}},w}(p.Disposable);t.CoreTerminal=L},8460:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0;var o=function(){function a(){this._listeners=[],this._disposed=!1}return Object.defineProperty(a.prototype,"event",{get:function(){var u=this;return this._event||(this._event=function(p){return u._listeners.push(p),{dispose:function(){if(!u._disposed){for(var _=0;_<u._listeners.length;_++)if(u._listeners[_]===p)return void u._listeners.splice(_,1)}}}}),this._event},enumerable:!1,configurable:!0}),a.prototype.fire=function(u,p){for(var _=[],b=0;b<this._listeners.length;b++)_.push(this._listeners[b]);for(b=0;b<_.length;b++)_[b].call(void 0,u,p)},a.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},a}();t.EventEmitter=o,t.forwardEvent=function(a,u){return a(function(p){return u.fire(p)})}},5435:function(l,t,o){var a,u=this&&this.__extends||(a=function(H,O){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,x){k.__proto__=x}||function(k,x){for(var D in x)Object.prototype.hasOwnProperty.call(x,D)&&(k[D]=x[D])},a(H,O)},function(H,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");function k(){this.constructor=H}a(H,O),H.prototype=O===null?Object.create(O):(k.prototype=O.prototype,new k)});Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;var p,_=o(2584),b=o(7116),m=o(2015),h=o(844),v=o(8273),g=o(482),c=o(8437),r=o(8460),i=o(643),n=o(511),d=o(3734),f=o(2585),y=o(6242),S=o(6351),E=o(5941),L={"(":0,")":1,"*":2,"+":3,"-":1,".":2},C=131072;function w(H,O){if(H>24)return O.setWinLines||!1;switch(H){case 1:return!!O.restoreWin;case 2:return!!O.minimizeWin;case 3:return!!O.setWinPosition;case 4:return!!O.setWinSizePixels;case 5:return!!O.raiseWin;case 6:return!!O.lowerWin;case 7:return!!O.refreshWin;case 8:return!!O.setWinSizeChars;case 9:return!!O.maximizeWin;case 10:return!!O.fullscreenWin;case 11:return!!O.getWinState;case 13:return!!O.getWinPosition;case 14:return!!O.getWinSizePixels;case 15:return!!O.getScreenSizePixels;case 16:return!!O.getCellSizePixels;case 18:return!!O.getWinSizeChars;case 19:return!!O.getScreenSizeChars;case 20:return!!O.getIconTitle;case 21:return!!O.getWinTitle;case 22:return!!O.pushTitle;case 23:return!!O.popTitle;case 24:return!!O.setWinLines}return!1}(function(H){H[H.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",H[H.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(p=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));var T=function(){function H(O,k,x,D){this._bufferService=O,this._coreService=k,this._logService=x,this._optionsService=D,this._data=new Uint32Array(0)}return H.prototype.hook=function(O){this._data=new Uint32Array(0)},H.prototype.put=function(O,k,x){this._data=(0,v.concat)(this._data,O.subarray(k,x))},H.prototype.unhook=function(O){if(!O)return this._data=new Uint32Array(0),!0;var k=(0,g.utf32ToString)(this._data);switch(this._data=new Uint32Array(0),k){case'"q':this._coreService.triggerDataEvent(_.C0.ESC+'P1$r0"q'+_.C0.ESC+"\\");break;case'"p':this._coreService.triggerDataEvent(_.C0.ESC+'P1$r61;1"p'+_.C0.ESC+"\\");break;case"r":var x=this._bufferService.buffer.scrollTop+1+";"+(this._bufferService.buffer.scrollBottom+1)+"r";this._coreService.triggerDataEvent(_.C0.ESC+"P1$r"+x+_.C0.ESC+"\\");break;case"m":this._coreService.triggerDataEvent(_.C0.ESC+"P1$r0m"+_.C0.ESC+"\\");break;case" q":var D={block:2,underline:4,bar:6}[this._optionsService.rawOptions.cursorStyle];D-=this._optionsService.rawOptions.cursorBlink?1:0,this._coreService.triggerDataEvent(_.C0.ESC+"P1$r"+D+" q"+_.C0.ESC+"\\");break;default:this._logService.debug("Unknown DCS $q %s",k),this._coreService.triggerDataEvent(_.C0.ESC+"P0$r"+_.C0.ESC+"\\")}return!0},H}(),A=function(H){function O(k,x,D,I,F,W,J,$,G){G===void 0&&(G=new m.EscapeSequenceParser);var R=H.call(this)||this;R._bufferService=k,R._charsetService=x,R._coreService=D,R._dirtyRowService=I,R._logService=F,R._optionsService=W,R._coreMouseService=J,R._unicodeService=$,R._parser=G,R._parseBuffer=new Uint32Array(4096),R._stringDecoder=new g.StringToUtf32,R._utf8Decoder=new g.Utf8ToUtf32,R._workCell=new n.CellData,R._windowTitle="",R._iconName="",R._windowTitleStack=[],R._iconNameStack=[],R._curAttrData=c.DEFAULT_ATTR_DATA.clone(),R._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone(),R._onRequestBell=new r.EventEmitter,R._onRequestRefreshRows=new r.EventEmitter,R._onRequestReset=new r.EventEmitter,R._onRequestSendFocus=new r.EventEmitter,R._onRequestSyncScrollBar=new r.EventEmitter,R._onRequestWindowsOptionsReport=new r.EventEmitter,R._onA11yChar=new r.EventEmitter,R._onA11yTab=new r.EventEmitter,R._onCursorMove=new r.EventEmitter,R._onLineFeed=new r.EventEmitter,R._onScroll=new r.EventEmitter,R._onTitleChange=new r.EventEmitter,R._onColor=new r.EventEmitter,R._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},R._specialColors=[256,257,258],R.register(R._parser),R._activeBuffer=R._bufferService.buffer,R.register(R._bufferService.buffers.onBufferActivate(function(M){return R._activeBuffer=M.activeBuffer})),R._parser.setCsiHandlerFallback(function(M,K){R._logService.debug("Unknown CSI code: ",{identifier:R._parser.identToString(M),params:K.toArray()})}),R._parser.setEscHandlerFallback(function(M){R._logService.debug("Unknown ESC code: ",{identifier:R._parser.identToString(M)})}),R._parser.setExecuteHandlerFallback(function(M){R._logService.debug("Unknown EXECUTE code: ",{code:M})}),R._parser.setOscHandlerFallback(function(M,K,V){R._logService.debug("Unknown OSC code: ",{identifier:M,action:K,data:V})}),R._parser.setDcsHandlerFallback(function(M,K,V){K==="HOOK"&&(V=V.toArray()),R._logService.debug("Unknown DCS code: ",{identifier:R._parser.identToString(M),action:K,payload:V})}),R._parser.setPrintHandler(function(M,K,V){return R.print(M,K,V)}),R._parser.registerCsiHandler({final:"@"},function(M){return R.insertChars(M)}),R._parser.registerCsiHandler({intermediates:" ",final:"@"},function(M){return R.scrollLeft(M)}),R._parser.registerCsiHandler({final:"A"},function(M){return R.cursorUp(M)}),R._parser.registerCsiHandler({intermediates:" ",final:"A"},function(M){return R.scrollRight(M)}),R._parser.registerCsiHandler({final:"B"},function(M){return R.cursorDown(M)}),R._parser.registerCsiHandler({final:"C"},function(M){return R.cursorForward(M)}),R._parser.registerCsiHandler({final:"D"},function(M){return R.cursorBackward(M)}),R._parser.registerCsiHandler({final:"E"},function(M){return R.cursorNextLine(M)}),R._parser.registerCsiHandler({final:"F"},function(M){return R.cursorPrecedingLine(M)}),R._parser.registerCsiHandler({final:"G"},function(M){return R.cursorCharAbsolute(M)}),R._parser.registerCsiHandler({final:"H"},function(M){return R.cursorPosition(M)}),R._parser.registerCsiHandler({final:"I"},function(M){return R.cursorForwardTab(M)}),R._parser.registerCsiHandler({final:"J"},function(M){return R.eraseInDisplay(M)}),R._parser.registerCsiHandler({prefix:"?",final:"J"},function(M){return R.eraseInDisplay(M)}),R._parser.registerCsiHandler({final:"K"},function(M){return R.eraseInLine(M)}),R._parser.registerCsiHandler({prefix:"?",final:"K"},function(M){return R.eraseInLine(M)}),R._parser.registerCsiHandler({final:"L"},function(M){return R.insertLines(M)}),R._parser.registerCsiHandler({final:"M"},function(M){return R.deleteLines(M)}),R._parser.registerCsiHandler({final:"P"},function(M){return R.deleteChars(M)}),R._parser.registerCsiHandler({final:"S"},function(M){return R.scrollUp(M)}),R._parser.registerCsiHandler({final:"T"},function(M){return R.scrollDown(M)}),R._parser.registerCsiHandler({final:"X"},function(M){return R.eraseChars(M)}),R._parser.registerCsiHandler({final:"Z"},function(M){return R.cursorBackwardTab(M)}),R._parser.registerCsiHandler({final:"`"},function(M){return R.charPosAbsolute(M)}),R._parser.registerCsiHandler({final:"a"},function(M){return R.hPositionRelative(M)}),R._parser.registerCsiHandler({final:"b"},function(M){return R.repeatPrecedingCharacter(M)}),R._parser.registerCsiHandler({final:"c"},function(M){return R.sendDeviceAttributesPrimary(M)}),R._parser.registerCsiHandler({prefix:">",final:"c"},function(M){return R.sendDeviceAttributesSecondary(M)}),R._parser.registerCsiHandler({final:"d"},function(M){return R.linePosAbsolute(M)}),R._parser.registerCsiHandler({final:"e"},function(M){return R.vPositionRelative(M)}),R._parser.registerCsiHandler({final:"f"},function(M){return R.hVPosition(M)}),R._parser.registerCsiHandler({final:"g"},function(M){return R.tabClear(M)}),R._parser.registerCsiHandler({final:"h"},function(M){return R.setMode(M)}),R._parser.registerCsiHandler({prefix:"?",final:"h"},function(M){return R.setModePrivate(M)}),R._parser.registerCsiHandler({final:"l"},function(M){return R.resetMode(M)}),R._parser.registerCsiHandler({prefix:"?",final:"l"},function(M){return R.resetModePrivate(M)}),R._parser.registerCsiHandler({final:"m"},function(M){return R.charAttributes(M)}),R._parser.registerCsiHandler({final:"n"},function(M){return R.deviceStatus(M)}),R._parser.registerCsiHandler({prefix:"?",final:"n"},function(M){return R.deviceStatusPrivate(M)}),R._parser.registerCsiHandler({intermediates:"!",final:"p"},function(M){return R.softReset(M)}),R._parser.registerCsiHandler({intermediates:" ",final:"q"},function(M){return R.setCursorStyle(M)}),R._parser.registerCsiHandler({final:"r"},function(M){return R.setScrollRegion(M)}),R._parser.registerCsiHandler({final:"s"},function(M){return R.saveCursor(M)}),R._parser.registerCsiHandler({final:"t"},function(M){return R.windowOptions(M)}),R._parser.registerCsiHandler({final:"u"},function(M){return R.restoreCursor(M)}),R._parser.registerCsiHandler({intermediates:"'",final:"}"},function(M){return R.insertColumns(M)}),R._parser.registerCsiHandler({intermediates:"'",final:"~"},function(M){return R.deleteColumns(M)}),R._parser.setExecuteHandler(_.C0.BEL,function(){return R.bell()}),R._parser.setExecuteHandler(_.C0.LF,function(){return R.lineFeed()}),R._parser.setExecuteHandler(_.C0.VT,function(){return R.lineFeed()}),R._parser.setExecuteHandler(_.C0.FF,function(){return R.lineFeed()}),R._parser.setExecuteHandler(_.C0.CR,function(){return R.carriageReturn()}),R._parser.setExecuteHandler(_.C0.BS,function(){return R.backspace()}),R._parser.setExecuteHandler(_.C0.HT,function(){return R.tab()}),R._parser.setExecuteHandler(_.C0.SO,function(){return R.shiftOut()}),R._parser.setExecuteHandler(_.C0.SI,function(){return R.shiftIn()}),R._parser.setExecuteHandler(_.C1.IND,function(){return R.index()}),R._parser.setExecuteHandler(_.C1.NEL,function(){return R.nextLine()}),R._parser.setExecuteHandler(_.C1.HTS,function(){return R.tabSet()}),R._parser.registerOscHandler(0,new y.OscHandler(function(M){return R.setTitle(M),R.setIconName(M),!0})),R._parser.registerOscHandler(1,new y.OscHandler(function(M){return R.setIconName(M)})),R._parser.registerOscHandler(2,new y.OscHandler(function(M){return R.setTitle(M)})),R._parser.registerOscHandler(4,new y.OscHandler(function(M){return R.setOrReportIndexedColor(M)})),R._parser.registerOscHandler(10,new y.OscHandler(function(M){return R.setOrReportFgColor(M)})),R._parser.registerOscHandler(11,new y.OscHandler(function(M){return R.setOrReportBgColor(M)})),R._parser.registerOscHandler(12,new y.OscHandler(function(M){return R.setOrReportCursorColor(M)})),R._parser.registerOscHandler(104,new y.OscHandler(function(M){return R.restoreIndexedColor(M)})),R._parser.registerOscHandler(110,new y.OscHandler(function(M){return R.restoreFgColor(M)})),R._parser.registerOscHandler(111,new y.OscHandler(function(M){return R.restoreBgColor(M)})),R._parser.registerOscHandler(112,new y.OscHandler(function(M){return R.restoreCursorColor(M)})),R._parser.registerEscHandler({final:"7"},function(){return R.saveCursor()}),R._parser.registerEscHandler({final:"8"},function(){return R.restoreCursor()}),R._parser.registerEscHandler({final:"D"},function(){return R.index()}),R._parser.registerEscHandler({final:"E"},function(){return R.nextLine()}),R._parser.registerEscHandler({final:"H"},function(){return R.tabSet()}),R._parser.registerEscHandler({final:"M"},function(){return R.reverseIndex()}),R._parser.registerEscHandler({final:"="},function(){return R.keypadApplicationMode()}),R._parser.registerEscHandler({final:">"},function(){return R.keypadNumericMode()}),R._parser.registerEscHandler({final:"c"},function(){return R.fullReset()}),R._parser.registerEscHandler({final:"n"},function(){return R.setgLevel(2)}),R._parser.registerEscHandler({final:"o"},function(){return R.setgLevel(3)}),R._parser.registerEscHandler({final:"|"},function(){return R.setgLevel(3)}),R._parser.registerEscHandler({final:"}"},function(){return R.setgLevel(2)}),R._parser.registerEscHandler({final:"~"},function(){return R.setgLevel(1)}),R._parser.registerEscHandler({intermediates:"%",final:"@"},function(){return R.selectDefaultCharset()}),R._parser.registerEscHandler({intermediates:"%",final:"G"},function(){return R.selectDefaultCharset()});var N=function(M){P._parser.registerEscHandler({intermediates:"(",final:M},function(){return R.selectCharset("("+M)}),P._parser.registerEscHandler({intermediates:")",final:M},function(){return R.selectCharset(")"+M)}),P._parser.registerEscHandler({intermediates:"*",final:M},function(){return R.selectCharset("*"+M)}),P._parser.registerEscHandler({intermediates:"+",final:M},function(){return R.selectCharset("+"+M)}),P._parser.registerEscHandler({intermediates:"-",final:M},function(){return R.selectCharset("-"+M)}),P._parser.registerEscHandler({intermediates:".",final:M},function(){return R.selectCharset("."+M)}),P._parser.registerEscHandler({intermediates:"/",final:M},function(){return R.selectCharset("/"+M)})},P=this;for(var B in b.CHARSETS)N(B);return R._parser.registerEscHandler({intermediates:"#",final:"8"},function(){return R.screenAlignmentPattern()}),R._parser.setErrorHandler(function(M){return R._logService.error("Parsing error: ",M),M}),R._parser.registerDcsHandler({intermediates:"$",final:"q"},new T(R._bufferService,R._coreService,R._logService,R._optionsService)),R}return u(O,H),Object.defineProperty(O.prototype,"onRequestBell",{get:function(){return this._onRequestBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onRequestRefreshRows",{get:function(){return this._onRequestRefreshRows.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onRequestReset",{get:function(){return this._onRequestReset.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onRequestSendFocus",{get:function(){return this._onRequestSendFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onRequestSyncScrollBar",{get:function(){return this._onRequestSyncScrollBar.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onRequestWindowsOptionsReport",{get:function(){return this._onRequestWindowsOptionsReport.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onA11yChar",{get:function(){return this._onA11yChar.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onA11yTab",{get:function(){return this._onA11yTab.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onColor",{get:function(){return this._onColor.event},enumerable:!1,configurable:!0}),O.prototype.dispose=function(){H.prototype.dispose.call(this)},O.prototype._preserveStack=function(k,x,D,I){this._parseStack.paused=!0,this._parseStack.cursorStartX=k,this._parseStack.cursorStartY=x,this._parseStack.decodedLength=D,this._parseStack.position=I},O.prototype._logSlowResolvingAsync=function(k){this._logService.logLevel<=f.LogLevelEnum.WARN&&Promise.race([k,new Promise(function(x,D){return setTimeout(function(){return D("#SLOW_TIMEOUT")},5e3)})]).catch(function(x){if(x!=="#SLOW_TIMEOUT")throw x;console.warn("async parser handler taking longer than 5000 ms")})},O.prototype.parse=function(k,x){var D,I=this._activeBuffer.x,F=this._activeBuffer.y,W=0,J=this._parseStack.paused;if(J){if(D=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,x))return this._logSlowResolvingAsync(D),D;I=this._parseStack.cursorStartX,F=this._parseStack.cursorStartY,this._parseStack.paused=!1,k.length>C&&(W=this._parseStack.position+C)}if(this._logService.logLevel<=f.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof k=="string"?' "'+k+'"':' "'+Array.prototype.map.call(k,function(N){return String.fromCharCode(N)}).join("")+'"'),typeof k=="string"?k.split("").map(function(N){return N.charCodeAt(0)}):k),this._parseBuffer.length<k.length&&this._parseBuffer.length<C&&(this._parseBuffer=new Uint32Array(Math.min(k.length,C))),J||this._dirtyRowService.clearRange(),k.length>C)for(var $=W;$<k.length;$+=C){var G=$+C<k.length?$+C:k.length,R=typeof k=="string"?this._stringDecoder.decode(k.substring($,G),this._parseBuffer):this._utf8Decoder.decode(k.subarray($,G),this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,R))return this._preserveStack(I,F,R,$),this._logSlowResolvingAsync(D),D}else if(!J&&(R=typeof k=="string"?this._stringDecoder.decode(k,this._parseBuffer):this._utf8Decoder.decode(k,this._parseBuffer),D=this._parser.parse(this._parseBuffer,R)))return this._preserveStack(I,F,R,0),this._logSlowResolvingAsync(D),D;this._activeBuffer.x===I&&this._activeBuffer.y===F||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowService.start,this._dirtyRowService.end)},O.prototype.print=function(k,x,D){var I,F,W=this._charsetService.charset,J=this._optionsService.rawOptions.screenReaderMode,$=this._bufferService.cols,G=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,N=this._curAttrData,P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowService.markDirty(this._activeBuffer.y),this._activeBuffer.x&&D-x>0&&P.getWidth(this._activeBuffer.x-1)===2&&P.setCellFromCodePoint(this._activeBuffer.x-1,0,1,N.fg,N.bg,N.extended);for(var B=x;B<D;++B){if(I=k[B],F=this._unicodeService.wcwidth(I),I<127&&W){var M=W[String.fromCharCode(I)];M&&(I=M.charCodeAt(0))}if(J&&this._onA11yChar.fire((0,g.stringFromCodePoint)(I)),F||!this._activeBuffer.x){if(this._activeBuffer.x+F-1>=$){if(G){for(;this._activeBuffer.x<$;)P.setCellFromCodePoint(this._activeBuffer.x++,0,1,N.fg,N.bg,N.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=$-1,F===2)continue}if(R&&(P.insertCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(N),N),P.getWidth($-1)===2&&P.setCellFromCodePoint($-1,i.NULL_CELL_CODE,i.NULL_CELL_WIDTH,N.fg,N.bg,N.extended)),P.setCellFromCodePoint(this._activeBuffer.x++,I,F,N.fg,N.bg,N.extended),F>0)for(;--F;)P.setCellFromCodePoint(this._activeBuffer.x++,0,0,N.fg,N.bg,N.extended)}else P.getWidth(this._activeBuffer.x-1)?P.addCodepointToCell(this._activeBuffer.x-1,I):P.addCodepointToCell(this._activeBuffer.x-2,I)}D-x>0&&(P.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<$&&D-x>0&&P.getWidth(this._activeBuffer.x)===0&&!P.hasContent(this._activeBuffer.x)&&P.setCellFromCodePoint(this._activeBuffer.x,0,1,N.fg,N.bg,N.extended),this._dirtyRowService.markDirty(this._activeBuffer.y)},O.prototype.registerCsiHandler=function(k,x){var D=this;return k.final!=="t"||k.prefix||k.intermediates?this._parser.registerCsiHandler(k,x):this._parser.registerCsiHandler(k,function(I){return!w(I.params[0],D._optionsService.rawOptions.windowOptions)||x(I)})},O.prototype.registerDcsHandler=function(k,x){return this._parser.registerDcsHandler(k,new S.DcsHandler(x))},O.prototype.registerEscHandler=function(k,x){return this._parser.registerEscHandler(k,x)},O.prototype.registerOscHandler=function(k,x){return this._parser.registerOscHandler(k,new y.OscHandler(x))},O.prototype.bell=function(){return this._onRequestBell.fire(),!0},O.prototype.lineFeed=function(){return this._dirtyRowService.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowService.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0},O.prototype.carriageReturn=function(){return this._activeBuffer.x=0,!0},O.prototype.backspace=function(){var k;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||k===void 0?void 0:k.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);x.hasWidth(this._activeBuffer.x)&&!x.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0},O.prototype.tab=function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var k=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-k),!0},O.prototype.shiftOut=function(){return this._charsetService.setgLevel(1),!0},O.prototype.shiftIn=function(){return this._charsetService.setgLevel(0),!0},O.prototype._restrictCursor=function(k){k===void 0&&(k=this._bufferService.cols-1),this._activeBuffer.x=Math.min(k,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowService.markDirty(this._activeBuffer.y)},O.prototype._setCursor=function(k,x){this._dirtyRowService.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=k,this._activeBuffer.y=this._activeBuffer.scrollTop+x):(this._activeBuffer.x=k,this._activeBuffer.y=x),this._restrictCursor(),this._dirtyRowService.markDirty(this._activeBuffer.y)},O.prototype._moveCursor=function(k,x){this._restrictCursor(),this._setCursor(this._activeBuffer.x+k,this._activeBuffer.y+x)},O.prototype.cursorUp=function(k){var x=this._activeBuffer.y-this._activeBuffer.scrollTop;return x>=0?this._moveCursor(0,-Math.min(x,k.params[0]||1)):this._moveCursor(0,-(k.params[0]||1)),!0},O.prototype.cursorDown=function(k){var x=this._activeBuffer.scrollBottom-this._activeBuffer.y;return x>=0?this._moveCursor(0,Math.min(x,k.params[0]||1)):this._moveCursor(0,k.params[0]||1),!0},O.prototype.cursorForward=function(k){return this._moveCursor(k.params[0]||1,0),!0},O.prototype.cursorBackward=function(k){return this._moveCursor(-(k.params[0]||1),0),!0},O.prototype.cursorNextLine=function(k){return this.cursorDown(k),this._activeBuffer.x=0,!0},O.prototype.cursorPrecedingLine=function(k){return this.cursorUp(k),this._activeBuffer.x=0,!0},O.prototype.cursorCharAbsolute=function(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0},O.prototype.cursorPosition=function(k){return this._setCursor(k.length>=2?(k.params[1]||1)-1:0,(k.params[0]||1)-1),!0},O.prototype.charPosAbsolute=function(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0},O.prototype.hPositionRelative=function(k){return this._moveCursor(k.params[0]||1,0),!0},O.prototype.linePosAbsolute=function(k){return this._setCursor(this._activeBuffer.x,(k.params[0]||1)-1),!0},O.prototype.vPositionRelative=function(k){return this._moveCursor(0,k.params[0]||1),!0},O.prototype.hVPosition=function(k){return this.cursorPosition(k),!0},O.prototype.tabClear=function(k){var x=k.params[0];return x===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:x===3&&(this._activeBuffer.tabs={}),!0},O.prototype.cursorForwardTab=function(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var x=k.params[0]||1;x--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0},O.prototype.cursorBackwardTab=function(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var x=k.params[0]||1;x--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0},O.prototype._eraseInBufferLine=function(k,x,D,I){I===void 0&&(I=!1);var F=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);F.replaceCells(x,D,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I&&(F.isWrapped=!1)},O.prototype._resetBufferLine=function(k){var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);x.fill(this._activeBuffer.getNullCell(this._eraseAttrData())),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+k),x.isWrapped=!1},O.prototype.eraseInDisplay=function(k){var x;switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:for(x=this._activeBuffer.y,this._dirtyRowService.markDirty(x),this._eraseInBufferLine(x++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0);x<this._bufferService.rows;x++)this._resetBufferLine(x);this._dirtyRowService.markDirty(x);break;case 1:for(x=this._activeBuffer.y,this._dirtyRowService.markDirty(x),this._eraseInBufferLine(x,0,this._activeBuffer.x+1,!0),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(x+1).isWrapped=!1);x--;)this._resetBufferLine(x);this._dirtyRowService.markDirty(0);break;case 2:for(x=this._bufferService.rows,this._dirtyRowService.markDirty(x-1);x--;)this._resetBufferLine(x);this._dirtyRowService.markDirty(0);break;case 3:var D=this._activeBuffer.lines.length-this._bufferService.rows;D>0&&(this._activeBuffer.lines.trimStart(D),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-D,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-D,0),this._onScroll.fire(0))}return!0},O.prototype.eraseInLine=function(k){switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0)}return this._dirtyRowService.markDirty(this._activeBuffer.y),!0},O.prototype.insertLines=function(k){this._restrictCursor();var x=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var D=this._activeBuffer.ybase+this._activeBuffer.y,I=this._bufferService.rows-1-this._activeBuffer.scrollBottom,F=this._bufferService.rows-1+this._activeBuffer.ybase-I+1;x--;)this._activeBuffer.lines.splice(F-1,1),this._activeBuffer.lines.splice(D,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},O.prototype.deleteLines=function(k){this._restrictCursor();var x=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var D,I=this._activeBuffer.ybase+this._activeBuffer.y;for(D=this._bufferService.rows-1-this._activeBuffer.scrollBottom,D=this._bufferService.rows-1+this._activeBuffer.ybase-D;x--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(D,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},O.prototype.insertChars=function(k){this._restrictCursor();var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return x&&(x.insertCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},O.prototype.deleteChars=function(k){this._restrictCursor();var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return x&&(x.deleteCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},O.prototype.scrollUp=function(k){for(var x=k.params[0]||1;x--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},O.prototype.scrollDown=function(k){for(var x=k.params[0]||1;x--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(c.DEFAULT_ATTR_DATA));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},O.prototype.scrollLeft=function(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var x=k.params[0]||1,D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){var I=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);I.deleteCells(0,x,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},O.prototype.scrollRight=function(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var x=k.params[0]||1,D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){var I=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);I.insertCells(0,x,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},O.prototype.insertColumns=function(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var x=k.params[0]||1,D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){var I=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);I.insertCells(this._activeBuffer.x,x,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},O.prototype.deleteColumns=function(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var x=k.params[0]||1,D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){var I=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);I.deleteCells(this._activeBuffer.x,x,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),I.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},O.prototype.eraseChars=function(k){this._restrictCursor();var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return x&&(x.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(k.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},O.prototype.repeatPrecedingCharacter=function(k){if(!this._parser.precedingCodepoint)return!0;for(var x=k.params[0]||1,D=new Uint32Array(x),I=0;I<x;++I)D[I]=this._parser.precedingCodepoint;return this.print(D,0,D.length),!0},O.prototype.sendDeviceAttributesPrimary=function(k){return k.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(_.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(_.C0.ESC+"[?6c")),!0},O.prototype.sendDeviceAttributesSecondary=function(k){return k.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(_.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(_.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(k.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(_.C0.ESC+"[>83;40003;0c")),!0},O.prototype._is=function(k){return(this._optionsService.rawOptions.termName+"").indexOf(k)===0},O.prototype.setMode=function(k){for(var x=0;x<k.length;x++)k.params[x]===4&&(this._coreService.modes.insertMode=!0);return!0},O.prototype.setModePrivate=function(k){for(var x=0;x<k.length;x++)switch(k.params[x]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,b.DEFAULT_CHARSET),this._charsetService.setgCharset(1,b.DEFAULT_CHARSET),this._charsetService.setgCharset(2,b.DEFAULT_CHARSET),this._charsetService.setgCharset(3,b.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0},O.prototype.resetMode=function(k){for(var x=0;x<k.length;x++)k.params[x]===4&&(this._coreService.modes.insertMode=!1);return!0},O.prototype.resetModePrivate=function(k){for(var x=0;x<k.length;x++)switch(k.params[x]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),k.params[x]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0},O.prototype._updateAttrColor=function(k,x,D,I,F){return x===2?(k|=50331648,k&=-16777216,k|=d.AttributeData.fromColorRGB([D,I,F])):x===5&&(k&=-50331904,k|=33554432|255&D),k},O.prototype._extractColor=function(k,x,D){var I=[0,0,-1,0,0,0],F=0,W=0;do{if(I[W+F]=k.params[x+W],k.hasSubParams(x+W)){var J=k.getSubParams(x+W),$=0;do I[1]===5&&(F=1),I[W+$+1+F]=J[$];while(++$<J.length&&$+W+1+F<I.length);break}if(I[1]===5&&W+F>=2||I[1]===2&&W+F>=5)break;I[1]&&(F=1)}while(++W+x<k.length&&W+F<I.length);for($=2;$<I.length;++$)I[$]===-1&&(I[$]=0);switch(I[0]){case 38:D.fg=this._updateAttrColor(D.fg,I[1],I[3],I[4],I[5]);break;case 48:D.bg=this._updateAttrColor(D.bg,I[1],I[3],I[4],I[5]);break;case 58:D.extended=D.extended.clone(),D.extended.underlineColor=this._updateAttrColor(D.extended.underlineColor,I[1],I[3],I[4],I[5])}return W},O.prototype._processUnderline=function(k,x){x.extended=x.extended.clone(),(!~k||k>5)&&(k=1),x.extended.underlineStyle=k,x.fg|=268435456,k===0&&(x.fg&=-268435457),x.updateExtended()},O.prototype.charAttributes=function(k){if(k.length===1&&k.params[0]===0)return this._curAttrData.fg=c.DEFAULT_ATTR_DATA.fg,this._curAttrData.bg=c.DEFAULT_ATTR_DATA.bg,!0;for(var x,D=k.length,I=this._curAttrData,F=0;F<D;F++)(x=k.params[F])>=30&&x<=37?(I.fg&=-50331904,I.fg|=16777216|x-30):x>=40&&x<=47?(I.bg&=-50331904,I.bg|=16777216|x-40):x>=90&&x<=97?(I.fg&=-50331904,I.fg|=16777224|x-90):x>=100&&x<=107?(I.bg&=-50331904,I.bg|=16777224|x-100):x===0?(I.fg=c.DEFAULT_ATTR_DATA.fg,I.bg=c.DEFAULT_ATTR_DATA.bg):x===1?I.fg|=134217728:x===3?I.bg|=67108864:x===4?(I.fg|=268435456,this._processUnderline(k.hasSubParams(F)?k.getSubParams(F)[0]:1,I)):x===5?I.fg|=536870912:x===7?I.fg|=67108864:x===8?I.fg|=1073741824:x===9?I.fg|=2147483648:x===2?I.bg|=134217728:x===21?this._processUnderline(2,I):x===22?(I.fg&=-134217729,I.bg&=-134217729):x===23?I.bg&=-67108865:x===24?I.fg&=-268435457:x===25?I.fg&=-536870913:x===27?I.fg&=-67108865:x===28?I.fg&=-1073741825:x===29?I.fg&=2147483647:x===39?(I.fg&=-67108864,I.fg|=16777215&c.DEFAULT_ATTR_DATA.fg):x===49?(I.bg&=-67108864,I.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):x===38||x===48||x===58?F+=this._extractColor(k,F,I):x===59?(I.extended=I.extended.clone(),I.extended.underlineColor=-1,I.updateExtended()):x===100?(I.fg&=-67108864,I.fg|=16777215&c.DEFAULT_ATTR_DATA.fg,I.bg&=-67108864,I.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",x);return!0},O.prototype.deviceStatus=function(k){switch(k.params[0]){case 5:this._coreService.triggerDataEvent(_.C0.ESC+"[0n");break;case 6:var x=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(_.C0.ESC+"["+x+";"+D+"R")}return!0},O.prototype.deviceStatusPrivate=function(k){if(k.params[0]===6){var x=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(_.C0.ESC+"[?"+x+";"+D+"R")}return!0},O.prototype.softReset=function(k){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0},O.prototype.setCursorStyle=function(k){var x=k.params[0]||1;switch(x){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var D=x%2==1;return this._optionsService.options.cursorBlink=D,!0},O.prototype.setScrollRegion=function(k){var x,D=k.params[0]||1;return(k.length<2||(x=k.params[1])>this._bufferService.rows||x===0)&&(x=this._bufferService.rows),x>D&&(this._activeBuffer.scrollTop=D-1,this._activeBuffer.scrollBottom=x-1,this._setCursor(0,0)),!0},O.prototype.windowOptions=function(k){if(!w(k.params[0],this._optionsService.rawOptions.windowOptions))return!0;var x=k.length>1?k.params[1]:0;switch(k.params[0]){case 14:x!==2&&this._onRequestWindowsOptionsReport.fire(p.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(p.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(_.C0.ESC+"[8;"+this._bufferService.rows+";"+this._bufferService.cols+"t");break;case 22:x!==0&&x!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),x!==0&&x!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:x!==0&&x!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),x!==0&&x!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0},O.prototype.saveCursor=function(k){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0},O.prototype.restoreCursor=function(k){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0},O.prototype.setTitle=function(k){return this._windowTitle=k,this._onTitleChange.fire(k),!0},O.prototype.setIconName=function(k){return this._iconName=k,!0},O.prototype.setOrReportIndexedColor=function(k){for(var x=[],D=k.split(";");D.length>1;){var I=D.shift(),F=D.shift();if(/^\d+$/.exec(I)){var W=parseInt(I);if(0<=W&&W<256)if(F==="?")x.push({type:0,index:W});else{var J=(0,E.parseColor)(F);J&&x.push({type:1,index:W,color:J})}}}return x.length&&this._onColor.fire(x),!0},O.prototype._setOrReportSpecialColor=function(k,x){for(var D=k.split(";"),I=0;I<D.length&&!(x>=this._specialColors.length);++I,++x)if(D[I]==="?")this._onColor.fire([{type:0,index:this._specialColors[x]}]);else{var F=(0,E.parseColor)(D[I]);F&&this._onColor.fire([{type:1,index:this._specialColors[x],color:F}])}return!0},O.prototype.setOrReportFgColor=function(k){return this._setOrReportSpecialColor(k,0)},O.prototype.setOrReportBgColor=function(k){return this._setOrReportSpecialColor(k,1)},O.prototype.setOrReportCursorColor=function(k){return this._setOrReportSpecialColor(k,2)},O.prototype.restoreIndexedColor=function(k){if(!k)return this._onColor.fire([{type:2}]),!0;for(var x=[],D=k.split(";"),I=0;I<D.length;++I)if(/^\d+$/.exec(D[I])){var F=parseInt(D[I]);0<=F&&F<256&&x.push({type:2,index:F})}return x.length&&this._onColor.fire(x),!0},O.prototype.restoreFgColor=function(k){return this._onColor.fire([{type:2,index:256}]),!0},O.prototype.restoreBgColor=function(k){return this._onColor.fire([{type:2,index:257}]),!0},O.prototype.restoreCursorColor=function(k){return this._onColor.fire([{type:2,index:258}]),!0},O.prototype.nextLine=function(){return this._activeBuffer.x=0,this.index(),!0},O.prototype.keypadApplicationMode=function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0},O.prototype.keypadNumericMode=function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0},O.prototype.selectDefaultCharset=function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,b.DEFAULT_CHARSET),!0},O.prototype.selectCharset=function(k){return k.length!==2?(this.selectDefaultCharset(),!0):(k[0]==="/"||this._charsetService.setgCharset(L[k[0]],b.CHARSETS[k[1]]||b.DEFAULT_CHARSET),!0)},O.prototype.index=function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0},O.prototype.tabSet=function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0},O.prototype.reverseIndex=function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var k=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,k,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0},O.prototype.fullReset=function(){return this._parser.reset(),this._onRequestReset.fire(),!0},O.prototype.reset=function(){this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone()},O.prototype._eraseAttrData=function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal},O.prototype.setgLevel=function(k){return this._charsetService.setgLevel(k),!0},O.prototype.screenAlignmentPattern=function(){var k=new n.CellData;k.content=1<<22|"E".charCodeAt(0),k.fg=this._curAttrData.fg,k.bg=this._curAttrData.bg,this._setCursor(0,0);for(var x=0;x<this._bufferService.rows;++x){var D=this._activeBuffer.ybase+this._activeBuffer.y+x,I=this._activeBuffer.lines.get(D);I&&(I.fill(k),I.isWrapped=!1)}return this._dirtyRowService.markAllDirty(),this._setCursor(0,0),!0},O}(h.Disposable);t.InputHandler=A},844:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.Disposable=void 0;var o=function(){function u(){this._disposables=[],this._isDisposed=!1}return u.prototype.dispose=function(){this._isDisposed=!0;for(var p=0,_=this._disposables;p<_.length;p++)_[p].dispose();this._disposables.length=0},u.prototype.register=function(p){return this._disposables.push(p),p},u.prototype.unregister=function(p){var _=this._disposables.indexOf(p);_!==-1&&this._disposables.splice(_,1)},u}();function a(u){for(var p=0,_=u;p<_.length;p++)_[p].dispose();u.length=0}t.Disposable=o,t.disposeArray=a,t.getDisposeArrayDisposable=function(u){return{dispose:function(){return a(u)}}}},6114:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.isSafari=t.isLegacyEdge=t.isFirefox=void 0;var o=typeof navigator=="undefined",a=o?"node":navigator.userAgent,u=o?"node":navigator.platform;t.isFirefox=a.includes("Firefox"),t.isLegacyEdge=a.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(a),t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u),t.isIpad=u==="iPad",t.isIphone=u==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(u),t.isLinux=u.indexOf("Linux")>=0},8273:(l,t)=>{function o(a,u,p,_){if(p===void 0&&(p=0),_===void 0&&(_=a.length),p>=a.length)return a;p=(a.length+p)%a.length,_=_>=a.length?a.length:(a.length+_)%a.length;for(var b=p;b<_;++b)a[b]=u;return a}Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.fillFallback=t.fill=void 0,t.fill=function(a,u,p,_){return a.fill?a.fill(u,p,_):o(a,u,p,_)},t.fillFallback=o,t.concat=function(a,u){var p=new a.constructor(a.length+u.length);return p.set(a),p.set(u,a.length),p}},9282:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;var a=o(643);t.updateWindowsModeWrappedState=function(u){var p=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),_=p==null?void 0:p.get(u.cols-1),b=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);b&&_&&(b.isWrapped=_[a.CHAR_DATA_CODE_INDEX]!==a.NULL_CELL_CODE&&_[a.CHAR_DATA_CODE_INDEX]!==a.WHITESPACE_CELL_CODE)}},3734:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var o=function(){function u(){this.fg=0,this.bg=0,this.extended=new a}return u.toColorRGB=function(p){return[p>>>16&255,p>>>8&255,255&p]},u.fromColorRGB=function(p){return(255&p[0])<<16|(255&p[1])<<8|255&p[2]},u.prototype.clone=function(){var p=new u;return p.fg=this.fg,p.bg=this.bg,p.extended=this.extended.clone(),p},u.prototype.isInverse=function(){return 67108864&this.fg},u.prototype.isBold=function(){return 134217728&this.fg},u.prototype.isUnderline=function(){return 268435456&this.fg},u.prototype.isBlink=function(){return 536870912&this.fg},u.prototype.isInvisible=function(){return 1073741824&this.fg},u.prototype.isItalic=function(){return 67108864&this.bg},u.prototype.isDim=function(){return 134217728&this.bg},u.prototype.isStrikethrough=function(){return 2147483648&this.fg},u.prototype.getFgColorMode=function(){return 50331648&this.fg},u.prototype.getBgColorMode=function(){return 50331648&this.bg},u.prototype.isFgRGB=function(){return(50331648&this.fg)==50331648},u.prototype.isBgRGB=function(){return(50331648&this.bg)==50331648},u.prototype.isFgPalette=function(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432},u.prototype.isBgPalette=function(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432},u.prototype.isFgDefault=function(){return(50331648&this.fg)==0},u.prototype.isBgDefault=function(){return(50331648&this.bg)==0},u.prototype.isAttributeDefault=function(){return this.fg===0&&this.bg===0},u.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},u.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},u.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},u.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},u.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},u.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},u.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()},u.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()},u.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()},u.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},u}();t.AttributeData=o;var a=function(){function u(p,_){p===void 0&&(p=0),_===void 0&&(_=-1),this.underlineStyle=p,this.underlineColor=_}return u.prototype.clone=function(){return new u(this.underlineStyle,this.underlineColor)},u.prototype.isEmpty=function(){return this.underlineStyle===0},u}();t.ExtendedAttrs=a},9092:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferStringIterator=t.Buffer=t.MAX_BUFFER_SIZE=void 0;var a=o(6349),u=o(8437),p=o(511),_=o(643),b=o(4634),m=o(4863),h=o(7116),v=o(3734);t.MAX_BUFFER_SIZE=4294967295;var g=function(){function r(i,n,d){this._hasScrollback=i,this._optionsService=n,this._bufferService=d,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.savedY=0,this.savedX=0,this.savedCurAttrData=u.DEFAULT_ATTR_DATA.clone(),this.savedCharset=h.DEFAULT_CHARSET,this.markers=[],this._nullCell=p.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=p.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new a.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return r.prototype.getNullCell=function(i){return i?(this._nullCell.fg=i.fg,this._nullCell.bg=i.bg,this._nullCell.extended=i.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new v.ExtendedAttrs),this._nullCell},r.prototype.getWhitespaceCell=function(i){return i?(this._whitespaceCell.fg=i.fg,this._whitespaceCell.bg=i.bg,this._whitespaceCell.extended=i.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new v.ExtendedAttrs),this._whitespaceCell},r.prototype.getBlankLine=function(i,n){return new u.BufferLine(this._bufferService.cols,this.getNullCell(i),n)},Object.defineProperty(r.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isCursorInViewport",{get:function(){var i=this.ybase+this.y-this.ydisp;return i>=0&&i<this._rows},enumerable:!1,configurable:!0}),r.prototype._getCorrectBufferLength=function(i){if(!this._hasScrollback)return i;var n=i+this._optionsService.rawOptions.scrollback;return n>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:n},r.prototype.fillViewportRows=function(i){if(this.lines.length===0){i===void 0&&(i=u.DEFAULT_ATTR_DATA);for(var n=this._rows;n--;)this.lines.push(this.getBlankLine(i))}},r.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new a.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},r.prototype.resize=function(i,n){var d=this.getNullCell(u.DEFAULT_ATTR_DATA),f=this._getCorrectBufferLength(n);if(f>this.lines.maxLength&&(this.lines.maxLength=f),this.lines.length>0){if(this._cols<i)for(var y=0;y<this.lines.length;y++)this.lines.get(y).resize(i,d);var S=0;if(this._rows<n)for(var E=this._rows;E<n;E++)this.lines.length<n+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new u.BufferLine(i,d)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new u.BufferLine(i,d)));else for(E=this._rows;E>n;E--)this.lines.length>n+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(f<this.lines.maxLength){var L=this.lines.length-f;L>0&&(this.lines.trimStart(L),this.ybase=Math.max(this.ybase-L,0),this.ydisp=Math.max(this.ydisp-L,0),this.savedY=Math.max(this.savedY-L,0)),this.lines.maxLength=f}this.x=Math.min(this.x,i-1),this.y=Math.min(this.y,n-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,i-1),this.scrollTop=0}if(this.scrollBottom=n-1,this._isReflowEnabled&&(this._reflow(i,n),this._cols>i))for(y=0;y<this.lines.length;y++)this.lines.get(y).resize(i,d);this._cols=i,this._rows=n},Object.defineProperty(r.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode},enumerable:!1,configurable:!0}),r.prototype._reflow=function(i,n){this._cols!==i&&(i>this._cols?this._reflowLarger(i,n):this._reflowSmaller(i,n))},r.prototype._reflowLarger=function(i,n){var d=(0,b.reflowLargerGetLinesToRemove)(this.lines,this._cols,i,this.ybase+this.y,this.getNullCell(u.DEFAULT_ATTR_DATA));if(d.length>0){var f=(0,b.reflowLargerCreateNewLayout)(this.lines,d);(0,b.reflowLargerApplyNewLayout)(this.lines,f.layout),this._reflowLargerAdjustViewport(i,n,f.countRemoved)}},r.prototype._reflowLargerAdjustViewport=function(i,n,d){for(var f=this.getNullCell(u.DEFAULT_ATTR_DATA),y=d;y-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<n&&this.lines.push(new u.BufferLine(i,f))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-d,0)},r.prototype._reflowSmaller=function(i,n){for(var d=this.getNullCell(u.DEFAULT_ATTR_DATA),f=[],y=0,S=this.lines.length-1;S>=0;S--){var E=this.lines.get(S);if(!(!E||!E.isWrapped&&E.getTrimmedLength()<=i)){for(var L=[E];E.isWrapped&&S>0;)E=this.lines.get(--S),L.unshift(E);var C=this.ybase+this.y;if(!(C>=S&&C<S+L.length)){var w,T=L[L.length-1].getTrimmedLength(),A=(0,b.reflowSmallerGetNewLineLengths)(L,this._cols,i),H=A.length-L.length;w=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+H):Math.max(0,this.lines.length-this.lines.maxLength+H);for(var O=[],k=0;k<H;k++){var x=this.getBlankLine(u.DEFAULT_ATTR_DATA,!0);O.push(x)}O.length>0&&(f.push({start:S+L.length+y,newLines:O}),y+=O.length),L.push.apply(L,O);var D=A.length-1,I=A[D];I===0&&(I=A[--D]);for(var F=L.length-H-1,W=T;F>=0;){var J=Math.min(W,I);if(L[D]===void 0)break;if(L[D].copyCellsFrom(L[F],W-J,I-J,J,!0),(I-=J)==0&&(I=A[--D]),(W-=J)==0){F--;var $=Math.max(F,0);W=(0,b.getWrappedLineTrimmedLength)(L,$,this._cols)}}for(k=0;k<L.length;k++)A[k]<i&&L[k].setCell(A[k],d);for(var G=H-w;G-- >0;)this.ybase===0?this.y<n-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+y)-n&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+H,this.ybase+n-1)}}}if(f.length>0){var R=[],N=[];for(k=0;k<this.lines.length;k++)N.push(this.lines.get(k));var P=this.lines.length,B=P-1,M=0,K=f[M];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+y);var V=0;for(k=Math.min(this.lines.maxLength-1,P+y-1);k>=0;k--)if(K&&K.start>B+V){for(var X=K.newLines.length-1;X>=0;X--)this.lines.set(k--,K.newLines[X]);k++,R.push({index:B+1,amount:K.newLines.length}),V+=K.newLines.length,K=f[++M]}else this.lines.set(k,N[B--]);var Y=0;for(k=R.length-1;k>=0;k--)R[k].index+=Y,this.lines.onInsertEmitter.fire(R[k]),Y+=R[k].amount;var Z=Math.max(0,P+y-this.lines.maxLength);Z>0&&this.lines.onTrimEmitter.fire(Z)}},r.prototype.stringIndexToBufferIndex=function(i,n,d){for(d===void 0&&(d=!1);n;){var f=this.lines.get(i);if(!f)return[-1,-1];for(var y=d?f.getTrimmedLength():f.length,S=0;S<y;++S)if(f.get(S)[_.CHAR_DATA_WIDTH_INDEX]&&(n-=f.get(S)[_.CHAR_DATA_CHAR_INDEX].length||1),n<0)return[i,S];i++}return[i,0]},r.prototype.translateBufferLineToString=function(i,n,d,f){d===void 0&&(d=0);var y=this.lines.get(i);return y?y.translateToString(n,d,f):""},r.prototype.getWrappedRangeForLine=function(i){for(var n=i,d=i;n>0&&this.lines.get(n).isWrapped;)n--;for(;d+1<this.lines.length&&this.lines.get(d+1).isWrapped;)d++;return{first:n,last:d}},r.prototype.setupTabStops=function(i){for(i!=null?this.tabs[i]||(i=this.prevStop(i)):(this.tabs={},i=0);i<this._cols;i+=this._optionsService.rawOptions.tabStopWidth)this.tabs[i]=!0},r.prototype.prevStop=function(i){for(i==null&&(i=this.x);!this.tabs[--i]&&i>0;);return i>=this._cols?this._cols-1:i<0?0:i},r.prototype.nextStop=function(i){for(i==null&&(i=this.x);!this.tabs[++i]&&i<this._cols;);return i>=this._cols?this._cols-1:i<0?0:i},r.prototype.clearMarkers=function(i){if(this._isClearing=!0,i!==void 0)for(var n=0;n<this.markers.length;n++)this.markers[n].line===i&&(this.markers[n].dispose(),this.markers.splice(n--,1));else{for(var d=0,f=this.markers;d<f.length;d++)f[d].dispose();this.markers=[]}this._isClearing=!1},r.prototype.addMarker=function(i){var n=this,d=new m.Marker(i);return this.markers.push(d),d.register(this.lines.onTrim(function(f){d.line-=f,d.line<0&&d.dispose()})),d.register(this.lines.onInsert(function(f){d.line>=f.index&&(d.line+=f.amount)})),d.register(this.lines.onDelete(function(f){d.line>=f.index&&d.line<f.index+f.amount&&d.dispose(),d.line>f.index&&(d.line-=f.amount)})),d.register(d.onDispose(function(){return n._removeMarker(d)})),d},r.prototype._removeMarker=function(i){this._isClearing||this.markers.splice(this.markers.indexOf(i),1)},r.prototype.iterator=function(i,n,d,f,y){return new c(this,i,n,d,f,y)},r}();t.Buffer=g;var c=function(){function r(i,n,d,f,y,S){d===void 0&&(d=0),f===void 0&&(f=i.lines.length),y===void 0&&(y=0),S===void 0&&(S=0),this._buffer=i,this._trimRight=n,this._startIndex=d,this._endIndex=f,this._startOverscan=y,this._endOverscan=S,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return r.prototype.hasNext=function(){return this._current<this._endIndex},r.prototype.next=function(){var i=this._buffer.getWrappedRangeForLine(this._current);i.first<this._startIndex-this._startOverscan&&(i.first=this._startIndex-this._startOverscan),i.last>this._endIndex+this._endOverscan&&(i.last=this._endIndex+this._endOverscan),i.first=Math.max(i.first,0),i.last=Math.min(i.last,this._buffer.lines.length);for(var n="",d=i.first;d<=i.last;++d)n+=this._buffer.translateBufferLineToString(d,this._trimRight);return this._current=i.last+1,{range:i,content:n}},r}();t.BufferStringIterator=c},8437:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;var a=o(482),u=o(643),p=o(511),_=o(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new _.AttributeData);var b=function(){function m(h,v,g){g===void 0&&(g=!1),this.isWrapped=g,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*h);for(var c=v||p.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]),r=0;r<h;++r)this.setCell(r,c);this.length=h}return m.prototype.get=function(h){var v=this._data[3*h+0],g=2097151&v;return[this._data[3*h+1],2097152&v?this._combined[h]:g?(0,a.stringFromCodePoint)(g):"",v>>22,2097152&v?this._combined[h].charCodeAt(this._combined[h].length-1):g]},m.prototype.set=function(h,v){this._data[3*h+1]=v[u.CHAR_DATA_ATTR_INDEX],v[u.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[h]=v[1],this._data[3*h+0]=2097152|h|v[u.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*h+0]=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[u.CHAR_DATA_WIDTH_INDEX]<<22},m.prototype.getWidth=function(h){return this._data[3*h+0]>>22},m.prototype.hasWidth=function(h){return 12582912&this._data[3*h+0]},m.prototype.getFg=function(h){return this._data[3*h+1]},m.prototype.getBg=function(h){return this._data[3*h+2]},m.prototype.hasContent=function(h){return 4194303&this._data[3*h+0]},m.prototype.getCodePoint=function(h){var v=this._data[3*h+0];return 2097152&v?this._combined[h].charCodeAt(this._combined[h].length-1):2097151&v},m.prototype.isCombined=function(h){return 2097152&this._data[3*h+0]},m.prototype.getString=function(h){var v=this._data[3*h+0];return 2097152&v?this._combined[h]:2097151&v?(0,a.stringFromCodePoint)(2097151&v):""},m.prototype.loadCell=function(h,v){var g=3*h;return v.content=this._data[g+0],v.fg=this._data[g+1],v.bg=this._data[g+2],2097152&v.content&&(v.combinedData=this._combined[h]),268435456&v.bg&&(v.extended=this._extendedAttrs[h]),v},m.prototype.setCell=function(h,v){2097152&v.content&&(this._combined[h]=v.combinedData),268435456&v.bg&&(this._extendedAttrs[h]=v.extended),this._data[3*h+0]=v.content,this._data[3*h+1]=v.fg,this._data[3*h+2]=v.bg},m.prototype.setCellFromCodePoint=function(h,v,g,c,r,i){268435456&r&&(this._extendedAttrs[h]=i),this._data[3*h+0]=v|g<<22,this._data[3*h+1]=c,this._data[3*h+2]=r},m.prototype.addCodepointToCell=function(h,v){var g=this._data[3*h+0];2097152&g?this._combined[h]+=(0,a.stringFromCodePoint)(v):(2097151&g?(this._combined[h]=(0,a.stringFromCodePoint)(2097151&g)+(0,a.stringFromCodePoint)(v),g&=-2097152,g|=2097152):g=v|1<<22,this._data[3*h+0]=g)},m.prototype.insertCells=function(h,v,g,c){if((h%=this.length)&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new _.ExtendedAttrs),v<this.length-h){for(var r=new p.CellData,i=this.length-h-v-1;i>=0;--i)this.setCell(h+v+i,this.loadCell(h+i,r));for(i=0;i<v;++i)this.setCell(h+i,g)}else for(i=h;i<this.length;++i)this.setCell(i,g);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new _.ExtendedAttrs)},m.prototype.deleteCells=function(h,v,g,c){if(h%=this.length,v<this.length-h){for(var r=new p.CellData,i=0;i<this.length-h-v;++i)this.setCell(h+i,this.loadCell(h+v+i,r));for(i=this.length-v;i<this.length;++i)this.setCell(i,g)}else for(i=h;i<this.length;++i)this.setCell(i,g);h&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new _.ExtendedAttrs),this.getWidth(h)!==0||this.hasContent(h)||this.setCellFromCodePoint(h,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new _.ExtendedAttrs)},m.prototype.replaceCells=function(h,v,g,c){for(h&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new _.ExtendedAttrs),v<this.length&&this.getWidth(v-1)===2&&this.setCellFromCodePoint(v,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new _.ExtendedAttrs);h<v&&h<this.length;)this.setCell(h++,g)},m.prototype.resize=function(h,v){if(h!==this.length){if(h>this.length){var g=new Uint32Array(3*h);this.length&&(3*h<this._data.length?g.set(this._data.subarray(0,3*h)):g.set(this._data)),this._data=g;for(var c=this.length;c<h;++c)this.setCell(c,v)}else if(h){(g=new Uint32Array(3*h)).set(this._data.subarray(0,3*h)),this._data=g;var r=Object.keys(this._combined);for(c=0;c<r.length;c++){var i=parseInt(r[c],10);i>=h&&delete this._combined[i]}}else this._data=new Uint32Array(0),this._combined={};this.length=h}},m.prototype.fill=function(h){this._combined={},this._extendedAttrs={};for(var v=0;v<this.length;++v)this.setCell(v,h)},m.prototype.copyFrom=function(h){for(var v in this.length!==h.length?this._data=new Uint32Array(h._data):this._data.set(h._data),this.length=h.length,this._combined={},h._combined)this._combined[v]=h._combined[v];for(var v in this._extendedAttrs={},h._extendedAttrs)this._extendedAttrs[v]=h._extendedAttrs[v];this.isWrapped=h.isWrapped},m.prototype.clone=function(){var h=new m(0);for(var v in h._data=new Uint32Array(this._data),h.length=this.length,this._combined)h._combined[v]=this._combined[v];for(var v in this._extendedAttrs)h._extendedAttrs[v]=this._extendedAttrs[v];return h.isWrapped=this.isWrapped,h},m.prototype.getTrimmedLength=function(){for(var h=this.length-1;h>=0;--h)if(4194303&this._data[3*h+0])return h+(this._data[3*h+0]>>22);return 0},m.prototype.copyCellsFrom=function(h,v,g,c,r){var i=h._data;if(r)for(var n=c-1;n>=0;n--)for(var d=0;d<3;d++)this._data[3*(g+n)+d]=i[3*(v+n)+d];else for(n=0;n<c;n++)for(d=0;d<3;d++)this._data[3*(g+n)+d]=i[3*(v+n)+d];var f=Object.keys(h._combined);for(d=0;d<f.length;d++){var y=parseInt(f[d],10);y>=v&&(this._combined[y-v+g]=h._combined[y])}},m.prototype.translateToString=function(h,v,g){h===void 0&&(h=!1),v===void 0&&(v=0),g===void 0&&(g=this.length),h&&(g=Math.min(g,this.getTrimmedLength()));for(var c="";v<g;){var r=this._data[3*v+0],i=2097151&r;c+=2097152&r?this._combined[v]:i?(0,a.stringFromCodePoint)(i):u.WHITESPACE_CELL_CHAR,v+=r>>22||1}return c},m}();t.BufferLine=b},4841:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(o,a){if(o.start.y>o.end.y)throw new Error("Buffer range end ("+o.end.x+", "+o.end.y+") cannot be before start ("+o.start.x+", "+o.start.y+")");return a*(o.end.y-o.start.y)+(o.end.x-o.start.x+1)}},4634:(l,t)=>{function o(a,u,p){if(u===a.length-1)return a[u].getTrimmedLength();var _=!a[u].hasContent(p-1)&&a[u].getWidth(p-1)===1,b=a[u+1].getWidth(0)===2;return _&&b?p-1:p}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(a,u,p,_,b){for(var m=[],h=0;h<a.length-1;h++){var v=h,g=a.get(++v);if(g.isWrapped){for(var c=[a.get(h)];v<a.length&&g.isWrapped;)c.push(g),g=a.get(++v);if(_>=h&&_<v)h+=c.length-1;else{for(var r=0,i=o(c,r,u),n=1,d=0;n<c.length;){var f=o(c,n,u),y=f-d,S=p-i,E=Math.min(y,S);c[r].copyCellsFrom(c[n],d,i,E,!1),(i+=E)===p&&(r++,i=0),(d+=E)===f&&(n++,d=0),i===0&&r!==0&&c[r-1].getWidth(p-1)===2&&(c[r].copyCellsFrom(c[r-1],p-1,i++,1,!1),c[r-1].setCell(p-1,b))}c[r].replaceCells(i,p,b);for(var L=0,C=c.length-1;C>0&&(C>r||c[C].getTrimmedLength()===0);C--)L++;L>0&&(m.push(h+c.length-L),m.push(L)),h+=c.length-1}}}return m},t.reflowLargerCreateNewLayout=function(a,u){for(var p=[],_=0,b=u[_],m=0,h=0;h<a.length;h++)if(b===h){var v=u[++_];a.onDeleteEmitter.fire({index:h-m,amount:v}),h+=v-1,m+=v,b=u[++_]}else p.push(h);return{layout:p,countRemoved:m}},t.reflowLargerApplyNewLayout=function(a,u){for(var p=[],_=0;_<u.length;_++)p.push(a.get(u[_]));for(_=0;_<p.length;_++)a.set(_,p[_]);a.length=u.length},t.reflowSmallerGetNewLineLengths=function(a,u,p){for(var _=[],b=a.map(function(i,n){return o(a,n,u)}).reduce(function(i,n){return i+n}),m=0,h=0,v=0;v<b;){if(b-v<p){_.push(b-v);break}m+=p;var g=o(a,h,u);m>g&&(m-=g,h++);var c=a[h].getWidth(m-1)===2;c&&m--;var r=c?p-1:p;_.push(r),v+=r}return _},t.getWrappedLineTrimmedLength=o},5295:function(l,t,o){var a,u=this&&this.__extends||(a=function(m,h){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var c in g)Object.prototype.hasOwnProperty.call(g,c)&&(v[c]=g[c])},a(m,h)},function(m,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");function v(){this.constructor=m}a(m,h),m.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)});Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;var p=o(9092),_=o(8460),b=function(m){function h(v,g){var c=m.call(this)||this;return c._optionsService=v,c._bufferService=g,c._onBufferActivate=c.register(new _.EventEmitter),c.reset(),c}return u(h,m),Object.defineProperty(h.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!1,configurable:!0}),h.prototype.reset=function(){this._normal=new p.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new p.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()},Object.defineProperty(h.prototype,"alt",{get:function(){return this._alt},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),h.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},h.prototype.activateAltBuffer=function(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},h.prototype.resize=function(v,g){this._normal.resize(v,g),this._alt.resize(v,g)},h.prototype.setupTabStops=function(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)},h}(o(844).Disposable);t.BufferSet=b},511:function(l,t,o){var a,u=this&&this.__extends||(a=function(h,v){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,c){g.__proto__=c}||function(g,c){for(var r in c)Object.prototype.hasOwnProperty.call(c,r)&&(g[r]=c[r])},a(h,v)},function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function g(){this.constructor=h}a(h,v),h.prototype=v===null?Object.create(v):(g.prototype=v.prototype,new g)});Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var p=o(482),_=o(643),b=o(3734),m=function(h){function v(){var g=h!==null&&h.apply(this,arguments)||this;return g.content=0,g.fg=0,g.bg=0,g.extended=new b.ExtendedAttrs,g.combinedData="",g}return u(v,h),v.fromCharData=function(g){var c=new v;return c.setFromCharData(g),c},v.prototype.isCombined=function(){return 2097152&this.content},v.prototype.getWidth=function(){return this.content>>22},v.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,p.stringFromCodePoint)(2097151&this.content):""},v.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},v.prototype.setFromCharData=function(g){this.fg=g[_.CHAR_DATA_ATTR_INDEX],this.bg=0;var c=!1;if(g[_.CHAR_DATA_CHAR_INDEX].length>2)c=!0;else if(g[_.CHAR_DATA_CHAR_INDEX].length===2){var r=g[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){var i=g[_.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=i&&i<=57343?this.content=1024*(r-55296)+i-56320+65536|g[_.CHAR_DATA_WIDTH_INDEX]<<22:c=!0}else c=!0}else this.content=g[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|g[_.CHAR_DATA_WIDTH_INDEX]<<22;c&&(this.combinedData=g[_.CHAR_DATA_CHAR_INDEX],this.content=2097152|g[_.CHAR_DATA_WIDTH_INDEX]<<22)},v.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},v}(b.AttributeData);t.CellData=m},643:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=256,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:function(l,t,o){var a,u=this&&this.__extends||(a=function(b,m){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,v){h.__proto__=v}||function(h,v){for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&(h[g]=v[g])},a(b,m)},function(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");function h(){this.constructor=b}a(b,m),b.prototype=m===null?Object.create(m):(h.prototype=m.prototype,new h)});Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;var p=o(8460),_=function(b){function m(h){var v=b.call(this)||this;return v.line=h,v._id=m._nextId++,v.isDisposed=!1,v._onDispose=new p.EventEmitter,v}return u(m,b),Object.defineProperty(m.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!1,configurable:!0}),m.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),b.prototype.dispose.call(this))},m._nextId=1,m}(o(844).Disposable);t.Marker=_},7116:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},t.CHARSETS.A={"#":"\xA3"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},t.CHARSETS.C=t.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},t.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},t.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},t.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},t.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},t.CHARSETS.E=t.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},t.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},t.CHARSETS.H=t.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},t.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(l,t)=>{var o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.C1=t.C0=void 0,(a=t.C0||(t.C0={})).NUL="\0",a.SOH="",a.STX="",a.ETX="",a.EOT="",a.ENQ="",a.ACK="",a.BEL="\x07",a.BS="\b",a.HT="	",a.LF=`
`,a.VT="\v",a.FF="\f",a.CR="\r",a.SO="",a.SI="",a.DLE="",a.DC1="",a.DC2="",a.DC3="",a.DC4="",a.NAK="",a.SYN="",a.ETB="",a.CAN="",a.EM="",a.SUB="",a.ESC="\x1B",a.FS="",a.GS="",a.RS="",a.US="",a.SP=" ",a.DEL="\x7F",(o=t.C1||(t.C1={})).PAD="\x80",o.HOP="\x81",o.BPH="\x82",o.NBH="\x83",o.IND="\x84",o.NEL="\x85",o.SSA="\x86",o.ESA="\x87",o.HTS="\x88",o.HTJ="\x89",o.VTS="\x8A",o.PLD="\x8B",o.PLU="\x8C",o.RI="\x8D",o.SS2="\x8E",o.SS3="\x8F",o.DCS="\x90",o.PU1="\x91",o.PU2="\x92",o.STS="\x93",o.CCH="\x94",o.MW="\x95",o.SPA="\x96",o.EPA="\x97",o.SOS="\x98",o.SGCI="\x99",o.SCI="\x9A",o.CSI="\x9B",o.ST="\x9C",o.OSC="\x9D",o.PM="\x9E",o.APC="\x9F"},7399:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;var a=o(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(p,_,b,m){var h={type:0,cancel:!1,key:void 0},v=(p.shiftKey?1:0)|(p.altKey?2:0)|(p.ctrlKey?4:0)|(p.metaKey?8:0);switch(p.keyCode){case 0:p.key==="UIKeyInputUpArrow"?h.key=_?a.C0.ESC+"OA":a.C0.ESC+"[A":p.key==="UIKeyInputLeftArrow"?h.key=_?a.C0.ESC+"OD":a.C0.ESC+"[D":p.key==="UIKeyInputRightArrow"?h.key=_?a.C0.ESC+"OC":a.C0.ESC+"[C":p.key==="UIKeyInputDownArrow"&&(h.key=_?a.C0.ESC+"OB":a.C0.ESC+"[B");break;case 8:if(p.shiftKey){h.key=a.C0.BS;break}if(p.altKey){h.key=a.C0.ESC+a.C0.DEL;break}h.key=a.C0.DEL;break;case 9:if(p.shiftKey){h.key=a.C0.ESC+"[Z";break}h.key=a.C0.HT,h.cancel=!0;break;case 13:h.key=p.altKey?a.C0.ESC+a.C0.CR:a.C0.CR,h.cancel=!0;break;case 27:h.key=a.C0.ESC,p.altKey&&(h.key=a.C0.ESC+a.C0.ESC),h.cancel=!0;break;case 37:if(p.metaKey)break;v?(h.key=a.C0.ESC+"[1;"+(v+1)+"D",h.key===a.C0.ESC+"[1;3D"&&(h.key=a.C0.ESC+(b?"b":"[1;5D"))):h.key=_?a.C0.ESC+"OD":a.C0.ESC+"[D";break;case 39:if(p.metaKey)break;v?(h.key=a.C0.ESC+"[1;"+(v+1)+"C",h.key===a.C0.ESC+"[1;3C"&&(h.key=a.C0.ESC+(b?"f":"[1;5C"))):h.key=_?a.C0.ESC+"OC":a.C0.ESC+"[C";break;case 38:if(p.metaKey)break;v?(h.key=a.C0.ESC+"[1;"+(v+1)+"A",b||h.key!==a.C0.ESC+"[1;3A"||(h.key=a.C0.ESC+"[1;5A")):h.key=_?a.C0.ESC+"OA":a.C0.ESC+"[A";break;case 40:if(p.metaKey)break;v?(h.key=a.C0.ESC+"[1;"+(v+1)+"B",b||h.key!==a.C0.ESC+"[1;3B"||(h.key=a.C0.ESC+"[1;5B")):h.key=_?a.C0.ESC+"OB":a.C0.ESC+"[B";break;case 45:p.shiftKey||p.ctrlKey||(h.key=a.C0.ESC+"[2~");break;case 46:h.key=v?a.C0.ESC+"[3;"+(v+1)+"~":a.C0.ESC+"[3~";break;case 36:h.key=v?a.C0.ESC+"[1;"+(v+1)+"H":_?a.C0.ESC+"OH":a.C0.ESC+"[H";break;case 35:h.key=v?a.C0.ESC+"[1;"+(v+1)+"F":_?a.C0.ESC+"OF":a.C0.ESC+"[F";break;case 33:p.shiftKey?h.type=2:h.key=a.C0.ESC+"[5~";break;case 34:p.shiftKey?h.type=3:h.key=a.C0.ESC+"[6~";break;case 112:h.key=v?a.C0.ESC+"[1;"+(v+1)+"P":a.C0.ESC+"OP";break;case 113:h.key=v?a.C0.ESC+"[1;"+(v+1)+"Q":a.C0.ESC+"OQ";break;case 114:h.key=v?a.C0.ESC+"[1;"+(v+1)+"R":a.C0.ESC+"OR";break;case 115:h.key=v?a.C0.ESC+"[1;"+(v+1)+"S":a.C0.ESC+"OS";break;case 116:h.key=v?a.C0.ESC+"[15;"+(v+1)+"~":a.C0.ESC+"[15~";break;case 117:h.key=v?a.C0.ESC+"[17;"+(v+1)+"~":a.C0.ESC+"[17~";break;case 118:h.key=v?a.C0.ESC+"[18;"+(v+1)+"~":a.C0.ESC+"[18~";break;case 119:h.key=v?a.C0.ESC+"[19;"+(v+1)+"~":a.C0.ESC+"[19~";break;case 120:h.key=v?a.C0.ESC+"[20;"+(v+1)+"~":a.C0.ESC+"[20~";break;case 121:h.key=v?a.C0.ESC+"[21;"+(v+1)+"~":a.C0.ESC+"[21~";break;case 122:h.key=v?a.C0.ESC+"[23;"+(v+1)+"~":a.C0.ESC+"[23~";break;case 123:h.key=v?a.C0.ESC+"[24;"+(v+1)+"~":a.C0.ESC+"[24~";break;default:if(!p.ctrlKey||p.shiftKey||p.altKey||p.metaKey)if(b&&!m||!p.altKey||p.metaKey)!b||p.altKey||p.ctrlKey||p.shiftKey||!p.metaKey?p.key&&!p.ctrlKey&&!p.altKey&&!p.metaKey&&p.keyCode>=48&&p.key.length===1?h.key=p.key:p.key&&p.ctrlKey&&p.key==="_"&&(h.key=a.C0.US):p.keyCode===65&&(h.type=1);else{var g=u[p.keyCode],c=g==null?void 0:g[p.shiftKey?1:0];if(c)h.key=a.C0.ESC+c;else if(p.keyCode>=65&&p.keyCode<=90){var r=p.ctrlKey?p.keyCode-64:p.keyCode+32;h.key=a.C0.ESC+String.fromCharCode(r)}}else p.keyCode>=65&&p.keyCode<=90?h.key=String.fromCharCode(p.keyCode-64):p.keyCode===32?h.key=a.C0.NUL:p.keyCode>=51&&p.keyCode<=55?h.key=String.fromCharCode(p.keyCode-51+27):p.keyCode===56?h.key=a.C0.DEL:p.keyCode===219?h.key=a.C0.ESC:p.keyCode===220?h.key=a.C0.FS:p.keyCode===221&&(h.key=a.C0.GS)}return h}},482:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},t.utf32ToString=function(u,p,_){p===void 0&&(p=0),_===void 0&&(_=u.length);for(var b="",m=p;m<_;++m){var h=u[m];h>65535?(h-=65536,b+=String.fromCharCode(55296+(h>>10))+String.fromCharCode(h%1024+56320)):b+=String.fromCharCode(h)}return b};var o=function(){function u(){this._interim=0}return u.prototype.clear=function(){this._interim=0},u.prototype.decode=function(p,_){var b=p.length;if(!b)return 0;var m=0,h=0;this._interim&&(56320<=(c=p.charCodeAt(h++))&&c<=57343?_[m++]=1024*(this._interim-55296)+c-56320+65536:(_[m++]=this._interim,_[m++]=c),this._interim=0);for(var v=h;v<b;++v){var g=p.charCodeAt(v);if(55296<=g&&g<=56319){if(++v>=b)return this._interim=g,m;var c;56320<=(c=p.charCodeAt(v))&&c<=57343?_[m++]=1024*(g-55296)+c-56320+65536:(_[m++]=g,_[m++]=c)}else g!==65279&&(_[m++]=g)}return m},u}();t.StringToUtf32=o;var a=function(){function u(){this.interim=new Uint8Array(3)}return u.prototype.clear=function(){this.interim.fill(0)},u.prototype.decode=function(p,_){var b=p.length;if(!b)return 0;var m,h,v,g,c=0,r=0,i=0;if(this.interim[0]){var n=!1,d=this.interim[0];d&=(224&d)==192?31:(240&d)==224?15:7;for(var f=0,y=void 0;(y=63&this.interim[++f])&&f<4;)d<<=6,d|=y;for(var S=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=S-f;i<E;){if(i>=b)return 0;if((192&(y=p[i++]))!=128){i--,n=!0;break}this.interim[f++]=y,d<<=6,d|=63&y}n||(S===2?d<128?i--:_[c++]=d:S===3?d<2048||d>=55296&&d<=57343||d===65279||(_[c++]=d):d<65536||d>1114111||(_[c++]=d)),this.interim.fill(0)}for(var L=b-4,C=i;C<b;){for(;!(!(C<L)||128&(m=p[C])||128&(h=p[C+1])||128&(v=p[C+2])||128&(g=p[C+3]));)_[c++]=m,_[c++]=h,_[c++]=v,_[c++]=g,C+=4;if((m=p[C++])<128)_[c++]=m;else if((224&m)==192){if(C>=b)return this.interim[0]=m,c;if((192&(h=p[C++]))!=128){C--;continue}if((r=(31&m)<<6|63&h)<128){C--;continue}_[c++]=r}else if((240&m)==224){if(C>=b)return this.interim[0]=m,c;if((192&(h=p[C++]))!=128){C--;continue}if(C>=b)return this.interim[0]=m,this.interim[1]=h,c;if((192&(v=p[C++]))!=128){C--;continue}if((r=(15&m)<<12|(63&h)<<6|63&v)<2048||r>=55296&&r<=57343||r===65279)continue;_[c++]=r}else if((248&m)==240){if(C>=b)return this.interim[0]=m,c;if((192&(h=p[C++]))!=128){C--;continue}if(C>=b)return this.interim[0]=m,this.interim[1]=h,c;if((192&(v=p[C++]))!=128){C--;continue}if(C>=b)return this.interim[0]=m,this.interim[1]=h,this.interim[2]=v,c;if((192&(g=p[C++]))!=128){C--;continue}if((r=(7&m)<<18|(63&h)<<12|(63&v)<<6|63&g)<65536||r>1114111)continue;_[c++]=r}}return c},u}();t.Utf8ToUtf32=a},225:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;var a,u=o(8273),p=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],_=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],b=function(){function m(){if(this.version="6",!a){a=new Uint8Array(65536),(0,u.fill)(a,1),a[0]=0,(0,u.fill)(a,0,1,32),(0,u.fill)(a,0,127,160),(0,u.fill)(a,2,4352,4448),a[9001]=2,a[9002]=2,(0,u.fill)(a,2,11904,42192),a[12351]=1,(0,u.fill)(a,2,44032,55204),(0,u.fill)(a,2,63744,64256),(0,u.fill)(a,2,65040,65050),(0,u.fill)(a,2,65072,65136),(0,u.fill)(a,2,65280,65377),(0,u.fill)(a,2,65504,65511);for(var h=0;h<p.length;++h)(0,u.fill)(a,0,p[h][0],p[h][1]+1)}}return m.prototype.wcwidth=function(h){return h<32?0:h<127?1:h<65536?a[h]:function(v,g){var c,r=0,i=g.length-1;if(v<g[0][0]||v>g[i][1])return!1;for(;i>=r;)if(v>g[c=r+i>>1][1])r=c+1;else{if(!(v<g[c][0]))return!0;i=c-1}return!1}(h,_)?0:h>=131072&&h<=196605||h>=196608&&h<=262141?2:1},m}();t.UnicodeV6=b},5981:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;var o=typeof queueMicrotask=="undefined"?function(u){Promise.resolve().then(u)}:queueMicrotask,a=function(){function u(p){this._action=p,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0}return u.prototype.writeSync=function(p,_){if(_!==void 0&&this._syncCalls>_)this._syncCalls=0;else if(this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var b;for(this._isSyncWriting=!0;b=this._writeBuffer.shift();){this._action(b);var m=this._callbacks.shift();m&&m()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}},u.prototype.write=function(p,_){var b=this;if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");this._writeBuffer.length||(this._bufferOffset=0,setTimeout(function(){return b._innerWrite()})),this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(_)},u.prototype._innerWrite=function(p,_){var b=this;p===void 0&&(p=0),_===void 0&&(_=!0);for(var m=p||Date.now();this._writeBuffer.length>this._bufferOffset;){var h=this._writeBuffer[this._bufferOffset],v=this._action(h,_);if(v)return void v.catch(function(c){return o(function(){throw c}),Promise.resolve(!1)}).then(function(c){return Date.now()-m>=12?setTimeout(function(){return b._innerWrite(0,c)}):b._innerWrite(m,c)});var g=this._callbacks[this._bufferOffset];if(g&&g(),this._bufferOffset++,this._pendingData-=h.length,Date.now()-m>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(function(){return b._innerWrite()})):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0)},u}();t.WriteBuffer=a},5941:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;var o=/^([\da-f]{1})\/([\da-f]{1})\/([\da-f]{1})$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,a=/^[\da-f]+$/;function u(p,_){var b=p.toString(16),m=b.length<2?"0"+b:b;switch(_){case 4:return b[0];case 8:return m;case 12:return(m+m).slice(0,3);default:return m+m}}t.parseColor=function(p){if(p){var _=p.toLowerCase();if(_.indexOf("rgb:")===0){_=_.slice(4);var b=o.exec(_);if(b){var m=b[1]?15:b[4]?255:b[7]?4095:65535;return[Math.round(parseInt(b[1]||b[4]||b[7]||b[10],16)/m*255),Math.round(parseInt(b[2]||b[5]||b[8]||b[11],16)/m*255),Math.round(parseInt(b[3]||b[6]||b[9]||b[12],16)/m*255)]}}else if(_.indexOf("#")===0&&(_=_.slice(1),a.exec(_)&&[3,6,9,12].includes(_.length))){for(var h=_.length/3,v=[0,0,0],g=0;g<3;++g){var c=parseInt(_.slice(h*g,h*g+h),16);v[g]=h===1?c<<4:h===2?c:h===3?c>>4:c>>8}return v}}},t.toRgbString=function(p,_){_===void 0&&(_=16);var b=p[0],m=p[1],h=p[2];return"rgb:"+u(b,_)+"/"+u(m,_)+"/"+u(h,_)}},5770:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;var a=o(482),u=o(8742),p=o(5770),_=[],b=function(){function v(){this._handlers=Object.create(null),this._active=_,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return v.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=_},v.prototype.registerHandler=function(g,c){this._handlers[g]===void 0&&(this._handlers[g]=[]);var r=this._handlers[g];return r.push(c),{dispose:function(){var i=r.indexOf(c);i!==-1&&r.splice(i,1)}}},v.prototype.clearHandler=function(g){this._handlers[g]&&delete this._handlers[g]},v.prototype.setHandlerFallback=function(g){this._handlerFb=g},v.prototype.reset=function(){if(this._active.length)for(var g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].unhook(!1);this._stack.paused=!1,this._active=_,this._ident=0},v.prototype.hook=function(g,c){if(this.reset(),this._ident=g,this._active=this._handlers[g]||_,this._active.length)for(var r=this._active.length-1;r>=0;r--)this._active[r].hook(c);else this._handlerFb(this._ident,"HOOK",c)},v.prototype.put=function(g,c,r){if(this._active.length)for(var i=this._active.length-1;i>=0;i--)this._active[i].put(g,c,r);else this._handlerFb(this._ident,"PUT",(0,a.utf32ToString)(g,c,r))},v.prototype.unhook=function(g,c){if(c===void 0&&(c=!0),this._active.length){var r=!1,i=this._active.length-1,n=!1;if(this._stack.paused&&(i=this._stack.loopPosition-1,r=c,n=this._stack.fallThrough,this._stack.paused=!1),!n&&r===!1){for(;i>=0&&(r=this._active[i].unhook(g))!==!0;i--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!1,r;i--}for(;i>=0;i--)if((r=this._active[i].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!0,r}else this._handlerFb(this._ident,"UNHOOK",g);this._active=_,this._ident=0},v}();t.DcsParser=b;var m=new u.Params;m.addParam(0);var h=function(){function v(g){this._handler=g,this._data="",this._params=m,this._hitLimit=!1}return v.prototype.hook=function(g){this._params=g.length>1||g.params[0]?g.clone():m,this._data="",this._hitLimit=!1},v.prototype.put=function(g,c,r){this._hitLimit||(this._data+=(0,a.utf32ToString)(g,c,r),this._data.length>p.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},v.prototype.unhook=function(g){var c=this,r=!1;if(this._hitLimit)r=!1;else if(g&&(r=this._handler(this._data,this._params))instanceof Promise)return r.then(function(i){return c._params=m,c._data="",c._hitLimit=!1,i});return this._params=m,this._data="",this._hitLimit=!1,r},v}();t.DcsHandler=h},2015:function(l,t,o){var a,u=this&&this.__extends||(a=function(r,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,d){n.__proto__=d}||function(n,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(n[f]=d[f])},a(r,i)},function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=r}a(r,i),r.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;var p=o(844),_=o(8273),b=o(8742),m=o(6242),h=o(6351),v=function(){function r(i){this.table=new Uint8Array(i)}return r.prototype.setDefault=function(i,n){(0,_.fill)(this.table,i<<4|n)},r.prototype.add=function(i,n,d,f){this.table[n<<8|i]=d<<4|f},r.prototype.addMany=function(i,n,d,f){for(var y=0;y<i.length;y++)this.table[n<<8|i[y]]=d<<4|f},r}();t.TransitionTable=v;var g=160;t.VT500_TRANSITION_TABLE=function(){var r=new v(4095),i=Array.apply(null,Array(256)).map(function(E,L){return L}),n=function(E,L){return i.slice(E,L)},d=n(32,127),f=n(0,24);f.push(25),f.push.apply(f,n(28,32));var y,S=n(0,14);for(y in r.setDefault(1,0),r.addMany(d,0,2,0),S)r.addMany([24,26,153,154],y,3,0),r.addMany(n(128,144),y,3,0),r.addMany(n(144,152),y,3,0),r.add(156,y,0,0),r.add(27,y,11,1),r.add(157,y,4,8),r.addMany([152,158,159],y,0,7),r.add(155,y,11,3),r.add(144,y,11,9);return r.addMany(f,0,3,0),r.addMany(f,1,3,1),r.add(127,1,0,1),r.addMany(f,8,0,8),r.addMany(f,3,3,3),r.add(127,3,0,3),r.addMany(f,4,3,4),r.add(127,4,0,4),r.addMany(f,6,3,6),r.addMany(f,5,3,5),r.add(127,5,0,5),r.addMany(f,2,3,2),r.add(127,2,0,2),r.add(93,1,4,8),r.addMany(d,8,5,8),r.add(127,8,5,8),r.addMany([156,27,24,26,7],8,6,0),r.addMany(n(28,32),8,0,8),r.addMany([88,94,95],1,0,7),r.addMany(d,7,0,7),r.addMany(f,7,0,7),r.add(156,7,0,0),r.add(127,7,0,7),r.add(91,1,11,3),r.addMany(n(64,127),3,7,0),r.addMany(n(48,60),3,8,4),r.addMany([60,61,62,63],3,9,4),r.addMany(n(48,60),4,8,4),r.addMany(n(64,127),4,7,0),r.addMany([60,61,62,63],4,0,6),r.addMany(n(32,64),6,0,6),r.add(127,6,0,6),r.addMany(n(64,127),6,0,0),r.addMany(n(32,48),3,9,5),r.addMany(n(32,48),5,9,5),r.addMany(n(48,64),5,0,6),r.addMany(n(64,127),5,7,0),r.addMany(n(32,48),4,9,5),r.addMany(n(32,48),1,9,2),r.addMany(n(32,48),2,9,2),r.addMany(n(48,127),2,10,0),r.addMany(n(48,80),1,10,0),r.addMany(n(81,88),1,10,0),r.addMany([89,90,92],1,10,0),r.addMany(n(96,127),1,10,0),r.add(80,1,11,9),r.addMany(f,9,0,9),r.add(127,9,0,9),r.addMany(n(28,32),9,0,9),r.addMany(n(32,48),9,9,12),r.addMany(n(48,60),9,8,10),r.addMany([60,61,62,63],9,9,10),r.addMany(f,11,0,11),r.addMany(n(32,128),11,0,11),r.addMany(n(28,32),11,0,11),r.addMany(f,10,0,10),r.add(127,10,0,10),r.addMany(n(28,32),10,0,10),r.addMany(n(48,60),10,8,10),r.addMany([60,61,62,63],10,0,11),r.addMany(n(32,48),10,9,12),r.addMany(f,12,0,12),r.add(127,12,0,12),r.addMany(n(28,32),12,0,12),r.addMany(n(32,48),12,9,12),r.addMany(n(48,64),12,0,11),r.addMany(n(64,127),12,12,13),r.addMany(n(64,127),10,12,13),r.addMany(n(64,127),9,12,13),r.addMany(f,13,13,13),r.addMany(d,13,13,13),r.add(127,13,0,13),r.addMany([27,156,24,26],13,14,0),r.add(g,0,2,0),r.add(g,8,5,8),r.add(g,6,0,6),r.add(g,11,0,11),r.add(g,13,13,13),r}();var c=function(r){function i(n){n===void 0&&(n=t.VT500_TRANSITION_TABLE);var d=r.call(this)||this;return d._transitions=n,d._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},d.initialState=0,d.currentState=d.initialState,d._params=new b.Params,d._params.addParam(0),d._collect=0,d.precedingCodepoint=0,d._printHandlerFb=function(f,y,S){},d._executeHandlerFb=function(f){},d._csiHandlerFb=function(f,y){},d._escHandlerFb=function(f){},d._errorHandlerFb=function(f){return f},d._printHandler=d._printHandlerFb,d._executeHandlers=Object.create(null),d._csiHandlers=Object.create(null),d._escHandlers=Object.create(null),d._oscParser=new m.OscParser,d._dcsParser=new h.DcsParser,d._errorHandler=d._errorHandlerFb,d.registerEscHandler({final:"\\"},function(){return!0}),d}return u(i,r),i.prototype._identifier=function(n,d){d===void 0&&(d=[64,126]);var f=0;if(n.prefix){if(n.prefix.length>1)throw new Error("only one byte as prefix supported");if((f=n.prefix.charCodeAt(0))&&60>f||f>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(n.intermediates){if(n.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(var y=0;y<n.intermediates.length;++y){var S=n.intermediates.charCodeAt(y);if(32>S||S>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");f<<=8,f|=S}}if(n.final.length!==1)throw new Error("final must be a single byte");var E=n.final.charCodeAt(0);if(d[0]>E||E>d[1])throw new Error("final must be in range "+d[0]+" .. "+d[1]);return(f<<=8)|E},i.prototype.identToString=function(n){for(var d=[];n;)d.push(String.fromCharCode(255&n)),n>>=8;return d.reverse().join("")},i.prototype.dispose=function(){this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null),this._oscParser.dispose(),this._dcsParser.dispose()},i.prototype.setPrintHandler=function(n){this._printHandler=n},i.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},i.prototype.registerEscHandler=function(n,d){var f=this._identifier(n,[48,126]);this._escHandlers[f]===void 0&&(this._escHandlers[f]=[]);var y=this._escHandlers[f];return y.push(d),{dispose:function(){var S=y.indexOf(d);S!==-1&&y.splice(S,1)}}},i.prototype.clearEscHandler=function(n){this._escHandlers[this._identifier(n,[48,126])]&&delete this._escHandlers[this._identifier(n,[48,126])]},i.prototype.setEscHandlerFallback=function(n){this._escHandlerFb=n},i.prototype.setExecuteHandler=function(n,d){this._executeHandlers[n.charCodeAt(0)]=d},i.prototype.clearExecuteHandler=function(n){this._executeHandlers[n.charCodeAt(0)]&&delete this._executeHandlers[n.charCodeAt(0)]},i.prototype.setExecuteHandlerFallback=function(n){this._executeHandlerFb=n},i.prototype.registerCsiHandler=function(n,d){var f=this._identifier(n);this._csiHandlers[f]===void 0&&(this._csiHandlers[f]=[]);var y=this._csiHandlers[f];return y.push(d),{dispose:function(){var S=y.indexOf(d);S!==-1&&y.splice(S,1)}}},i.prototype.clearCsiHandler=function(n){this._csiHandlers[this._identifier(n)]&&delete this._csiHandlers[this._identifier(n)]},i.prototype.setCsiHandlerFallback=function(n){this._csiHandlerFb=n},i.prototype.registerDcsHandler=function(n,d){return this._dcsParser.registerHandler(this._identifier(n),d)},i.prototype.clearDcsHandler=function(n){this._dcsParser.clearHandler(this._identifier(n))},i.prototype.setDcsHandlerFallback=function(n){this._dcsParser.setHandlerFallback(n)},i.prototype.registerOscHandler=function(n,d){return this._oscParser.registerHandler(n,d)},i.prototype.clearOscHandler=function(n){this._oscParser.clearHandler(n)},i.prototype.setOscHandlerFallback=function(n){this._oscParser.setHandlerFallback(n)},i.prototype.setErrorHandler=function(n){this._errorHandler=n},i.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},i.prototype.reset=function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])},i.prototype._preserveStack=function(n,d,f,y,S){this._parseStack.state=n,this._parseStack.handlers=d,this._parseStack.handlerPos=f,this._parseStack.transition=y,this._parseStack.chunkPos=S},i.prototype.parse=function(n,d,f){var y,S=0,E=0,L=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,L=this._parseStack.chunkPos+1;else{if(f===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");var C=this._parseStack.handlers,w=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(f===!1&&w>-1){for(;w>=0&&(y=C[w](this._params))!==!0;w--)if(y instanceof Promise)return this._parseStack.handlerPos=w,y}this._parseStack.handlers=[];break;case 4:if(f===!1&&w>-1){for(;w>=0&&(y=C[w]())!==!0;w--)if(y instanceof Promise)return this._parseStack.handlerPos=w,y}this._parseStack.handlers=[];break;case 6:if(S=n[this._parseStack.chunkPos],y=this._dcsParser.unhook(S!==24&&S!==26,f))return y;S===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(S=n[this._parseStack.chunkPos],y=this._oscParser.end(S!==24&&S!==26,f))return y;S===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,L=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(var T=L;T<d;++T){switch(S=n[T],(E=this._transitions.table[this.currentState<<8|(S<160?S:g)])>>4){case 2:for(var A=T+1;;++A){if(A>=d||(S=n[A])<32||S>126&&S<g){this._printHandler(n,T,A),T=A-1;break}if(++A>=d||(S=n[A])<32||S>126&&S<g){this._printHandler(n,T,A),T=A-1;break}if(++A>=d||(S=n[A])<32||S>126&&S<g){this._printHandler(n,T,A),T=A-1;break}if(++A>=d||(S=n[A])<32||S>126&&S<g){this._printHandler(n,T,A),T=A-1;break}}break;case 3:this._executeHandlers[S]?this._executeHandlers[S]():this._executeHandlerFb(S),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:T,code:S,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var H=(C=this._csiHandlers[this._collect<<8|S])?C.length-1:-1;H>=0&&(y=C[H](this._params))!==!0;H--)if(y instanceof Promise)return this._preserveStack(3,C,H,E,T),y;H<0&&this._csiHandlerFb(this._collect<<8|S,this._params),this.precedingCodepoint=0;break;case 8:do switch(S){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(S-48)}while(++T<d&&(S=n[T])>47&&S<60);T--;break;case 9:this._collect<<=8,this._collect|=S;break;case 10:for(var O=this._escHandlers[this._collect<<8|S],k=O?O.length-1:-1;k>=0&&(y=O[k]())!==!0;k--)if(y instanceof Promise)return this._preserveStack(4,O,k,E,T),y;k<0&&this._escHandlerFb(this._collect<<8|S),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|S,this._params);break;case 13:for(var x=T+1;;++x)if(x>=d||(S=n[x])===24||S===26||S===27||S>127&&S<g){this._dcsParser.put(n,T,x),T=x-1;break}break;case 14:if(y=this._dcsParser.unhook(S!==24&&S!==26))return this._preserveStack(6,[],0,E,T),y;S===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(var D=T+1;;D++)if(D>=d||(S=n[D])<32||S>127&&S<g){this._oscParser.put(n,T,D),T=D-1;break}break;case 6:if(y=this._oscParser.end(S!==24&&S!==26))return this._preserveStack(5,[],0,E,T),y;S===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&E}},i}(p.Disposable);t.EscapeSequenceParser=c},6242:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;var a=o(5770),u=o(482),p=[],_=function(){function m(){this._state=0,this._active=p,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return m.prototype.registerHandler=function(h,v){this._handlers[h]===void 0&&(this._handlers[h]=[]);var g=this._handlers[h];return g.push(v),{dispose:function(){var c=g.indexOf(v);c!==-1&&g.splice(c,1)}}},m.prototype.clearHandler=function(h){this._handlers[h]&&delete this._handlers[h]},m.prototype.setHandlerFallback=function(h){this._handlerFb=h},m.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=p},m.prototype.reset=function(){if(this._state===2)for(var h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=p,this._id=-1,this._state=0},m.prototype._start=function(){if(this._active=this._handlers[this._id]||p,this._active.length)for(var h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")},m.prototype._put=function(h,v,g){if(this._active.length)for(var c=this._active.length-1;c>=0;c--)this._active[c].put(h,v,g);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(h,v,g))},m.prototype.start=function(){this.reset(),this._state=1},m.prototype.put=function(h,v,g){if(this._state!==3){if(this._state===1)for(;v<g;){var c=h[v++];if(c===59){this._state=2,this._start();break}if(c<48||57<c)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+c-48}this._state===2&&g-v>0&&this._put(h,v,g)}},m.prototype.end=function(h,v){if(v===void 0&&(v=!0),this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){var g=!1,c=this._active.length-1,r=!1;if(this._stack.paused&&(c=this._stack.loopPosition-1,g=v,r=this._stack.fallThrough,this._stack.paused=!1),!r&&g===!1){for(;c>=0&&(g=this._active[c].end(h))!==!0;c--)if(g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=c,this._stack.fallThrough=!1,g;c--}for(;c>=0;c--)if((g=this._active[c].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=c,this._stack.fallThrough=!0,g}else this._handlerFb(this._id,"END",h);this._active=p,this._id=-1,this._state=0}},m}();t.OscParser=_;var b=function(){function m(h){this._handler=h,this._data="",this._hitLimit=!1}return m.prototype.start=function(){this._data="",this._hitLimit=!1},m.prototype.put=function(h,v,g){this._hitLimit||(this._data+=(0,u.utf32ToString)(h,v,g),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},m.prototype.end=function(h){var v=this,g=!1;if(this._hitLimit)g=!1;else if(h&&(g=this._handler(this._data))instanceof Promise)return g.then(function(c){return v._data="",v._hitLimit=!1,c});return this._data="",this._hitLimit=!1,g},m}();t.OscHandler=b},8742:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;var o=2147483647,a=function(){function u(p,_){if(p===void 0&&(p=32),_===void 0&&(_=32),this.maxLength=p,this.maxSubParamsLength=_,_>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(p),this.length=0,this._subParams=new Int32Array(_),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(p),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return u.fromArray=function(p){var _=new u;if(!p.length)return _;for(var b=Array.isArray(p[0])?1:0;b<p.length;++b){var m=p[b];if(Array.isArray(m))for(var h=0;h<m.length;++h)_.addSubParam(m[h]);else _.addParam(m)}return _},u.prototype.clone=function(){var p=new u(this.maxLength,this.maxSubParamsLength);return p.params.set(this.params),p.length=this.length,p._subParams.set(this._subParams),p._subParamsLength=this._subParamsLength,p._subParamsIdx.set(this._subParamsIdx),p._rejectDigits=this._rejectDigits,p._rejectSubDigits=this._rejectSubDigits,p._digitIsSub=this._digitIsSub,p},u.prototype.toArray=function(){for(var p=[],_=0;_<this.length;++_){p.push(this.params[_]);var b=this._subParamsIdx[_]>>8,m=255&this._subParamsIdx[_];m-b>0&&p.push(Array.prototype.slice.call(this._subParams,b,m))}return p},u.prototype.reset=function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1},u.prototype.addParam=function(p){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(p<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=p>o?o:p}},u.prototype.addSubParam=function(p){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(p<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=p>o?o:p,this._subParamsIdx[this.length-1]++}},u.prototype.hasSubParams=function(p){return(255&this._subParamsIdx[p])-(this._subParamsIdx[p]>>8)>0},u.prototype.getSubParams=function(p){var _=this._subParamsIdx[p]>>8,b=255&this._subParamsIdx[p];return b-_>0?this._subParams.subarray(_,b):null},u.prototype.getSubParamsAll=function(){for(var p={},_=0;_<this.length;++_){var b=this._subParamsIdx[_]>>8,m=255&this._subParamsIdx[_];m-b>0&&(p[_]=this._subParams.slice(b,m))}return p},u.prototype.addDigit=function(p){var _;if(!(this._rejectDigits||!(_=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var b=this._digitIsSub?this._subParams:this.params,m=b[_-1];b[_-1]=~m?Math.min(10*m+p,o):p}},u}();t.Params=a},5741:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0;var o=function(){function a(){this._addons=[]}return a.prototype.dispose=function(){for(var u=this._addons.length-1;u>=0;u--)this._addons[u].instance.dispose()},a.prototype.loadAddon=function(u,p){var _=this,b={instance:p,dispose:p.dispose,isDisposed:!1};this._addons.push(b),p.dispose=function(){return _._wrappedAddonDispose(b)},p.activate(u)},a.prototype._wrappedAddonDispose=function(u){if(!u.isDisposed){for(var p=-1,_=0;_<this._addons.length;_++)if(this._addons[_]===u){p=_;break}if(p===-1)throw new Error("Could not dispose an addon that has not been loaded");u.isDisposed=!0,u.dispose.apply(u.instance),this._addons.splice(p,1)}},a}();t.AddonManager=o},8771:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;var a=o(3785),u=o(511),p=function(){function _(b,m){this._buffer=b,this.type=m}return _.prototype.init=function(b){return this._buffer=b,this},Object.defineProperty(_.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!1,configurable:!0}),_.prototype.getLine=function(b){var m=this._buffer.lines.get(b);if(m)return new a.BufferLineApiView(m)},_.prototype.getNullCell=function(){return new u.CellData},_}();t.BufferApiView=p},3785:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;var a=o(511),u=function(){function p(_){this._line=_}return Object.defineProperty(p.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"length",{get:function(){return this._line.length},enumerable:!1,configurable:!0}),p.prototype.getCell=function(_,b){if(!(_<0||_>=this._line.length))return b?(this._line.loadCell(_,b),b):this._line.loadCell(_,new a.CellData)},p.prototype.translateToString=function(_,b,m){return this._line.translateToString(_,b,m)},p}();t.BufferLineApiView=u},8285:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;var a=o(8771),u=o(8460),p=function(){function _(b){var m=this;this._core=b,this._onBufferChange=new u.EventEmitter,this._normal=new a.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new a.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(function(){return m._onBufferChange.fire(m.active)})}return Object.defineProperty(_.prototype,"onBufferChange",{get:function(){return this._onBufferChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"active",{get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"normal",{get:function(){return this._normal.init(this._core.buffers.normal)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"alternate",{get:function(){return this._alternate.init(this._core.buffers.alt)},enumerable:!1,configurable:!0}),_}();t.BufferNamespaceApi=p},7975:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0;var o=function(){function a(u){this._core=u}return a.prototype.registerCsiHandler=function(u,p){return this._core.registerCsiHandler(u,function(_){return p(_.toArray())})},a.prototype.addCsiHandler=function(u,p){return this.registerCsiHandler(u,p)},a.prototype.registerDcsHandler=function(u,p){return this._core.registerDcsHandler(u,function(_,b){return p(_,b.toArray())})},a.prototype.addDcsHandler=function(u,p){return this.registerDcsHandler(u,p)},a.prototype.registerEscHandler=function(u,p){return this._core.registerEscHandler(u,p)},a.prototype.addEscHandler=function(u,p){return this.registerEscHandler(u,p)},a.prototype.registerOscHandler=function(u,p){return this._core.registerOscHandler(u,p)},a.prototype.addOscHandler=function(u,p){return this.registerOscHandler(u,p)},a}();t.ParserApi=o},7090:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0;var o=function(){function a(u){this._core=u}return a.prototype.register=function(u){this._core.unicodeService.register(u)},Object.defineProperty(a.prototype,"versions",{get:function(){return this._core.unicodeService.versions},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"activeVersion",{get:function(){return this._core.unicodeService.activeVersion},set:function(u){this._core.unicodeService.activeVersion=u},enumerable:!1,configurable:!0}),a}();t.UnicodeApi=o},744:function(l,t,o){var a,u=this&&this.__extends||(a=function(c,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(i[d]=n[d])},a(c,r)},function(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=c}a(c,r),c.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}),p=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},_=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;var b=o(2585),m=o(5295),h=o(8460),v=o(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;var g=function(c){function r(i){var n=c.call(this)||this;return n._optionsService=i,n.isUserScrolling=!1,n._onResize=new h.EventEmitter,n._onScroll=new h.EventEmitter,n.cols=Math.max(i.rawOptions.cols||0,t.MINIMUM_COLS),n.rows=Math.max(i.rawOptions.rows||0,t.MINIMUM_ROWS),n.buffers=new m.BufferSet(i,n),n}return u(r,c),Object.defineProperty(r.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),r.prototype.dispose=function(){c.prototype.dispose.call(this),this.buffers.dispose()},r.prototype.resize=function(i,n){this.cols=i,this.rows=n,this.buffers.resize(i,n),this.buffers.setupTabStops(this.cols),this._onResize.fire({cols:i,rows:n})},r.prototype.reset=function(){this.buffers.reset(),this.isUserScrolling=!1},r.prototype.scroll=function(i,n){n===void 0&&(n=!1);var d,f=this.buffer;(d=this._cachedBlankLine)&&d.length===this.cols&&d.getFg(0)===i.fg&&d.getBg(0)===i.bg||(d=f.getBlankLine(i,n),this._cachedBlankLine=d),d.isWrapped=n;var y=f.ybase+f.scrollTop,S=f.ybase+f.scrollBottom;if(f.scrollTop===0){var E=f.lines.isFull;S===f.lines.length-1?E?f.lines.recycle().copyFrom(d):f.lines.push(d.clone()):f.lines.splice(S+1,0,d.clone()),E?this.isUserScrolling&&(f.ydisp=Math.max(f.ydisp-1,0)):(f.ybase++,this.isUserScrolling||f.ydisp++)}else{var L=S-y+1;f.lines.shiftElements(y+1,L-1,-1),f.lines.set(S,d.clone())}this.isUserScrolling||(f.ydisp=f.ybase),this._onScroll.fire(f.ydisp)},r.prototype.scrollLines=function(i,n,d){var f=this.buffer;if(i<0){if(f.ydisp===0)return;this.isUserScrolling=!0}else i+f.ydisp>=f.ybase&&(this.isUserScrolling=!1);var y=f.ydisp;f.ydisp=Math.max(Math.min(f.ydisp+i,f.ybase),0),y!==f.ydisp&&(n||this._onScroll.fire(f.ydisp))},r.prototype.scrollPages=function(i){this.scrollLines(i*(this.rows-1))},r.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},r.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},r.prototype.scrollToLine=function(i){var n=i-this.buffer.ydisp;n!==0&&this.scrollLines(n)},p([_(0,b.IOptionsService)],r)}(v.Disposable);t.BufferService=g},7994:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0;var o=function(){function a(){this.glevel=0,this._charsets=[]}return a.prototype.reset=function(){this.charset=void 0,this._charsets=[],this.glevel=0},a.prototype.setgLevel=function(u){this.glevel=u,this.charset=this._charsets[u]},a.prototype.setgCharset=function(u,p){this._charsets[u]=p,this.glevel===u&&(this.charset=p)},a}();t.CharsetService=o},1753:function(l,t,o){var a=this&&this.__decorate||function(c,r,i,n){var d,f=arguments.length,y=f<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(c,r,i,n);else for(var S=c.length-1;S>=0;S--)(d=c[S])&&(y=(f<3?d(y):f>3?d(r,i,y):d(r,i))||y);return f>3&&y&&Object.defineProperty(r,i,y),y},u=this&&this.__param||function(c,r){return function(i,n){r(i,n,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;var p=o(2585),_=o(8460),b={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(c){return c.button!==4&&c.action===1&&(c.ctrl=!1,c.alt=!1,c.shift=!1,!0)}},VT200:{events:19,restrict:function(c){return c.action!==32}},DRAG:{events:23,restrict:function(c){return c.action!==32||c.button!==3}},ANY:{events:31,restrict:function(c){return!0}}};function m(c,r){var i=(c.ctrl?16:0)|(c.shift?4:0)|(c.alt?8:0);return c.button===4?(i|=64,i|=c.action):(i|=3&c.button,4&c.button&&(i|=64),8&c.button&&(i|=128),c.action===32?i|=32:c.action!==0||r||(i|=3)),i}var h=String.fromCharCode,v={DEFAULT:function(c){var r=[m(c,!1)+32,c.col+32,c.row+32];return r[0]>255||r[1]>255||r[2]>255?"":"\x1B[M"+h(r[0])+h(r[1])+h(r[2])},SGR:function(c){var r=c.action===0&&c.button!==4?"m":"M";return"\x1B[<"+m(c,!0)+";"+c.col+";"+c.row+r}},g=function(){function c(r,i){this._bufferService=r,this._coreService=i,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._onProtocolChange=new _.EventEmitter,this._lastEvent=null;for(var n=0,d=Object.keys(b);n<d.length;n++){var f=d[n];this.addProtocol(f,b[f])}for(var y=0,S=Object.keys(v);y<S.length;y++){var E=S[y];this.addEncoding(E,v[E])}this.reset()}return c.prototype.addProtocol=function(r,i){this._protocols[r]=i},c.prototype.addEncoding=function(r,i){this._encodings[r]=i},Object.defineProperty(c.prototype,"activeProtocol",{get:function(){return this._activeProtocol},set:function(r){if(!this._protocols[r])throw new Error('unknown protocol "'+r+'"');this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"areMouseEventsActive",{get:function(){return this._protocols[this._activeProtocol].events!==0},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"activeEncoding",{get:function(){return this._activeEncoding},set:function(r){if(!this._encodings[r])throw new Error('unknown encoding "'+r+'"');this._activeEncoding=r},enumerable:!1,configurable:!0}),c.prototype.reset=function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null},Object.defineProperty(c.prototype,"onProtocolChange",{get:function(){return this._onProtocolChange.event},enumerable:!1,configurable:!0}),c.prototype.triggerMouseEvent=function(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||r.button===4&&r.action===32||r.button===3&&r.action!==32||r.button!==4&&(r.action===2||r.action===3)||(r.col++,r.row++,r.action===32&&this._lastEvent&&this._compareEvents(this._lastEvent,r))||!this._protocols[this._activeProtocol].restrict(r))return!1;var i=this._encodings[this._activeEncoding](r);return i&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(i):this._coreService.triggerDataEvent(i,!0)),this._lastEvent=r,!0},c.prototype.explainEvents=function(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}},c.prototype._compareEvents=function(r,i){return r.col===i.col&&r.row===i.row&&r.button===i.button&&r.action===i.action&&r.ctrl===i.ctrl&&r.alt===i.alt&&r.shift===i.shift},a([u(0,p.IBufferService),u(1,p.ICoreService)],c)}();t.CoreMouseService=g},6975:function(l,t,o){var a,u=this&&this.__extends||(a=function(i,n){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,f){d.__proto__=f}||function(d,f){for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(d[y]=f[y])},a(i,n)},function(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function d(){this.constructor=i}a(i,n),i.prototype=n===null?Object.create(n):(d.prototype=n.prototype,new d)}),p=this&&this.__decorate||function(i,n,d,f){var y,S=arguments.length,E=S<3?n:f===null?f=Object.getOwnPropertyDescriptor(n,d):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(i,n,d,f);else for(var L=i.length-1;L>=0;L--)(y=i[L])&&(E=(S<3?y(E):S>3?y(n,d,E):y(n,d))||E);return S>3&&E&&Object.defineProperty(n,d,E),E},_=this&&this.__param||function(i,n){return function(d,f){n(d,f,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;var b=o(2585),m=o(8460),h=o(1439),v=o(844),g=Object.freeze({insertMode:!1}),c=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),r=function(i){function n(d,f,y,S){var E=i.call(this)||this;return E._bufferService=f,E._logService=y,E._optionsService=S,E.isCursorInitialized=!1,E.isCursorHidden=!1,E._onData=E.register(new m.EventEmitter),E._onUserInput=E.register(new m.EventEmitter),E._onBinary=E.register(new m.EventEmitter),E._scrollToBottom=d,E.register({dispose:function(){return E._scrollToBottom=void 0}}),E.modes=(0,h.clone)(g),E.decPrivateModes=(0,h.clone)(c),E}return u(n,i),Object.defineProperty(n.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onUserInput",{get:function(){return this._onUserInput.event},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),n.prototype.reset=function(){this.modes=(0,h.clone)(g),this.decPrivateModes=(0,h.clone)(c)},n.prototype.triggerDataEvent=function(d,f){if(f===void 0&&(f=!1),!this._optionsService.rawOptions.disableStdin){var y=this._bufferService.buffer;y.ybase!==y.ydisp&&this._scrollToBottom(),f&&this._onUserInput.fire(),this._logService.debug('sending data "'+d+'"',function(){return d.split("").map(function(S){return S.charCodeAt(0)})}),this._onData.fire(d)}},n.prototype.triggerBinaryEvent=function(d){this._optionsService.rawOptions.disableStdin||(this._logService.debug('sending binary "'+d+'"',function(){return d.split("").map(function(f){return f.charCodeAt(0)})}),this._onBinary.fire(d))},p([_(1,b.IBufferService),_(2,b.ILogService),_(3,b.IOptionsService)],n)}(v.Disposable);t.CoreService=r},3730:function(l,t,o){var a=this&&this.__decorate||function(b,m,h,v){var g,c=arguments.length,r=c<3?m:v===null?v=Object.getOwnPropertyDescriptor(m,h):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(b,m,h,v);else for(var i=b.length-1;i>=0;i--)(g=b[i])&&(r=(c<3?g(r):c>3?g(m,h,r):g(m,h))||r);return c>3&&r&&Object.defineProperty(m,h,r),r},u=this&&this.__param||function(b,m){return function(h,v){m(h,v,b)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DirtyRowService=void 0;var p=o(2585),_=function(){function b(m){this._bufferService=m,this.clearRange()}return Object.defineProperty(b.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"end",{get:function(){return this._end},enumerable:!1,configurable:!0}),b.prototype.clearRange=function(){this._start=this._bufferService.buffer.y,this._end=this._bufferService.buffer.y},b.prototype.markDirty=function(m){m<this._start?this._start=m:m>this._end&&(this._end=m)},b.prototype.markRangeDirty=function(m,h){if(m>h){var v=m;m=h,h=v}m<this._start&&(this._start=m),h>this._end&&(this._end=h)},b.prototype.markAllDirty=function(){this.markRangeDirty(0,this._bufferService.rows-1)},a([u(0,p.IBufferService)],b)}();t.DirtyRowService=_},4348:function(l,t,o){var a=this&&this.__spreadArray||function(m,h,v){if(v||arguments.length===2)for(var g,c=0,r=h.length;c<r;c++)!g&&c in h||(g||(g=Array.prototype.slice.call(h,0,c)),g[c]=h[c]);return m.concat(g||Array.prototype.slice.call(h))};Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;var u=o(2585),p=o(8343),_=function(){function m(){for(var h=[],v=0;v<arguments.length;v++)h[v]=arguments[v];this._entries=new Map;for(var g=0,c=h;g<c.length;g++){var r=c[g],i=r[0],n=r[1];this.set(i,n)}}return m.prototype.set=function(h,v){var g=this._entries.get(h);return this._entries.set(h,v),g},m.prototype.forEach=function(h){this._entries.forEach(function(v,g){return h(g,v)})},m.prototype.has=function(h){return this._entries.has(h)},m.prototype.get=function(h){return this._entries.get(h)},m}();t.ServiceCollection=_;var b=function(){function m(){this._services=new _,this._services.set(u.IInstantiationService,this)}return m.prototype.setService=function(h,v){this._services.set(h,v)},m.prototype.getService=function(h){return this._services.get(h)},m.prototype.createInstance=function(h){for(var v=[],g=1;g<arguments.length;g++)v[g-1]=arguments[g];for(var c=(0,p.getServiceDependencies)(h).sort(function(S,E){return S.index-E.index}),r=[],i=0,n=c;i<n.length;i++){var d=n[i],f=this._services.get(d.id);if(!f)throw new Error("[createInstance] "+h.name+" depends on UNKNOWN service "+d.id+".");r.push(f)}var y=c.length>0?c[0].index:v.length;if(v.length!==y)throw new Error("[createInstance] First service dependency of "+h.name+" at position "+(y+1)+" conflicts with "+v.length+" static arguments");return new(h.bind.apply(h,a([void 0],a(a([],v,!0),r,!0),!1)))},m}();t.InstantiationService=b},7866:function(l,t,o){var a=this&&this.__decorate||function(h,v,g,c){var r,i=arguments.length,n=i<3?v:c===null?c=Object.getOwnPropertyDescriptor(v,g):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(h,v,g,c);else for(var d=h.length-1;d>=0;d--)(r=h[d])&&(n=(i<3?r(n):i>3?r(v,g,n):r(v,g))||n);return i>3&&n&&Object.defineProperty(v,g,n),n},u=this&&this.__param||function(h,v){return function(g,c){v(g,c,h)}},p=this&&this.__spreadArray||function(h,v,g){if(g||arguments.length===2)for(var c,r=0,i=v.length;r<i;r++)!c&&r in v||(c||(c=Array.prototype.slice.call(v,0,r)),c[r]=v[r]);return h.concat(c||Array.prototype.slice.call(v))};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;var _=o(2585),b={debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF},m=function(){function h(v){var g=this;this._optionsService=v,this.logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this._optionsService.onOptionChange(function(c){c==="logLevel"&&g._updateLogLevel()})}return h.prototype._updateLogLevel=function(){this.logLevel=b[this._optionsService.rawOptions.logLevel]},h.prototype._evalLazyOptionalParams=function(v){for(var g=0;g<v.length;g++)typeof v[g]=="function"&&(v[g]=v[g]())},h.prototype._log=function(v,g,c){this._evalLazyOptionalParams(c),v.call.apply(v,p([console,"xterm.js: "+g],c,!1))},h.prototype.debug=function(v){for(var g=[],c=1;c<arguments.length;c++)g[c-1]=arguments[c];this.logLevel<=_.LogLevelEnum.DEBUG&&this._log(console.log,v,g)},h.prototype.info=function(v){for(var g=[],c=1;c<arguments.length;c++)g[c-1]=arguments[c];this.logLevel<=_.LogLevelEnum.INFO&&this._log(console.info,v,g)},h.prototype.warn=function(v){for(var g=[],c=1;c<arguments.length;c++)g[c-1]=arguments[c];this.logLevel<=_.LogLevelEnum.WARN&&this._log(console.warn,v,g)},h.prototype.error=function(v){for(var g=[],c=1;c<arguments.length;c++)g[c-1]=arguments[c];this.logLevel<=_.LogLevelEnum.ERROR&&this._log(console.error,v,g)},a([u(0,_.IOptionsService)],h)}();t.LogService=m},7302:function(l,t,o){var a=this&&this.__assign||function(){return a=Object.assign||function(m){for(var h,v=1,g=arguments.length;v<g;v++)for(var c in h=arguments[v])Object.prototype.hasOwnProperty.call(h,c)&&(m[c]=h[c]);return m},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=t.DEFAULT_BELL_SOUND=void 0;var u=o(8460),p=o(6114);t.DEFAULT_BELL_SOUND="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjMyLjEwNAAAAAAAAAAAAAAA//tQxAADB8AhSmxhIIEVCSiJrDCQBTcu3UrAIwUdkRgQbFAZC1CQEwTJ9mjRvBA4UOLD8nKVOWfh+UlK3z/177OXrfOdKl7pyn3Xf//WreyTRUoAWgBgkOAGbZHBgG1OF6zM82DWbZaUmMBptgQhGjsyYqc9ae9XFz280948NMBWInljyzsNRFLPWdnZGWrddDsjK1unuSrVN9jJsK8KuQtQCtMBjCEtImISdNKJOopIpBFpNSMbIHCSRpRR5iakjTiyzLhchUUBwCgyKiweBv/7UsQbg8isVNoMPMjAAAA0gAAABEVFGmgqK////9bP/6XCykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,bellSound:t.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,linkTooltipHoverDuration:500,letterSpacing:0,logLevel:"info",scrollback:1e3,scrollSensitivity:1,screenReaderMode:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!0,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:p.isMac,rendererType:"canvas",windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1};var _=["normal","bold","100","200","300","400","500","600","700","800","900"],b=function(){function m(h){this._onOptionChange=new u.EventEmitter;var v=a({},t.DEFAULT_OPTIONS);for(var g in h)if(g in v)try{var c=h[g];v[g]=this._sanitizeAndValidateOption(g,c)}catch(r){console.error(r)}this.rawOptions=v,this.options=a({},v),this._setupOptions()}return Object.defineProperty(m.prototype,"onOptionChange",{get:function(){return this._onOptionChange.event},enumerable:!1,configurable:!0}),m.prototype._setupOptions=function(){var h=this,v=function(i){if(!(i in t.DEFAULT_OPTIONS))throw new Error('No option with key "'+i+'"');return h.rawOptions[i]},g=function(i,n){if(!(i in t.DEFAULT_OPTIONS))throw new Error('No option with key "'+i+'"');n=h._sanitizeAndValidateOption(i,n),h.rawOptions[i]!==n&&(h.rawOptions[i]=n,h._onOptionChange.fire(i))};for(var c in this.rawOptions){var r={get:v.bind(this,c),set:g.bind(this,c)};Object.defineProperty(this.options,c,r)}},m.prototype.setOption=function(h,v){this.options[h]=v},m.prototype._sanitizeAndValidateOption=function(h,v){switch(h){case"bellStyle":case"cursorStyle":case"rendererType":case"wordSeparator":v||(v=t.DEFAULT_OPTIONS[h]);break;case"fontWeight":case"fontWeightBold":if(typeof v=="number"&&1<=v&&v<=1e3)break;v=_.includes(v)?v:t.DEFAULT_OPTIONS[h];break;case"cursorWidth":v=Math.floor(v);case"lineHeight":case"tabStopWidth":if(v<1)throw new Error(h+" cannot be less than 1, value: "+v);break;case"minimumContrastRatio":v=Math.max(1,Math.min(21,Math.round(10*v)/10));break;case"scrollback":if((v=Math.min(v,4294967295))<0)throw new Error(h+" cannot be less than 0, value: "+v);break;case"fastScrollSensitivity":case"scrollSensitivity":if(v<=0)throw new Error(h+" cannot be less than or equal to 0, value: "+v);case"rows":case"cols":if(!v&&v!==0)throw new Error(h+" must be numeric, value: "+v)}return v},m.prototype.getOption=function(h){return this.options[h]},m}();t.OptionsService=b},8343:(l,t)=>{function o(a,u,p){u.di$target===u?u.di$dependencies.push({id:a,index:p}):(u.di$dependencies=[{id:a,index:p}],u.di$target=u)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(a){return a.di$dependencies||[]},t.createDecorator=function(a){if(t.serviceRegistry.has(a))return t.serviceRegistry.get(a);var u=function(p,_,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");o(u,p,b)};return u.toString=function(){return a},t.serviceRegistry.set(a,u),u}},2585:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IUnicodeService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.IDirtyRowService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var a,u=o(8343);t.IBufferService=(0,u.createDecorator)("BufferService"),t.ICoreMouseService=(0,u.createDecorator)("CoreMouseService"),t.ICoreService=(0,u.createDecorator)("CoreService"),t.ICharsetService=(0,u.createDecorator)("CharsetService"),t.IDirtyRowService=(0,u.createDecorator)("DirtyRowService"),t.IInstantiationService=(0,u.createDecorator)("InstantiationService"),(a=t.LogLevelEnum||(t.LogLevelEnum={}))[a.DEBUG=0]="DEBUG",a[a.INFO=1]="INFO",a[a.WARN=2]="WARN",a[a.ERROR=3]="ERROR",a[a.OFF=4]="OFF",t.ILogService=(0,u.createDecorator)("LogService"),t.IOptionsService=(0,u.createDecorator)("OptionsService"),t.IUnicodeService=(0,u.createDecorator)("UnicodeService")},1480:(l,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;var a=o(8460),u=o(225),p=function(){function _(){this._providers=Object.create(null),this._active="",this._onChange=new a.EventEmitter;var b=new u.UnicodeV6;this.register(b),this._active=b.version,this._activeProvider=b}return Object.defineProperty(_.prototype,"onChange",{get:function(){return this._onChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"versions",{get:function(){return Object.keys(this._providers)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"activeVersion",{get:function(){return this._active},set:function(b){if(!this._providers[b])throw new Error('unknown Unicode version "'+b+'"');this._active=b,this._activeProvider=this._providers[b],this._onChange.fire(b)},enumerable:!1,configurable:!0}),_.prototype.register=function(b){this._providers[b.version]=b},_.prototype.wcwidth=function(b){return this._activeProvider.wcwidth(b)},_.prototype.getStringCellWidth=function(b){for(var m=0,h=b.length,v=0;v<h;++v){var g=b.charCodeAt(v);if(55296<=g&&g<=56319){if(++v>=h)return m+this.wcwidth(g);var c=b.charCodeAt(v);56320<=c&&c<=57343?g=1024*(g-55296)+c-56320+65536:m+=this.wcwidth(c)}m+=this.wcwidth(g)}return m},_}();t.UnicodeService=p}},s={};return function l(t){var o=s[t];if(o!==void 0)return o.exports;var a=s[t]={exports:{}};return e[t].call(a.exports,a,a.exports,l),a.exports}(4389)})()})});var Qe=e=>typeof e=="function"?e:function(){return e},_n=typeof self!="undefined"?self:null,Ze=typeof window!="undefined"?window:null,et=_n||Ze||et,vn="2.0.0",be={connecting:0,open:1,closing:2,closed:3},gn=1e4,yn=1e3,ae={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},ke={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},Yi={longpoll:"longpoll",websocket:"websocket"},mn={complete:4},oi=class{constructor(e,s,l,t){this.channel=e,this.event=s,this.payload=l||function(){return{}},this.receivedResp=null,this.timeout=t,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,s){return this.hasReceived(e)&&s(this.receivedResp.response),this.recHooks.push({status:e,callback:s}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:s,_ref:l}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(s))}cancelRefEvent(){!this.refEvent||this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,s){this.channel.trigger(this.refEvent,{status:e,response:s})}},Sr=class{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}},bn=class{constructor(e,s,l){this.state=ae.closed,this.topic=e,this.params=Qe(s||{}),this.socket=l,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new oi(this,ke.join,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new Sr(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=ae.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(t=>t.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=ae.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=ae.closed,this.socket.remove(this)}),this.onError(t=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,t),this.isJoining()&&this.joinPush.reset(),this.state=ae.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new oi(this,ke.leave,Qe({}),this.timeout).send(),this.state=ae.errored,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(ke.reply,(t,o)=>{this.trigger(this.replyEventName(o),t)})}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(ke.close,e)}onError(e){return this.on(ke.error,s=>e(s))}on(e,s){let l=this.bindingRef++;return this.bindings.push({event:e,ref:l,callback:s}),l}off(e,s){this.bindings=this.bindings.filter(l=>!(l.event===e&&(typeof s=="undefined"||s===l.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,s,l=this.timeout){if(s=s||{},!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let t=new oi(this,e,function(){return s},l);return this.canPush()?t.send():(t.startTimeout(),this.pushBuffer.push(t)),t}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=ae.leaving;let s=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(ke.close,"leave")},l=new oi(this,ke.leave,Qe({}),e);return l.receive("ok",()=>s()).receive("timeout",()=>s()),l.send(),this.canPush()||l.trigger("ok",{}),l}onMessage(e,s,l){return s}isMember(e,s,l,t){return this.topic!==e?!1:t&&t!==this.joinRef()?(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:s,payload:l,joinRef:t}),!1):!0}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=ae.joining,this.joinPush.resend(e))}trigger(e,s,l,t){let o=this.onMessage(e,s,l,t);if(s&&!o)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let a=this.bindings.filter(u=>u.event===e);for(let u=0;u<a.length;u++)a[u].callback(o,l,t||this.joinRef())}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===ae.closed}isErrored(){return this.state===ae.errored}isJoined(){return this.state===ae.joined}isJoining(){return this.state===ae.joining}isLeaving(){return this.state===ae.leaving}},ci=class{static request(e,s,l,t,o,a,u){if(et.XDomainRequest){let p=new et.XDomainRequest;return this.xdomainRequest(p,e,s,t,o,a,u)}else{let p=new et.XMLHttpRequest;return this.xhrRequest(p,e,s,l,t,o,a,u)}}static xdomainRequest(e,s,l,t,o,a,u){return e.timeout=o,e.open(s,l),e.onload=()=>{let p=this.parseJSON(e.responseText);u&&u(p)},a&&(e.ontimeout=a),e.onprogress=()=>{},e.send(t),e}static xhrRequest(e,s,l,t,o,a,u,p){return e.open(s,l,!0),e.timeout=a,e.setRequestHeader("Content-Type",t),e.onerror=()=>p&&p(null),e.onreadystatechange=()=>{if(e.readyState===mn.complete&&p){let _=this.parseJSON(e.responseText);p(_)}},u&&(e.ontimeout=u),e.send(o),e}static parseJSON(e){if(!e||e==="")return null;try{return JSON.parse(e)}catch(s){return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,s){let l=[];for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;let o=s?`${s}[${t}]`:t,a=e[t];typeof a=="object"?l.push(this.serialize(a,o)):l.push(encodeURIComponent(o)+"="+encodeURIComponent(a))}return l.join("&")}static appendParams(e,s){if(Object.keys(s).length===0)return e;let l=e.match(/\?/)?"&":"?";return`${e}${l}${this.serialize(s)}`}},Gi=class{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=be.connecting,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+Yi.websocket),"$1/"+Yi.longpoll)}endpointURL(){return ci.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(e,s,l){this.close(e,s,l),this.readyState=be.connecting}ontimeout(){this.onerror("timeout"),this.closeAndRetry(1005,"timeout",!1)}isActive(){return this.readyState===be.open||this.readyState===be.connecting}poll(){this.ajax("GET",null,()=>this.ontimeout(),e=>{if(e){var{status:s,token:l,messages:t}=e;this.token=l}else s=0;switch(s){case 200:t.forEach(o=>{setTimeout(()=>this.onmessage({data:o}),0)}),this.poll();break;case 204:this.poll();break;case 410:this.readyState=be.open,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error(`unhandled poll status ${s}`)}})}send(e){this.ajax("POST",e,()=>this.onerror("timeout"),s=>{(!s||s.status!==200)&&(this.onerror(s&&s.status),this.closeAndRetry(1011,"internal server error",!1))})}close(e,s,l){for(let o of this.reqs)o.abort();this.readyState=be.closed;let t=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:e,reason:s,wasClean:l});typeof CloseEvent!="undefined"?this.onclose(new CloseEvent("close",t)):this.onclose(t)}ajax(e,s,l,t){let o,a=()=>{this.reqs.delete(o),l()};o=ci.request(e,this.endpointURL(),"application/json",s,this.timeout,a,u=>{this.reqs.delete(o),this.isActive()&&t(u)}),this.reqs.add(o)}};var ai={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(e,s){if(e.payload.constructor===ArrayBuffer)return s(this.binaryEncode(e));{let l=[e.join_ref,e.ref,e.topic,e.event,e.payload];return s(JSON.stringify(l))}},decode(e,s){if(e.constructor===ArrayBuffer)return s(this.binaryDecode(e));{let[l,t,o,a,u]=JSON.parse(e);return s({join_ref:l,ref:t,topic:o,event:a,payload:u})}},binaryEncode(e){let{join_ref:s,ref:l,event:t,topic:o,payload:a}=e,u=this.META_LENGTH+s.length+l.length+o.length+t.length,p=new ArrayBuffer(this.HEADER_LENGTH+u),_=new DataView(p),b=0;_.setUint8(b++,this.KINDS.push),_.setUint8(b++,s.length),_.setUint8(b++,l.length),_.setUint8(b++,o.length),_.setUint8(b++,t.length),Array.from(s,h=>_.setUint8(b++,h.charCodeAt(0))),Array.from(l,h=>_.setUint8(b++,h.charCodeAt(0))),Array.from(o,h=>_.setUint8(b++,h.charCodeAt(0))),Array.from(t,h=>_.setUint8(b++,h.charCodeAt(0)));var m=new Uint8Array(p.byteLength+a.byteLength);return m.set(new Uint8Array(p),0),m.set(new Uint8Array(a),p.byteLength),m.buffer},binaryDecode(e){let s=new DataView(e),l=s.getUint8(0),t=new TextDecoder;switch(l){case this.KINDS.push:return this.decodePush(e,s,t);case this.KINDS.reply:return this.decodeReply(e,s,t);case this.KINDS.broadcast:return this.decodeBroadcast(e,s,t)}},decodePush(e,s,l){let t=s.getUint8(1),o=s.getUint8(2),a=s.getUint8(3),u=this.HEADER_LENGTH+this.META_LENGTH-1,p=l.decode(e.slice(u,u+t));u=u+t;let _=l.decode(e.slice(u,u+o));u=u+o;let b=l.decode(e.slice(u,u+a));u=u+a;let m=e.slice(u,e.byteLength);return{join_ref:p,ref:null,topic:_,event:b,payload:m}},decodeReply(e,s,l){let t=s.getUint8(1),o=s.getUint8(2),a=s.getUint8(3),u=s.getUint8(4),p=this.HEADER_LENGTH+this.META_LENGTH,_=l.decode(e.slice(p,p+t));p=p+t;let b=l.decode(e.slice(p,p+o));p=p+o;let m=l.decode(e.slice(p,p+a));p=p+a;let h=l.decode(e.slice(p,p+u));p=p+u;let v=e.slice(p,e.byteLength),g={status:h,response:v};return{join_ref:_,ref:b,topic:m,event:ke.reply,payload:g}},decodeBroadcast(e,s,l){let t=s.getUint8(1),o=s.getUint8(2),a=this.HEADER_LENGTH+2,u=l.decode(e.slice(a,a+t));a=a+t;let p=l.decode(e.slice(a,a+o));a=a+o;let _=e.slice(a,e.byteLength);return{join_ref:null,ref:null,topic:u,event:p,payload:_}}},Cr=class{constructor(e,s={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=s.timeout||gn,this.transport=s.transport||et.WebSocket||Gi,this.establishedConnections=0,this.defaultEncoder=ai.encode.bind(ai),this.defaultDecoder=ai.decode.bind(ai),this.closeWasClean=!1,this.binaryType=s.binaryType||"arraybuffer",this.connectClock=1,this.transport!==Gi?(this.encode=s.encode||this.defaultEncoder,this.decode=s.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let l=null;Ze&&Ze.addEventListener&&(Ze.addEventListener("pagehide",t=>{this.conn&&(this.disconnect(),l=this.connectClock)}),Ze.addEventListener("pageshow",t=>{l===this.connectClock&&(l=null,this.connect())})),this.heartbeatIntervalMs=s.heartbeatIntervalMs||3e4,this.rejoinAfterMs=t=>s.rejoinAfterMs?s.rejoinAfterMs(t):[1e3,2e3,5e3][t-1]||1e4,this.reconnectAfterMs=t=>s.reconnectAfterMs?s.reconnectAfterMs(t):[10,50,100,150,200,250,500,1e3,2e3][t-1]||5e3,this.logger=s.logger||null,this.longpollerTimeout=s.longpollerTimeout||2e4,this.params=Qe(s.params||{}),this.endPoint=`${e}/${Yi.websocket}`,this.vsn=s.vsn||vn,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new Sr(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}getLongPollTransport(){return Gi}replaceTransport(e){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.sendBuffer=[],this.conn&&(this.conn.close(),this.conn=null),this.transport=e}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=ci.appendParams(ci.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return e.charAt(0)!=="/"?e:e.charAt(1)==="/"?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,s,l){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,s,l)}connect(e){e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=Qe(e)),!this.conn&&(this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=s=>this.onConnError(s),this.conn.onmessage=s=>this.onConnMessage(s),this.conn.onclose=s=>this.onConnClose(s))}log(e,s,l){this.logger(e,s,l)}hasLogger(){return this.logger!==null}onOpen(e){let s=this.makeRef();return this.stateChangeCallbacks.open.push([s,e]),s}onClose(e){let s=this.makeRef();return this.stateChangeCallbacks.close.push([s,e]),s}onError(e){let s=this.makeRef();return this.stateChangeCallbacks.error.push([s,e]),s}onMessage(e){let s=this.makeRef();return this.stateChangeCallbacks.message.push([s,e]),s}ping(e){if(!this.isConnected())return!1;let s=this.makeRef(),l=Date.now();this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:s});let t=this.onMessage(o=>{o.ref===s&&(this.off([t]),e(Date.now()-l))});return!0}onConnOpen(){this.hasLogger()&&this.log("transport",`connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,e])=>e())}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.abnormalClose("heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearTimeout(this.heartbeatTimer),setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(e,s,l){if(!this.conn)return e&&e();this.waitForBufferDone(()=>{this.conn&&(s?this.conn.close(s,l||""):this.conn.close()),this.waitForSocketClosed(()=>{this.conn&&(this.conn.onclose=function(){},this.conn=null),e&&e()})})}waitForBufferDone(e,s=1){if(s===5||!this.conn||!this.conn.bufferedAmount){e();return}setTimeout(()=>{this.waitForBufferDone(e,s+1)},150*s)}waitForSocketClosed(e,s=1){if(s===5||!this.conn||this.conn.readyState===be.closed){e();return}setTimeout(()=>{this.waitForSocketClosed(e,s+1)},150*s)}onConnClose(e){let s=e&&e.code;this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearTimeout(this.heartbeatTimer),!this.closeWasClean&&s!==1e3&&this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,l])=>l(e))}onConnError(e){this.hasLogger()&&this.log("transport",e);let s=this.transport,l=this.establishedConnections;this.stateChangeCallbacks.error.forEach(([,t])=>{t(e,s,l)}),(s===this.transport||l>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach(e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(ke.error)})}connectionState(){switch(this.conn&&this.conn.readyState){case be.connecting:return"connecting";case be.open:return"open";case be.closing:return"closing";default:return"closed"}}isConnected(){return this.connectionState()==="open"}remove(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter(s=>s.joinRef()!==e.joinRef())}off(e){for(let s in this.stateChangeCallbacks)this.stateChangeCallbacks[s]=this.stateChangeCallbacks[s].filter(([l])=>e.indexOf(l)===-1)}channel(e,s={}){let l=new bn(e,s,this);return this.channels.push(l),l}push(e){if(this.hasLogger()){let{topic:s,event:l,payload:t,ref:o,join_ref:a}=e;this.log("push",`${s} ${l} (${a}, ${o})`,t)}this.isConnected()?this.encode(e,s=>this.conn.send(s)):this.sendBuffer.push(()=>this.encode(e,s=>this.conn.send(s)))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimer=setTimeout(()=>this.heartbeatTimeout(),this.heartbeatIntervalMs))}abnormalClose(e){this.closeWasClean=!1,this.isConnected()&&this.conn.close(yn,e)}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,s=>{let{topic:l,event:t,payload:o,ref:a,join_ref:u}=s;a&&a===this.pendingHeartbeatRef&&(clearTimeout(this.heartbeatTimer),this.pendingHeartbeatRef=null,setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${o.status||""} ${l} ${t} ${a&&"("+a+")"||""}`,o);for(let p=0;p<this.channels.length;p++){let _=this.channels[p];!_.isMember(l,t,o,u)||_.trigger(t,o,a,u)}for(let p=0;p<this.stateChangeCallbacks.message.length;p++){let[,_]=this.stateChangeCallbacks.message[p];_(s)}})}leaveOpenTopic(e){let s=this.channels.find(l=>l.topic===e&&(l.isJoined()||l.isJoining()));s&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${e}"`),s.leave())}};var qr="consecutive-reloads",Sn=10,Cn=5e3,wn=1e4,Ln=3e4,zr=["phx-click-loading","phx-change-loading","phx-submit-loading","phx-keydown-loading","phx-keyup-loading","phx-blur-loading","phx-focus-loading"],le="data-phx-component",Zi="data-phx-link",En="track-static",kn="data-phx-link-state",Le="data-phx-ref",je="data-phx-ref-src",Kr="track-uploads",Fe="data-phx-upload-ref",fr="data-phx-preflighted-refs",An="data-phx-done-refs",wr="drop-target",or="data-phx-active-refs",ar="phx:live-file:updated",cr="data-phx-skip",Lr="data-phx-prune",Er="page-loading",kr="phx-connected",Qi="phx-loading",Ar="phx-no-feedback",xr="phx-error",ze="data-phx-parent-id",dr="data-phx-main",ct="data-phx-root-id",xn="trigger-action",lr="feedback-for",$r="phx-has-focused",Rn=["text","textarea","number","email","password","search","tel","url","date","time","datetime-local","color","range"],Vr=["checkbox","radio"],Jr="phx-has-submitted",Me="data-phx-session",Ke=`[${Me}]`,Rr="data-phx-sticky",ot="data-phx-static",er="data-phx-readonly",li="data-phx-disabled",hr="disable-with",hi="data-phx-disable-with-restore",tt="hook",Tn="debounce",Mn="throttle",ur="update",On="key",Se="phxPrivate",Tr="auto-recover",ui="phx:live-socket:debug",tr="phx:live-socket:profiling",ir="phx:live-socket:latency-sim",Dn="progress",Pn=1,Bn=200,In="phx-",Hn=3e4,it="debounce-trigger",fi="throttled",Mr="debounce-prev-key",jn={debounce:300,throttle:300},Or="d",Ce="s",ce="c",Dr="e",Pr="r",Br="t",Fn="p",Un=class{constructor(e,s,l){this.liveSocket=l,this.entry=e,this.offset=0,this.chunkSize=s,this.chunkTimer=null,this.uploadChannel=l.channel(`lvu:${e.ref}`,{token:e.metadata()})}error(e){clearTimeout(this.chunkTimer),this.uploadChannel.leave(),this.entry.error(e)}upload(){this.uploadChannel.onError(e=>this.error(e)),this.uploadChannel.join().receive("ok",e=>this.readNextChunk()).receive("error",e=>this.error(e))}isDone(){return this.offset>=this.entry.file.size}readNextChunk(){let e=new window.FileReader,s=this.entry.file.slice(this.offset,this.chunkSize+this.offset);e.onload=l=>{if(l.target.error===null)this.offset+=l.target.result.byteLength,this.pushChunk(l.target.result);else return re("Read error: "+l.target.error)},e.readAsArrayBuffer(s)}pushChunk(e){!this.uploadChannel.isJoined()||this.uploadChannel.push("chunk",e).receive("ok",()=>{this.entry.progress(this.offset/this.entry.file.size*100),this.isDone()||(this.chunkTimer=setTimeout(()=>this.readNextChunk(),this.liveSocket.getLatencySim()||0))})}},re=(e,s)=>console.error&&console.error(e,s),Te=e=>{let s=typeof e;return s==="number"||s==="string"&&/^(0|[1-9]\d*)$/.test(e)};function Nn(){let e=new Set,s=document.querySelectorAll("*[id]");for(let l=0,t=s.length;l<t;l++)e.has(s[l].id)?console.error(`Multiple IDs detected: ${s[l].id}. Ensure unique element ids.`):e.add(s[l].id)}var Wn=(e,s,l,t)=>{e.liveSocket.isDebugEnabled()&&console.log(`${e.id} ${s}: ${l} - `,t)},rr=e=>typeof e=="function"?e:function(){return e},gi=e=>JSON.parse(JSON.stringify(e)),at=(e,s,l)=>{do{if(e.matches(`[${s}]`))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1&&!(l&&l.isSameNode(e)||e.matches(Ke)));return null},rt=e=>e!==null&&typeof e=="object"&&!(e instanceof Array),qn=(e,s)=>JSON.stringify(e)===JSON.stringify(s),Ir=e=>{for(let s in e)return!1;return!0},Ae=(e,s)=>e&&s(e),zn=function(e,s,l,t){e.forEach(o=>{new Un(o,l.config.chunk_size,t).upload()})},Xr={canPushState(){return typeof history.pushState!="undefined"},dropLocal(e,s,l){return e.removeItem(this.localKey(s,l))},updateLocal(e,s,l,t,o){let a=this.getLocal(e,s,l),u=this.localKey(s,l),p=a===null?t:o(a);return e.setItem(u,JSON.stringify(p)),p},getLocal(e,s,l){return JSON.parse(e.getItem(this.localKey(s,l)))},updateCurrentState(e){!this.canPushState()||history.replaceState(e(history.state||{}),"",window.location.href)},pushState(e,s,l){if(this.canPushState()){if(l!==window.location.href){if(s.type=="redirect"&&s.scroll){let o=history.state||{};o.scroll=s.scroll,history.replaceState(o,"",window.location.href)}delete s.scroll,history[e+"State"](s,"",l||null);let t=this.getHashTargetEl(window.location.hash);t?t.scrollIntoView():s.type==="redirect"&&window.scroll(0,0)}}else this.redirect(l)},setCookie(e,s){document.cookie=`${e}=${s}`},getCookie(e){return document.cookie.replace(new RegExp(`(?:(?:^|.*;s*)${e}s*=s*([^;]*).*$)|^.*$`),"$1")},redirect(e,s){s&&Xr.setCookie("__phoenix_flash__",s+"; max-age=60000; path=/"),window.location=e},localKey(e,s){return`${e}-${s}`},getHashTargetEl(e){let s=e.toString().substring(1);if(s!=="")return document.getElementById(s)||document.querySelector(`a[name="${s}"]`)}},Re=Xr,pe={byId(e){return document.getElementById(e)||re(`no id found for ${e}`)},removeClass(e,s){e.classList.remove(s),e.classList.length===0&&e.removeAttribute("class")},all(e,s,l){if(!e)return[];let t=Array.from(e.querySelectorAll(s));return l?t.forEach(l):t},childNodeLength(e){let s=document.createElement("template");return s.innerHTML=e,s.content.childElementCount},isUploadInput(e){return e.type==="file"&&e.getAttribute(Fe)!==null},findUploadInputs(e){return this.all(e,`input[type="file"][${Fe}]`)},findComponentNodeList(e,s){return this.filterWithinSameLiveView(this.all(e,`[${le}="${s}"]`),e)},isPhxDestroyed(e){return!!(e.id&&pe.private(e,"destroyed"))},markPhxChildDestroyed(e){this.isPhxChild(e)&&e.setAttribute(Me,""),this.putPrivate(e,"destroyed",!0)},findPhxChildrenInFragment(e,s){let l=document.createElement("template");return l.innerHTML=e,this.findPhxChildren(l.content,s)},isIgnored(e,s){return(e.getAttribute(s)||e.getAttribute("data-phx-update"))==="ignore"},isPhxUpdate(e,s,l){return e.getAttribute&&l.indexOf(e.getAttribute(s))>=0},findPhxSticky(e){return this.all(e,`[${Rr}]`)},findPhxChildren(e,s){return this.all(e,`${Ke}[${ze}="${s}"]`)},findParentCIDs(e,s){let l=new Set(s);return s.reduce((t,o)=>{let a=`[${le}="${o}"] [${le}]`;return this.filterWithinSameLiveView(this.all(e,a),e).map(u=>parseInt(u.getAttribute(le))).forEach(u=>t.delete(u)),t},l)},filterWithinSameLiveView(e,s){return s.querySelector(Ke)?e.filter(l=>this.withinSameLiveView(l,s)):e},withinSameLiveView(e,s){for(;e=e.parentNode;){if(e.isSameNode(s))return!0;if(e.getAttribute(Me)!==null)return!1}},private(e,s){return e[Se]&&e[Se][s]},deletePrivate(e,s){e[Se]&&delete e[Se][s]},putPrivate(e,s,l){e[Se]||(e[Se]={}),e[Se][s]=l},updatePrivate(e,s,l,t){let o=this.private(e,s);o===void 0?this.putPrivate(e,s,t(l)):this.putPrivate(e,s,t(o))},copyPrivates(e,s){s[Se]&&(e[Se]=s[Se])},putTitle(e){let s=document.querySelector("title"),{prefix:l,suffix:t}=s.dataset;document.title=`${l||""}${e}${t||""}`},debounce(e,s,l,t,o,a,u,p){let _=e.getAttribute(l),b=e.getAttribute(o);_===""&&(_=t),b===""&&(b=a);let m=_||b;switch(m){case null:return p();case"blur":this.once(e,"debounce-blur")&&e.addEventListener("blur",()=>p());return;default:let h=parseInt(m),v=()=>b?this.deletePrivate(e,fi):p(),g=this.incCycle(e,it,v);if(isNaN(h))return re(`invalid throttle/debounce value: ${m}`);if(b){let r=!1;if(s.type==="keydown"){let i=this.private(e,Mr);this.putPrivate(e,Mr,s.key),r=i!==s.key}if(!r&&this.private(e,fi))return!1;p(),this.putPrivate(e,fi,!0),setTimeout(()=>{u()&&this.triggerCycle(e,it)},h)}else setTimeout(()=>{u()&&this.triggerCycle(e,it,g)},h);let c=e.form;c&&this.once(c,"bind-debounce")&&c.addEventListener("submit",()=>{Array.from(new FormData(c).entries(),([r])=>{let i=c.querySelector(`[name="${r}"]`);this.incCycle(i,it),this.deletePrivate(i,fi)})}),this.once(e,"bind-debounce")&&e.addEventListener("blur",()=>this.triggerCycle(e,it))}},triggerCycle(e,s,l){let[t,o]=this.private(e,s);l||(l=t),l===t&&(this.incCycle(e,s),o())},once(e,s){return this.private(e,s)===!0?!1:(this.putPrivate(e,s,!0),!0)},incCycle(e,s,l=function(){}){let[t]=this.private(e,s)||[0,l];return t++,this.putPrivate(e,s,[t,l]),t},discardError(e,s,l){let t=s.getAttribute&&s.getAttribute(l),o=t&&e.querySelector(`[id="${t}"], [name="${t}"]`);!o||this.private(o,$r)||this.private(o.form,Jr)||s.classList.add(Ar)},showError(e,s){(e.id||e.name)&&this.all(e.form,`[${s}="${e.id}"], [${s}="${e.name}"]`,l=>{this.removeClass(l,Ar)})},isPhxChild(e){return e.getAttribute&&e.getAttribute(ze)},isPhxSticky(e){return e.getAttribute&&e.getAttribute(Rr)!==null},firstPhxChild(e){return this.isPhxChild(e)?e:this.all(e,`[${ze}]`)[0]},dispatchEvent(e,s,l={}){let o={bubbles:l.bubbles===void 0?!0:!!l.bubbles,cancelable:!0,detail:l.detail||{}},a=s==="click"?new MouseEvent("click",o):new CustomEvent(s,o);e.dispatchEvent(a)},cloneNode(e,s){if(typeof s=="undefined")return e.cloneNode(!0);{let l=e.cloneNode(!1);return l.innerHTML=s,l}},mergeAttrs(e,s,l={}){let t=l.exclude||[],o=l.isIgnored,a=s.attributes;for(let p=a.length-1;p>=0;p--){let _=a[p].name;t.indexOf(_)<0&&e.setAttribute(_,s.getAttribute(_))}let u=e.attributes;for(let p=u.length-1;p>=0;p--){let _=u[p].name;o?_.startsWith("data-")&&!s.hasAttribute(_)&&e.removeAttribute(_):s.hasAttribute(_)||e.removeAttribute(_)}},mergeFocusedInput(e,s){e instanceof HTMLSelectElement||pe.mergeAttrs(e,s,{exclude:["value"]}),s.readOnly?e.setAttribute("readonly",!0):e.removeAttribute("readonly")},hasSelectionRange(e){return e.setSelectionRange&&(e.type==="text"||e.type==="textarea")},restoreFocus(e,s,l){if(!pe.isTextualInput(e))return;let t=e.matches(":focus");e.readOnly&&e.blur(),t||e.focus(),this.hasSelectionRange(e)&&e.setSelectionRange(s,l)},isFormInput(e){return/^(?:input|select|textarea)$/i.test(e.tagName)&&e.type!=="button"},syncAttrsToProps(e){e instanceof HTMLInputElement&&Vr.indexOf(e.type.toLocaleLowerCase())>=0&&(e.checked=e.getAttribute("checked")!==null)},isTextualInput(e){return Rn.indexOf(e.type)>=0},isNowTriggerFormExternal(e,s){return e.getAttribute&&e.getAttribute(s)!==null},syncPendingRef(e,s,l){let t=e.getAttribute(Le);if(t===null)return!0;let o=e.getAttribute(je);return pe.isFormInput(e)||e.getAttribute(l)!==null?(pe.isUploadInput(e)&&pe.mergeAttrs(e,s,{isIgnored:!0}),pe.putPrivate(e,Le,s),!1):(zr.forEach(a=>{e.classList.contains(a)&&s.classList.add(a)}),s.setAttribute(Le,t),s.setAttribute(je,o),!0)},cleanChildNodes(e,s){if(pe.isPhxUpdate(e,s,["append","prepend"])){let l=[];e.childNodes.forEach(t=>{t.id||(t.nodeType===Node.TEXT_NODE&&t.nodeValue.trim()===""||re(`only HTML element tags with an id are allowed inside containers with phx-update.

removing illegal node: "${(t.outerHTML||t.nodeValue).trim()}"

`),l.push(t))}),l.forEach(t=>t.remove())}},replaceRootContainer(e,s,l){let t=new Set(["id",Me,ot,dr,ct]);if(e.tagName.toLowerCase()===s.toLowerCase())return Array.from(e.attributes).filter(o=>!t.has(o.name.toLowerCase())).forEach(o=>e.removeAttribute(o.name)),Object.keys(l).filter(o=>!t.has(o.toLowerCase())).forEach(o=>e.setAttribute(o,l[o])),e;{let o=document.createElement(s);return Object.keys(l).forEach(a=>o.setAttribute(a,l[a])),t.forEach(a=>o.setAttribute(a,e.getAttribute(a))),o.innerHTML=e.innerHTML,e.replaceWith(o),o}},getSticky(e,s,l){let t=(pe.private(e,"sticky")||[]).find(([o])=>s===o);if(t){let[o,a,u]=t;return u}else return typeof l=="function"?l():l},deleteSticky(e,s){this.updatePrivate(e,"sticky",[],l=>l.filter(([t,o])=>t!==s))},putSticky(e,s,l){let t=l(e);this.updatePrivate(e,"sticky",[],o=>{let a=o.findIndex(([u])=>s===u);return a>=0?o[a]=[s,l,t]:o.push([s,l,t]),o})},applyStickyOperations(e){let s=pe.private(e,"sticky");!s||s.forEach(([l,t,o])=>this.putSticky(e,l,t))}},q=pe,nr=class{static isActive(e,s){let l=s._phxRef===void 0,o=e.getAttribute(or).split(",").indexOf(ie.genFileRef(s))>=0;return s.size>0&&(l||o)}static isPreflighted(e,s){return e.getAttribute(fr).split(",").indexOf(ie.genFileRef(s))>=0&&this.isActive(e,s)}constructor(e,s,l){this.ref=ie.genFileRef(s),this.fileEl=e,this.file=s,this.view=l,this.meta=null,this._isCancelled=!1,this._isDone=!1,this._progress=0,this._lastProgressSent=-1,this._onDone=function(){},this._onElUpdated=this.onElUpdated.bind(this),this.fileEl.addEventListener(ar,this._onElUpdated)}metadata(){return this.meta}progress(e){this._progress=Math.floor(e),this._progress>this._lastProgressSent&&(this._progress>=100?(this._progress=100,this._lastProgressSent=100,this._isDone=!0,this.view.pushFileProgress(this.fileEl,this.ref,100,()=>{ie.untrackFile(this.fileEl,this.file),this._onDone()})):(this._lastProgressSent=this._progress,this.view.pushFileProgress(this.fileEl,this.ref,this._progress)))}cancel(){this._isCancelled=!0,this._isDone=!0,this._onDone()}isDone(){return this._isDone}error(e="failed"){this.view.pushFileProgress(this.fileEl,this.ref,{error:e}),ie.clearFiles(this.fileEl)}onDone(e){this._onDone=()=>{this.fileEl.removeEventListener(ar,this._onElUpdated),e()}}onElUpdated(){this.fileEl.getAttribute(or).split(",").indexOf(this.ref)===-1&&this.cancel()}toPreflightPayload(){return{last_modified:this.file.lastModified,name:this.file.name,size:this.file.size,type:this.file.type,ref:this.ref}}uploader(e){if(this.meta.uploader){let s=e[this.meta.uploader]||re(`no uploader configured for ${this.meta.uploader}`);return{name:this.meta.uploader,callback:s}}else return{name:"channel",callback:zn}}zipPostFlight(e){this.meta=e.entries[this.ref],this.meta||re(`no preflight upload response returned with ref ${this.ref}`,{input:this.fileEl,response:e})}},Kn=0,ie=class{static genFileRef(e){let s=e._phxRef;return s!==void 0?s:(e._phxRef=(Kn++).toString(),e._phxRef)}static getEntryDataURL(e,s,l){let t=this.activeFiles(e).find(o=>this.genFileRef(o)===s);l(URL.createObjectURL(t))}static hasUploadsInProgress(e){let s=0;return q.findUploadInputs(e).forEach(l=>{l.getAttribute(fr)!==l.getAttribute(An)&&s++}),s>0}static serializeUploads(e){let s=this.activeFiles(e),l={};return s.forEach(t=>{let o={path:e.name},a=e.getAttribute(Fe);l[a]=l[a]||[],o.ref=this.genFileRef(t),o.name=t.name||o.ref,o.type=t.type,o.size=t.size,l[a].push(o)}),l}static clearFiles(e){e.value=null,e.removeAttribute(Fe),q.putPrivate(e,"files",[])}static untrackFile(e,s){q.putPrivate(e,"files",q.private(e,"files").filter(l=>!Object.is(l,s)))}static trackFiles(e,s){if(e.getAttribute("multiple")!==null){let l=s.filter(t=>!this.activeFiles(e).find(o=>Object.is(o,t)));q.putPrivate(e,"files",this.activeFiles(e).concat(l)),e.value=null}else q.putPrivate(e,"files",s)}static activeFileInputs(e){let s=q.findUploadInputs(e);return Array.from(s).filter(l=>l.files&&this.activeFiles(l).length>0)}static activeFiles(e){return(q.private(e,"files")||[]).filter(s=>nr.isActive(e,s))}static inputsAwaitingPreflight(e){let s=q.findUploadInputs(e);return Array.from(s).filter(l=>this.filesAwaitingPreflight(l).length>0)}static filesAwaitingPreflight(e){return this.activeFiles(e).filter(s=>!nr.isPreflighted(e,s))}constructor(e,s,l){this.view=s,this.onComplete=l,this._entries=Array.from(ie.filesAwaitingPreflight(e)||[]).map(t=>new nr(e,t,s)),this.numEntriesInProgress=this._entries.length}entries(){return this._entries}initAdapterUpload(e,s,l){this._entries=this._entries.map(o=>(o.zipPostFlight(e),o.onDone(()=>{this.numEntriesInProgress--,this.numEntriesInProgress===0&&this.onComplete()}),o));let t=this._entries.reduce((o,a)=>{let{name:u,callback:p}=a.uploader(l.uploaders);return o[u]=o[u]||{callback:p,entries:[]},o[u].entries.push(a),o},{});for(let o in t){let{callback:a,entries:u}=t[o];a(u,s,e,l)}}},$n={LiveFileUpload:{activeRefs(){return this.el.getAttribute(or)},preflightedRefs(){return this.el.getAttribute(fr)},mounted(){this.preflightedWas=this.preflightedRefs()},updated(){let e=this.preflightedRefs();this.preflightedWas!==e&&(this.preflightedWas=e,e===""&&this.__view.cancelSubmit(this.el.form)),this.activeRefs()===""&&(this.el.value=null),this.el.dispatchEvent(new CustomEvent(ar))}},LiveImgPreview:{mounted(){this.ref=this.el.getAttribute("data-phx-entry-ref"),this.inputEl=document.getElementById(this.el.getAttribute(Fe)),ie.getEntryDataURL(this.inputEl,this.ref,e=>{this.url=e,this.el.src=e})},destroyed(){URL.revokeObjectURL(this.url)}}},Vn=$n,Jn=class{constructor(e,s,l){let t=new Set,o=new Set([...s.children].map(u=>u.id)),a=[];Array.from(e.children).forEach(u=>{if(u.id&&(t.add(u.id),o.has(u.id))){let p=u.previousElementSibling&&u.previousElementSibling.id;a.push({elementId:u.id,previousElementId:p})}}),this.containerId=s.id,this.updateType=l,this.elementsToModify=a,this.elementIdsToAdd=[...o].filter(u=>!t.has(u))}perform(){let e=q.byId(this.containerId);this.elementsToModify.forEach(s=>{s.previousElementId?Ae(document.getElementById(s.previousElementId),l=>{Ae(document.getElementById(s.elementId),t=>{t.previousElementSibling&&t.previousElementSibling.id==l.id||l.insertAdjacentElement("afterend",t)})}):Ae(document.getElementById(s.elementId),l=>{l.previousElementSibling==null||e.insertAdjacentElement("afterbegin",l)})}),this.updateType=="prepend"&&this.elementIdsToAdd.reverse().forEach(s=>{Ae(document.getElementById(s),l=>e.insertAdjacentElement("afterbegin",l))})}},Hr=11;function Xn(e,s){var l=s.attributes,t,o,a,u,p;if(!(s.nodeType===Hr||e.nodeType===Hr)){for(var _=l.length-1;_>=0;_--)t=l[_],o=t.name,a=t.namespaceURI,u=t.value,a?(o=t.localName||o,p=e.getAttributeNS(a,o),p!==u&&(t.prefix==="xmlns"&&(o=t.name),e.setAttributeNS(a,o,u))):(p=e.getAttribute(o),p!==u&&e.setAttribute(o,u));for(var b=e.attributes,m=b.length-1;m>=0;m--)t=b[m],o=t.name,a=t.namespaceURI,a?(o=t.localName||o,s.hasAttributeNS(a,o)||e.removeAttributeNS(a,o)):s.hasAttribute(o)||e.removeAttribute(o)}}var di,Gn="http://www.w3.org/1999/xhtml",se=typeof document=="undefined"?void 0:document,Yn=!!se&&"content"in se.createElement("template"),Zn=!!se&&se.createRange&&"createContextualFragment"in se.createRange();function Qn(e){var s=se.createElement("template");return s.innerHTML=e,s.content.childNodes[0]}function es(e){di||(di=se.createRange(),di.selectNode(se.body));var s=di.createContextualFragment(e);return s.childNodes[0]}function ts(e){var s=se.createElement("body");return s.innerHTML=e,s.childNodes[0]}function is(e){return e=e.trim(),Yn?Qn(e):Zn?es(e):ts(e)}function pi(e,s){var l=e.nodeName,t=s.nodeName,o,a;return l===t?!0:(o=l.charCodeAt(0),a=t.charCodeAt(0),o<=90&&a>=97?l===t.toUpperCase():a<=90&&o>=97?t===l.toUpperCase():!1)}function rs(e,s){return!s||s===Gn?se.createElement(e):se.createElementNS(s,e)}function ns(e,s){for(var l=e.firstChild;l;){var t=l.nextSibling;s.appendChild(l),l=t}return s}function sr(e,s,l){e[l]!==s[l]&&(e[l]=s[l],e[l]?e.setAttribute(l,""):e.removeAttribute(l))}var jr={OPTION:function(e,s){var l=e.parentNode;if(l){var t=l.nodeName.toUpperCase();t==="OPTGROUP"&&(l=l.parentNode,t=l&&l.nodeName.toUpperCase()),t==="SELECT"&&!l.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!s.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),l.selectedIndex=-1)}sr(e,s,"selected")},INPUT:function(e,s){sr(e,s,"checked"),sr(e,s,"disabled"),e.value!==s.value&&(e.value=s.value),s.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,s){var l=s.value;e.value!==l&&(e.value=l);var t=e.firstChild;if(t){var o=t.nodeValue;if(o==l||!l&&o==e.placeholder)return;t.nodeValue=l}},SELECT:function(e,s){if(!s.hasAttribute("multiple")){for(var l=-1,t=0,o=e.firstChild,a,u;o;)if(u=o.nodeName&&o.nodeName.toUpperCase(),u==="OPTGROUP")a=o,o=a.firstChild;else{if(u==="OPTION"){if(o.hasAttribute("selected")){l=t;break}t++}o=o.nextSibling,!o&&a&&(o=a.nextSibling,a=null)}e.selectedIndex=l}}},nt=1,ss=11,Fr=3,Ur=8;function He(){}function os(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function as(e){return function(l,t,o){if(o||(o={}),typeof t=="string")if(l.nodeName==="#document"||l.nodeName==="HTML"||l.nodeName==="BODY"){var a=t;t=se.createElement("html"),t.innerHTML=a}else t=is(t);var u=o.getNodeKey||os,p=o.onBeforeNodeAdded||He,_=o.onNodeAdded||He,b=o.onBeforeElUpdated||He,m=o.onElUpdated||He,h=o.onBeforeNodeDiscarded||He,v=o.onNodeDiscarded||He,g=o.onBeforeElChildrenUpdated||He,c=o.childrenOnly===!0,r=Object.create(null),i=[];function n(x){i.push(x)}function d(x,D){if(x.nodeType===nt)for(var I=x.firstChild;I;){var F=void 0;D&&(F=u(I))?n(F):(v(I),I.firstChild&&d(I,D)),I=I.nextSibling}}function f(x,D,I){h(x)!==!1&&(D&&D.removeChild(x),v(x),d(x,I))}function y(x){if(x.nodeType===nt||x.nodeType===ss)for(var D=x.firstChild;D;){var I=u(D);I&&(r[I]=D),y(D),D=D.nextSibling}}y(l);function S(x){_(x);for(var D=x.firstChild;D;){var I=D.nextSibling,F=u(D);if(F){var W=r[F];W&&pi(D,W)?(D.parentNode.replaceChild(W,D),L(W,D)):S(D)}else S(D);D=I}}function E(x,D,I){for(;D;){var F=D.nextSibling;(I=u(D))?n(I):f(D,x,!0),D=F}}function L(x,D,I){var F=u(D);F&&delete r[F],!(!I&&(b(x,D)===!1||(e(x,D),m(x),g(x,D)===!1)))&&(x.nodeName!=="TEXTAREA"?C(x,D):jr.TEXTAREA(x,D))}function C(x,D){var I=D.firstChild,F=x.firstChild,W,J,$,G,R;e:for(;I;){for(G=I.nextSibling,W=u(I);F;){if($=F.nextSibling,I.isSameNode&&I.isSameNode(F)){I=G,F=$;continue e}J=u(F);var N=F.nodeType,P=void 0;if(N===I.nodeType&&(N===nt?(W?W!==J&&((R=r[W])?$===R?P=!1:(x.insertBefore(R,F),J?n(J):f(F,x,!0),F=R):P=!1):J&&(P=!1),P=P!==!1&&pi(F,I),P&&L(F,I)):(N===Fr||N==Ur)&&(P=!0,F.nodeValue!==I.nodeValue&&(F.nodeValue=I.nodeValue))),P){I=G,F=$;continue e}J?n(J):f(F,x,!0),F=$}if(W&&(R=r[W])&&pi(R,I))x.appendChild(R),L(R,I);else{var B=p(I);B!==!1&&(B&&(I=B),I.actualize&&(I=I.actualize(x.ownerDocument||se)),x.appendChild(I),S(I))}I=G,F=$}E(x,F,J);var M=jr[x.nodeName];M&&M(x,D)}var w=l,T=w.nodeType,A=t.nodeType;if(!c){if(T===nt)A===nt?pi(l,t)||(v(l),w=ns(l,rs(t.nodeName,t.namespaceURI))):w=t;else if(T===Fr||T===Ur){if(A===T)return w.nodeValue!==t.nodeValue&&(w.nodeValue=t.nodeValue),w;w=t}}if(w===t)v(l);else{if(t.isSameNode&&t.isSameNode(w))return;if(L(w,t,c),i)for(var H=0,O=i.length;H<O;H++){var k=r[i[H]];k&&f(k,k.parentNode,!1)}}return!c&&w!==l&&l.parentNode&&(w.actualize&&(w=w.actualize(l.ownerDocument||se)),l.parentNode.replaceChild(w,l)),w}}var cs=as(Xn),Nr=cs,_i=class{static patchEl(e,s,l){Nr(e,s,{childrenOnly:!1,onBeforeElUpdated:(t,o)=>{if(l&&l.isSameNode(t)&&q.isFormInput(t))return q.mergeFocusedInput(t,o),!1}})}constructor(e,s,l,t,o){this.view=e,this.liveSocket=e.liveSocket,this.container=s,this.id=l,this.rootID=e.root.id,this.html=t,this.targetCID=o,this.cidPatch=Te(this.targetCID),this.callbacks={beforeadded:[],beforeupdated:[],beforephxChildAdded:[],afteradded:[],afterupdated:[],afterdiscarded:[],afterphxChildAdded:[],aftertransitionsDiscarded:[]}}before(e,s){this.callbacks[`before${e}`].push(s)}after(e,s){this.callbacks[`after${e}`].push(s)}trackBefore(e,...s){this.callbacks[`before${e}`].forEach(l=>l(...s))}trackAfter(e,...s){this.callbacks[`after${e}`].forEach(l=>l(...s))}markPrunableContentForRemoval(){q.all(this.container,"[phx-update=append] > *, [phx-update=prepend] > *",e=>{e.setAttribute(Lr,"")})}perform(){let{view:e,liveSocket:s,container:l,html:t}=this,o=this.isCIDPatch()?this.targetCIDContainer(t):l;if(this.isCIDPatch()&&!o)return;let a=s.getActiveElement(),{selectionStart:u,selectionEnd:p}=a&&q.hasSelectionRange(a)?a:{},_=s.binding(ur),b=s.binding(lr),m=s.binding(hr),h=s.binding(xn),v=s.binding("remove"),g=[],c=[],r=[],i=[],n=null,d=s.time("premorph container prep",()=>this.buildDiffHTML(l,t,_,o));return this.trackBefore("added",l),this.trackBefore("updated",l,l),s.time("morphdom",()=>{Nr(o,d,{childrenOnly:o.getAttribute(le)===null,getNodeKey:f=>q.isPhxDestroyed(f)?null:f.id,onBeforeNodeAdded:f=>(this.trackBefore("added",f),f),onNodeAdded:f=>{f instanceof HTMLImageElement&&f.srcset?f.srcset=f.srcset:f instanceof HTMLVideoElement&&f.autoplay&&f.play(),q.isNowTriggerFormExternal(f,h)&&(n=f),q.discardError(o,f,b),(q.isPhxChild(f)&&e.ownsElement(f)||q.isPhxSticky(f)&&e.ownsElement(f.parentNode))&&this.trackAfter("phxChildAdded",f),g.push(f)},onNodeDiscarded:f=>{(q.isPhxChild(f)||q.isPhxSticky(f))&&s.destroyViewByEl(f),this.trackAfter("discarded",f)},onBeforeNodeDiscarded:f=>f.getAttribute&&f.getAttribute(Lr)!==null?!0:f.parentNode!==null&&q.isPhxUpdate(f.parentNode,_,["append","prepend"])&&f.id?!1:f.getAttribute&&f.getAttribute(v)?(i.push(f),!1):!this.skipCIDSibling(f),onElUpdated:f=>{q.isNowTriggerFormExternal(f,h)&&(n=f),c.push(f)},onBeforeElUpdated:(f,y)=>{if(q.cleanChildNodes(y,_),this.skipCIDSibling(y)||q.isPhxSticky(f))return!1;if(q.isIgnored(f,_))return this.trackBefore("updated",f,y),q.mergeAttrs(f,y,{isIgnored:!0}),c.push(f),q.applyStickyOperations(f),!1;if(f.type==="number"&&f.validity&&f.validity.badInput)return!1;if(!q.syncPendingRef(f,y,m))return q.isUploadInput(f)&&(this.trackBefore("updated",f,y),c.push(f)),q.applyStickyOperations(f),!1;if(q.isPhxChild(y)){let E=f.getAttribute(Me);return q.mergeAttrs(f,y,{exclude:[ot]}),E!==""&&f.setAttribute(Me,E),f.setAttribute(ct,this.rootID),q.applyStickyOperations(f),!1}return q.copyPrivates(y,f),q.discardError(o,y,b),a&&f.isSameNode(a)&&q.isFormInput(f)?(this.trackBefore("updated",f,y),q.mergeFocusedInput(f,y),q.syncAttrsToProps(f),c.push(f),q.applyStickyOperations(f),!1):(q.isPhxUpdate(y,_,["append","prepend"])&&r.push(new Jn(f,y,y.getAttribute(_))),q.syncAttrsToProps(y),q.applyStickyOperations(y),this.trackBefore("updated",f,y),!0)}})}),s.isDebugEnabled()&&Nn(),r.length>0&&s.time("post-morph append/prepend restoration",()=>{r.forEach(f=>f.perform())}),s.silenceEvents(()=>q.restoreFocus(a,u,p)),q.dispatchEvent(document,"phx:update"),g.forEach(f=>this.trackAfter("added",f)),c.forEach(f=>this.trackAfter("updated",f)),i.length>0&&(s.transitionRemoves(i),s.requestDOMUpdate(()=>{i.forEach(f=>{let y=q.firstPhxChild(f);y&&s.destroyViewByEl(y),f.remove()}),this.trackAfter("transitionsDiscarded",i)})),n&&(s.disconnect(),n.submit()),!0}isCIDPatch(){return this.cidPatch}skipCIDSibling(e){return e.nodeType===Node.ELEMENT_NODE&&e.getAttribute(cr)!==null}targetCIDContainer(e){if(!this.isCIDPatch())return;let[s,...l]=q.findComponentNodeList(this.container,this.targetCID);return l.length===0&&q.childNodeLength(e)===1?s:s&&s.parentNode}buildDiffHTML(e,s,l,t){let o=this.isCIDPatch(),a=o&&t.getAttribute(le)===this.targetCID.toString();if(!o||a)return s;{let u=null,p=document.createElement("template");u=q.cloneNode(t);let[_,...b]=q.findComponentNodeList(u,this.targetCID);return p.innerHTML=s,b.forEach(m=>m.remove()),Array.from(u.childNodes).forEach(m=>{m.id&&m.nodeType===Node.ELEMENT_NODE&&m.getAttribute(le)!==this.targetCID.toString()&&(m.setAttribute(cr,""),m.innerHTML="")}),Array.from(p.content.childNodes).forEach(m=>u.insertBefore(m,_)),_.remove(),u.outerHTML}}},Wr=class{static extract(e){let{[Pr]:s,[Dr]:l,[Br]:t}=e;return delete e[Pr],delete e[Dr],delete e[Br],{diff:e,title:t,reply:s||null,events:l||[]}}constructor(e,s){this.viewId=e,this.rendered={},this.mergeDiff(s)}parentViewId(){return this.viewId}toString(e){return this.recursiveToString(this.rendered,this.rendered[ce],e)}recursiveToString(e,s=e[ce],l){l=l?new Set(l):null;let t={buffer:"",components:s,onlyCids:l};return this.toOutputBuffer(e,null,t),t.buffer}componentCIDs(e){return Object.keys(e[ce]||{}).map(s=>parseInt(s))}isComponentOnlyDiff(e){return e[ce]?Object.keys(e).length===1:!1}getComponent(e,s){return e[ce][s]}mergeDiff(e){let s=e[ce],l={};if(delete e[ce],this.rendered=this.mutableMerge(this.rendered,e),this.rendered[ce]=this.rendered[ce]||{},s){let t=this.rendered[ce];for(let o in s)s[o]=this.cachedFindComponent(o,s[o],t,s,l);for(let o in s)t[o]=s[o];e[ce]=s}}cachedFindComponent(e,s,l,t,o){if(o[e])return o[e];{let a,u,p=s[Ce];if(Te(p)){let _;p>0?_=this.cachedFindComponent(p,t[p],l,t,o):_=l[-p],u=_[Ce],a=this.cloneMerge(_,s),a[Ce]=u}else a=s[Ce]!==void 0?s:this.cloneMerge(l[e]||{},s);return o[e]=a,a}}mutableMerge(e,s){return s[Ce]!==void 0?s:(this.doMutableMerge(e,s),e)}doMutableMerge(e,s){for(let l in s){let t=s[l],o=e[l];rt(t)&&t[Ce]===void 0&&rt(o)?this.doMutableMerge(o,t):e[l]=t}}cloneMerge(e,s){let l=Ye(Ye({},e),s);for(let t in l){let o=s[t],a=e[t];rt(o)&&o[Ce]===void 0&&rt(a)&&(l[t]=this.cloneMerge(a,o))}return l}componentToString(e){return this.recursiveCIDToString(this.rendered[ce],e)}pruneCIDs(e){e.forEach(s=>delete this.rendered[ce][s])}get(){return this.rendered}isNewFingerprint(e={}){return!!e[Ce]}templateStatic(e,s){return typeof e=="number"?s[e]:e}toOutputBuffer(e,s,l){if(e[Or])return this.comprehensionToBuffer(e,s,l);let{[Ce]:t}=e;t=this.templateStatic(t,s),l.buffer+=t[0];for(let o=1;o<t.length;o++)this.dynamicToBuffer(e[o-1],s,l),l.buffer+=t[o]}comprehensionToBuffer(e,s,l){let{[Or]:t,[Ce]:o}=e;o=this.templateStatic(o,s);let a=s||e[Fn];for(let u=0;u<t.length;u++){let p=t[u];l.buffer+=o[0];for(let _=1;_<o.length;_++)this.dynamicToBuffer(p[_-1],a,l),l.buffer+=o[_]}}dynamicToBuffer(e,s,l){typeof e=="number"?l.buffer+=this.recursiveCIDToString(l.components,e,l.onlyCids):rt(e)?this.toOutputBuffer(e,s,l):l.buffer+=e}recursiveCIDToString(e,s,l){let t=e[s]||re(`no component for CID ${s}`,e),o=document.createElement("template");o.innerHTML=this.recursiveToString(t,e,l);let a=o.content,u=l&&!l.has(s),[p,_]=Array.from(a.childNodes).reduce(([b,m],h,v)=>h.nodeType===Node.ELEMENT_NODE?h.getAttribute(le)?[b,!0]:(h.setAttribute(le,s),h.id||(h.id=`${this.parentViewId()}-${s}-${v}`),u&&(h.setAttribute(cr,""),h.innerHTML=""),[!0,m]):h.nodeValue.trim()!==""?(re(`only HTML element tags are allowed at the root of components.

got: "${h.nodeValue.trim()}"

within:
`,o.innerHTML.trim()),h.replaceWith(this.createSpan(h.nodeValue,s)),[!0,m]):(h.remove(),[b,m]),[!1,!1]);return!p&&!_?(re(`expected at least one HTML element tag inside a component, but the component is empty:
`,o.innerHTML.trim()),this.createSpan("",s).outerHTML):(!p&&_&&re("expected at least one HTML element tag directly inside a component, but only subcomponents were found. A component must render at least one HTML tag directly inside itself.",o.innerHTML.trim()),o.innerHTML)}createSpan(e,s){let l=document.createElement("span");return l.innerText=e,l.setAttribute(le,s),l}},ls=1,st=class{static makeID(){return ls++}static elementID(e){return e.phxHookId}constructor(e,s,l){this.__view=e,this.liveSocket=e.liveSocket,this.__callbacks=l,this.__listeners=new Set,this.__isDisconnected=!1,this.el=s,this.el.phxHookId=this.constructor.makeID();for(let t in this.__callbacks)this[t]=this.__callbacks[t]}__mounted(){this.mounted&&this.mounted()}__updated(){this.updated&&this.updated()}__beforeUpdate(){this.beforeUpdate&&this.beforeUpdate()}__destroyed(){this.destroyed&&this.destroyed()}__reconnected(){this.__isDisconnected&&(this.__isDisconnected=!1,this.reconnected&&this.reconnected())}__disconnected(){this.__isDisconnected=!0,this.disconnected&&this.disconnected()}pushEvent(e,s={},l=function(){}){return this.__view.pushHookEvent(null,e,s,l)}pushEventTo(e,s,l={},t=function(){}){return this.__view.withinTargets(e,(o,a)=>o.pushHookEvent(a,s,l,t))}handleEvent(e,s){let l=(t,o)=>o?e:s(t.detail);return window.addEventListener(`phx:${e}`,l),this.__listeners.add(l),l}removeHandleEvent(e){let s=e(null,!0);window.removeEventListener(`phx:${s}`,e),this.__listeners.delete(e)}upload(e,s){return this.__view.dispatchUploads(e,s)}uploadTo(e,s,l){return this.__view.withinTargets(e,t=>t.dispatchUploads(s,l))}__cleanup__(){this.__listeners.forEach(e=>this.removeHandleEvent(e))}},hs={exec(e,s,l,t,o){let[a,u]=o||[null,{}];(s.charAt(0)==="["?JSON.parse(s):[[a,u]]).forEach(([_,b])=>{_===a&&u.data&&(b.data=Object.assign(b.data||{},u.data)),this.filterToEls(t,b).forEach(m=>{this[`exec_${_}`](e,s,l,t,m,b)})})},isVisible(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length>0)},exec_dispatch(e,s,l,t,o,{to:a,event:u,detail:p,bubbles:_}){p=p||{},p.dispatcher=t,q.dispatchEvent(o,u,{detail:p,bubbles:_})},exec_push(e,s,l,t,o,a){if(!l.isConnected())return;let{event:u,data:p,target:_,page_loading:b,loading:m,value:h,dispatcher:v}=a,g={loading:m,value:h,target:_,page_loading:!!b},c=e==="change"&&v?v:t,r=_||c.getAttribute(l.binding("target"))||c;l.withinTargets(r,(i,n)=>{if(e==="change"){let{newCid:d,_target:f,callback:y}=a;f=f||(t instanceof HTMLInputElement?t.name:void 0),f&&(g._target=f),i.pushInput(t,n,d,u||s,g,y)}else e==="submit"?i.submitForm(t,n,u||s,g):i.pushEvent(e,t,n,u||s,p,g)})},exec_add_class(e,s,l,t,o,{names:a,transition:u,time:p}){this.addOrRemoveClasses(o,a,[],u,p,l)},exec_remove_class(e,s,l,t,o,{names:a,transition:u,time:p}){this.addOrRemoveClasses(o,[],a,u,p,l)},exec_transition(e,s,l,t,o,{time:a,transition:u}){let[p,_,b]=u,m=()=>this.addOrRemoveClasses(o,p.concat(_),[]),h=()=>this.addOrRemoveClasses(o,b,p.concat(_));l.transition(a,m,h)},exec_toggle(e,s,l,t,o,{display:a,ins:u,outs:p,time:_}){this.toggle(e,l,o,a,u,p,_)},exec_show(e,s,l,t,o,{display:a,transition:u,time:p}){this.show(e,l,o,a,u,p)},exec_hide(e,s,l,t,o,{display:a,transition:u,time:p}){this.hide(e,l,o,a,u,p)},exec_set_attr(e,s,l,t,o,{attr:[a,u]}){this.setOrRemoveAttrs(o,[[a,u]],[])},exec_remove_attr(e,s,l,t,o,{attr:a}){this.setOrRemoveAttrs(o,[],[a])},show(e,s,l,t,o,a){this.isVisible(l)||this.toggle(e,s,l,t,o,null,a)},hide(e,s,l,t,o,a){this.isVisible(l)&&this.toggle(e,s,l,t,null,o,a)},toggle(e,s,l,t,o,a,u){let[p,_,b]=o||[[],[],[]],[m,h,v]=a||[[],[],[]];if(p.length>0||m.length>0)if(this.isVisible(l)){let g=()=>{this.addOrRemoveClasses(l,h,p.concat(_).concat(b)),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(l,m,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(l,v,h))})};l.dispatchEvent(new Event("phx:hide-start")),s.transition(u,g,()=>{this.addOrRemoveClasses(l,[],m.concat(v)),q.putSticky(l,"toggle",c=>c.style.display="none"),l.dispatchEvent(new Event("phx:hide-end"))})}else{if(e==="remove")return;let g=()=>{this.addOrRemoveClasses(l,_,m.concat(h).concat(v)),q.putSticky(l,"toggle",c=>c.style.display=t||"block"),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(l,p,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(l,b,_))})};l.dispatchEvent(new Event("phx:show-start")),s.transition(u,g,()=>{this.addOrRemoveClasses(l,[],p.concat(b)),l.dispatchEvent(new Event("phx:show-end"))})}else this.isVisible(l)?window.requestAnimationFrame(()=>{l.dispatchEvent(new Event("phx:hide-start")),q.putSticky(l,"toggle",g=>g.style.display="none"),l.dispatchEvent(new Event("phx:hide-end"))}):window.requestAnimationFrame(()=>{l.dispatchEvent(new Event("phx:show-start")),q.putSticky(l,"toggle",g=>g.style.display=t||"block"),l.dispatchEvent(new Event("phx:show-end"))})},addOrRemoveClasses(e,s,l,t,o,a){let[u,p,_]=t||[[],[],[]];if(u.length>0){let b=()=>this.addOrRemoveClasses(e,p.concat(u),[]),m=()=>this.addOrRemoveClasses(e,s.concat(_),l.concat(u).concat(p));return a.transition(o,b,m)}window.requestAnimationFrame(()=>{let[b,m]=q.getSticky(e,"classes",[[],[]]),h=s.filter(r=>b.indexOf(r)<0&&!e.classList.contains(r)),v=l.filter(r=>m.indexOf(r)<0&&e.classList.contains(r)),g=b.filter(r=>l.indexOf(r)<0).concat(h),c=m.filter(r=>s.indexOf(r)<0).concat(v);q.putSticky(e,"classes",r=>(r.classList.remove(...c),r.classList.add(...g),[g,c]))})},setOrRemoveAttrs(e,s,l){let[t,o]=q.getSticky(e,"attrs",[[],[]]),a=s.map(([_,b])=>_).concat(l),u=t.filter(([_,b])=>!a.includes(_)).concat(s),p=o.filter(_=>!a.includes(_)).concat(l);q.putSticky(e,"attrs",_=>(p.forEach(b=>_.removeAttribute(b)),u.forEach(([b,m])=>_.setAttribute(b,m)),[u,p]))},hasAllClasses(e,s){return s.every(l=>e.classList.contains(l))},isToggledOut(e,s){return!this.isVisible(e)||this.hasAllClasses(e,s)},filterToEls(e,{to:s}){return s?q.all(document,s):[e]}},we=hs,vi=(e,s,l=[])=>{let t=new FormData(e),o=[];t.forEach((u,p,_)=>{u instanceof File&&o.push(p)}),o.forEach(u=>t.delete(u));let a=new URLSearchParams;for(let[u,p]of t.entries())(l.length===0||l.indexOf(u)>=0)&&a.append(u,p);for(let u in s)a.append(u,s[u]);return a.toString()},Gr=class{constructor(e,s,l,t){this.liveSocket=s,this.flash=t,this.parent=l,this.root=l?l.root:this,this.el=e,this.id=this.el.id,this.ref=0,this.childJoins=0,this.loaderTimer=null,this.pendingDiffs=[],this.pruningCIDs=[],this.redirect=!1,this.href=null,this.joinCount=this.parent?this.parent.joinCount-1:0,this.joinPending=!0,this.destroyed=!1,this.joinCallback=function(o){o&&o()},this.stopCallback=function(){},this.pendingJoinOps=this.parent?null:[],this.viewHooks={},this.uploaders={},this.formSubmits=[],this.children=this.parent?null:{},this.root.children[this.id]={},this.channel=this.liveSocket.channel(`lv:${this.id}`,()=>({redirect:this.redirect?this.href:void 0,url:this.redirect?void 0:this.href||void 0,params:this.connectParams(),session:this.getSession(),static:this.getStatic(),flash:this.flash})),this.showLoader(this.liveSocket.loaderTimeout),this.bindChannel()}setHref(e){this.href=e}setRedirect(e){this.redirect=!0,this.href=e}isMain(){return this.el.getAttribute(dr)!==null}connectParams(){let e=this.liveSocket.params(this.el),s=q.all(document,`[${this.binding(En)}]`).map(l=>l.src||l.href).filter(l=>typeof l=="string");return s.length>0&&(e._track_static=s),e._mounts=this.joinCount,e}isConnected(){return this.channel.canPush()}getSession(){return this.el.getAttribute(Me)}getStatic(){let e=this.el.getAttribute(ot);return e===""?null:e}destroy(e=function(){}){this.destroyAllChildren(),this.destroyed=!0,delete this.root.children[this.id],this.parent&&delete this.root.children[this.parent.id][this.id],clearTimeout(this.loaderTimer);let s=()=>{e();for(let l in this.viewHooks)this.destroyHook(this.viewHooks[l])};q.markPhxChildDestroyed(this.el),this.log("destroyed",()=>["the child has been removed from the parent"]),this.channel.leave().receive("ok",s).receive("error",s).receive("timeout",s)}setContainerClasses(...e){this.el.classList.remove(kr,Qi,xr),this.el.classList.add(...e)}showLoader(e){if(clearTimeout(this.loaderTimer),e)this.loaderTimer=setTimeout(()=>this.showLoader(),e);else{for(let s in this.viewHooks)this.viewHooks[s].__disconnected();this.setContainerClasses(Qi)}}hideLoader(){clearTimeout(this.loaderTimer),this.setContainerClasses(kr)}triggerReconnected(){for(let e in this.viewHooks)this.viewHooks[e].__reconnected()}log(e,s){this.liveSocket.log(this,e,s)}transition(e,s,l=function(){}){this.liveSocket.transition(e,s,l)}withinTargets(e,s){if(e instanceof HTMLElement||e instanceof SVGElement)return this.liveSocket.owner(e,l=>s(l,e));if(Te(e))q.findComponentNodeList(this.el,e).length===0?re(`no component found matching phx-target of ${e}`):s(this,parseInt(e));else{let l=Array.from(document.querySelectorAll(e));l.length===0&&re(`nothing found matching the phx-target selector "${e}"`),l.forEach(t=>this.liveSocket.owner(t,o=>s(o,t)))}}applyDiff(e,s,l){this.log(e,()=>["",gi(s)]);let{diff:t,reply:o,events:a,title:u}=Wr.extract(s);return u&&q.putTitle(u),l({diff:t,reply:o,events:a}),o}onJoin(e){let{rendered:s,container:l}=e;if(l){let[t,o]=l;this.el=q.replaceRootContainer(this.el,t,o)}this.childJoins=0,this.joinPending=!0,this.flash=null,Re.dropLocal(this.liveSocket.localStorage,window.location.pathname,qr),this.applyDiff("mount",s,({diff:t,events:o})=>{this.rendered=new Wr(this.id,t);let a=this.renderContainer(null,"join");this.dropPendingRefs();let u=this.formsForRecovery(a);this.joinCount++,u.length>0?u.forEach(([p,_,b],m)=>{this.pushFormRecovery(p,b,h=>{m===u.length-1&&this.onJoinComplete(h,a,o)})}):this.onJoinComplete(e,a,o)})}dropPendingRefs(){q.all(document,`[${je}="${this.id}"][${Le}]`,e=>{e.removeAttribute(Le),e.removeAttribute(je)})}onJoinComplete({live_patch:e},s,l){if(this.joinCount>1||this.parent&&!this.parent.isJoinPending())return this.applyJoinPatch(e,s,l);q.findPhxChildrenInFragment(s,this.id).filter(o=>{let a=o.id&&this.el.querySelector(`[id="${o.id}"]`),u=a&&a.getAttribute(ot);return u&&o.setAttribute(ot,u),this.joinChild(o)}).length===0?this.parent?(this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,s,l)]),this.parent.ackJoin(this)):(this.onAllChildJoinsComplete(),this.applyJoinPatch(e,s,l)):this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,s,l)])}attachTrueDocEl(){this.el=q.byId(this.id),this.el.setAttribute(ct,this.root.id)}applyJoinPatch(e,s,l){this.attachTrueDocEl();let t=new _i(this,this.el,this.id,s,null);if(t.markPrunableContentForRemoval(),this.performPatch(t,!1),this.joinNewChildren(),q.all(this.el,`[${this.binding(tt)}], [data-phx-${tt}]`,o=>{let a=this.addHook(o);a&&a.__mounted()}),this.joinPending=!1,this.liveSocket.dispatchEvents(l),this.applyPendingUpdates(),e){let{kind:o,to:a}=e;this.liveSocket.historyPatch(a,o)}this.hideLoader(),this.joinCount>1&&this.triggerReconnected(),this.stopCallback()}triggerBeforeUpdateHook(e,s){this.liveSocket.triggerDOM("onBeforeElUpdated",[e,s]);let l=this.getHook(e),t=l&&q.isIgnored(e,this.binding(ur));if(l&&!e.isEqualNode(s)&&!(t&&qn(e.dataset,s.dataset)))return l.__beforeUpdate(),l}performPatch(e,s){let l=[],t=!1,o=new Set;return e.after("added",a=>{this.liveSocket.triggerDOM("onNodeAdded",[a]);let u=this.addHook(a);u&&u.__mounted()}),e.after("phxChildAdded",a=>{q.isPhxSticky(a)?this.liveSocket.joinRootViews():t=!0}),e.before("updated",(a,u)=>{this.triggerBeforeUpdateHook(a,u)&&o.add(a.id)}),e.after("updated",a=>{o.has(a.id)&&this.getHook(a).__updated()}),e.after("discarded",a=>{a.nodeType===Node.ELEMENT_NODE&&l.push(a)}),e.after("transitionsDiscarded",a=>this.afterElementsRemoved(a,s)),e.perform(),this.afterElementsRemoved(l,s),t}afterElementsRemoved(e,s){let l=[];e.forEach(t=>{let o=q.all(t,`[${le}]`),a=q.all(t,`[${this.binding(tt)}]`);o.concat(t).forEach(u=>{let p=this.componentID(u);Te(p)&&l.indexOf(p)===-1&&l.push(p)}),a.concat(t).forEach(u=>{let p=this.getHook(u);p&&this.destroyHook(p)})}),s&&this.maybePushComponentsDestroyed(l)}joinNewChildren(){q.findPhxChildren(this.el,this.id).forEach(e=>this.joinChild(e))}getChildById(e){return this.root.children[this.id][e]}getDescendentByEl(e){return e.id===this.id?this:this.children[e.getAttribute(ze)][e.id]}destroyDescendent(e){for(let s in this.root.children)for(let l in this.root.children[s])if(l===e)return this.root.children[s][l].destroy()}joinChild(e){if(!this.getChildById(e.id)){let l=new Gr(e,this.liveSocket,this);return this.root.children[this.id][l.id]=l,l.join(),this.childJoins++,!0}}isJoinPending(){return this.joinPending}ackJoin(e){this.childJoins--,this.childJoins===0&&(this.parent?this.parent.ackJoin(this):this.onAllChildJoinsComplete())}onAllChildJoinsComplete(){this.joinCallback(()=>{this.pendingJoinOps.forEach(([e,s])=>{e.isDestroyed()||s()}),this.pendingJoinOps=[]})}update(e,s){if(this.isJoinPending()||this.liveSocket.hasPendingLink()&&!q.isPhxSticky(this.el))return this.pendingDiffs.push({diff:e,events:s});this.rendered.mergeDiff(e);let l=!1;this.rendered.isComponentOnlyDiff(e)?this.liveSocket.time("component patch complete",()=>{q.findParentCIDs(this.el,this.rendered.componentCIDs(e)).forEach(o=>{this.componentPatch(this.rendered.getComponent(e,o),o)&&(l=!0)})}):Ir(e)||this.liveSocket.time("full patch complete",()=>{let t=this.renderContainer(e,"update"),o=new _i(this,this.el,this.id,t,null);l=this.performPatch(o,!0)}),this.liveSocket.dispatchEvents(s),l&&this.joinNewChildren()}renderContainer(e,s){return this.liveSocket.time(`toString diff (${s})`,()=>{let l=this.el.tagName,t=e?this.rendered.componentCIDs(e).concat(this.pruningCIDs):null,o=this.rendered.toString(t);return`<${l}>${o}</${l}>`})}componentPatch(e,s){if(Ir(e))return!1;let l=this.rendered.componentToString(s),t=new _i(this,this.el,this.id,l,s);return this.performPatch(t,!0)}getHook(e){return this.viewHooks[st.elementID(e)]}addHook(e){if(st.elementID(e)||!e.getAttribute)return;let s=e.getAttribute(`data-phx-${tt}`)||e.getAttribute(this.binding(tt));if(s&&!this.ownsElement(e))return;let l=this.liveSocket.getHookCallbacks(s);if(l){e.id||re(`no DOM ID for hook "${s}". Hooks require a unique ID on each element.`,e);let t=new st(this,e,l);return this.viewHooks[st.elementID(t.el)]=t,t}else s!==null&&re(`unknown hook found for "${s}"`,e)}destroyHook(e){e.__destroyed(),e.__cleanup__(),delete this.viewHooks[st.elementID(e.el)]}applyPendingUpdates(){this.pendingDiffs.forEach(({diff:e,events:s})=>this.update(e,s)),this.pendingDiffs=[]}onChannel(e,s){this.liveSocket.onChannel(this.channel,e,l=>{this.isJoinPending()?this.root.pendingJoinOps.push([this,()=>s(l)]):this.liveSocket.requestDOMUpdate(()=>s(l))})}bindChannel(){this.liveSocket.onChannel(this.channel,"diff",e=>{this.liveSocket.requestDOMUpdate(()=>{this.applyDiff("update",e,({diff:s,events:l})=>this.update(s,l))})}),this.onChannel("redirect",({to:e,flash:s})=>this.onRedirect({to:e,flash:s})),this.onChannel("live_patch",e=>this.onLivePatch(e)),this.onChannel("live_redirect",e=>this.onLiveRedirect(e)),this.channel.onError(e=>this.onError(e)),this.channel.onClose(e=>this.onClose(e))}destroyAllChildren(){for(let e in this.root.children[this.id])this.getChildById(e).destroy()}onLiveRedirect(e){let{to:s,kind:l,flash:t}=e,o=this.expandURL(s);this.liveSocket.historyRedirect(o,l,t)}onLivePatch(e){let{to:s,kind:l}=e;this.href=this.expandURL(s),this.liveSocket.historyPatch(s,l)}expandURL(e){return e.startsWith("/")?`${window.location.protocol}//${window.location.host}${e}`:e}onRedirect({to:e,flash:s}){this.liveSocket.redirect(e,s)}isDestroyed(){return this.destroyed}join(e){this.isMain()&&(this.stopCallback=this.liveSocket.withPageLoading({to:this.href,kind:"initial"})),this.joinCallback=s=>{s=s||function(){},e?e(this.joinCount,s):s()},this.liveSocket.wrapPush(this,{timeout:!1},()=>this.channel.join().receive("ok",s=>{this.isDestroyed()||this.liveSocket.requestDOMUpdate(()=>this.onJoin(s))}).receive("error",s=>!this.isDestroyed()&&this.onJoinError(s)).receive("timeout",()=>!this.isDestroyed()&&this.onJoinError({reason:"timeout"})))}onJoinError(e){if(e.reason==="unauthorized"||e.reason==="stale")return this.log("error",()=>["unauthorized live_redirect. Falling back to page request",e]),this.onRedirect({to:this.href});if((e.redirect||e.live_redirect)&&(this.joinPending=!1,this.channel.leave()),e.redirect)return this.onRedirect(e.redirect);if(e.live_redirect)return this.onLiveRedirect(e.live_redirect);this.log("error",()=>["unable to join",e]),this.liveSocket.isConnected()&&this.liveSocket.reloadWithJitter(this)}onClose(e){if(!this.isDestroyed()){if(this.liveSocket.hasPendingLink()&&e!=="leave")return this.liveSocket.reloadWithJitter(this);this.destroyAllChildren(),this.liveSocket.dropActiveElement(this),document.activeElement&&document.activeElement.blur(),this.liveSocket.isUnloaded()&&this.showLoader(Bn)}}onError(e){this.onClose(e),this.liveSocket.isConnected()&&this.log("error",()=>["view crashed",e]),this.liveSocket.isUnloaded()||this.displayError()}displayError(){this.isMain()&&q.dispatchEvent(window,"phx:page-loading-start",{detail:{to:this.href,kind:"error"}}),this.showLoader(),this.setContainerClasses(Qi,xr)}pushWithReply(e,s,l,t=function(){}){if(!this.isConnected())return;let[o,[a],u]=e?e():[null,[],{}],p=function(){};return(u.page_loading||a&&a.getAttribute(this.binding(Er))!==null)&&(p=this.liveSocket.withPageLoading({kind:"element",target:a})),typeof l.cid!="number"&&delete l.cid,this.liveSocket.wrapPush(this,{timeout:!0},()=>this.channel.push(s,l,Hn).receive("ok",_=>{o!==null&&this.undoRefs(o);let b=m=>{_.redirect&&this.onRedirect(_.redirect),_.live_patch&&this.onLivePatch(_.live_patch),_.live_redirect&&this.onLiveRedirect(_.live_redirect),p(),t(_,m)};_.diff?this.liveSocket.requestDOMUpdate(()=>{let m=this.applyDiff("update",_.diff,({diff:h,events:v})=>{this.update(h,v)});b(m)}):b(null)}))}undoRefs(e){q.all(document,`[${je}="${this.id}"][${Le}="${e}"]`,s=>{let l=s.getAttribute(li);s.removeAttribute(Le),s.removeAttribute(je),s.getAttribute(er)!==null&&(s.readOnly=!1,s.removeAttribute(er)),l!==null&&(s.disabled=l==="true",s.removeAttribute(li)),zr.forEach(a=>q.removeClass(s,a));let t=s.getAttribute(hi);t!==null&&(s.innerText=t,s.removeAttribute(hi));let o=q.private(s,Le);if(o){let a=this.triggerBeforeUpdateHook(s,o);_i.patchEl(s,o,this.liveSocket.getActiveElement()),a&&a.__updated(),q.deletePrivate(s,Le)}})}putRef(e,s,l={}){let t=this.ref++,o=this.binding(hr);return l.loading&&(e=e.concat(q.all(document,l.loading))),e.forEach(a=>{a.classList.add(`phx-${s}-loading`),a.setAttribute(Le,t),a.setAttribute(je,this.el.id);let u=a.getAttribute(o);u!==null&&(a.getAttribute(hi)||a.setAttribute(hi,a.innerText),u!==""&&(a.innerText=u),a.setAttribute("disabled",""))}),[t,e,l]}componentID(e){let s=e.getAttribute&&e.getAttribute(le);return s?parseInt(s):null}targetComponentID(e,s,l={}){if(Te(s))return s;let t=e.getAttribute(this.binding("target"));return Te(t)?parseInt(t):s&&(t!==null||l.target)?this.closestComponentID(s):null}closestComponentID(e){return Te(e)?e:e?Ae(e.closest(`[${le}]`),s=>this.ownsElement(s)&&this.componentID(s)):null}pushHookEvent(e,s,l,t){if(!this.isConnected())return this.log("hook",()=>["unable to push hook event. LiveView not connected",s,l]),!1;let[o,a,u]=this.putRef([],"hook");return this.pushWithReply(()=>[o,a,u],"event",{type:"hook",event:s,value:l,cid:this.closestComponentID(e)},(p,_)=>t(_,o)),o}extractMeta(e,s,l){let t=this.binding("value-");for(let o=0;o<e.attributes.length;o++){s||(s={});let a=e.attributes[o].name;a.startsWith(t)&&(s[a.replace(t,"")]=e.getAttribute(a))}if(e.value!==void 0&&(s||(s={}),s.value=e.value,e.tagName==="INPUT"&&Vr.indexOf(e.type)>=0&&!e.checked&&delete s.value),l){s||(s={});for(let o in l)s[o]=l[o]}return s}pushEvent(e,s,l,t,o,a={}){this.pushWithReply(()=>this.putRef([s],e,a),"event",{type:e,event:t,value:this.extractMeta(s,o,a.value),cid:this.targetComponentID(s,l,a)})}pushFileProgress(e,s,l,t=function(){}){this.liveSocket.withinOwners(e.form,(o,a)=>{o.pushWithReply(null,"progress",{event:e.getAttribute(o.binding(Dn)),ref:e.getAttribute(Fe),entry_ref:s,progress:l,cid:o.targetComponentID(e.form,a)},t)})}pushInput(e,s,l,t,o,a){let u,p=Te(l)?l:this.targetComponentID(e.form,s),_=()=>this.putRef([e,e.form],"change",o),b;e.getAttribute(this.binding("change"))?b=vi(e.form,{_target:o._target},[e.name]):b=vi(e.form,{_target:o._target}),q.isUploadInput(e)&&e.files&&e.files.length>0&&ie.trackFiles(e,Array.from(e.files)),u=ie.serializeUploads(e);let m={type:"form",event:t,value:b,uploads:u,cid:p};this.pushWithReply(_,"event",m,h=>{if(q.showError(e,this.liveSocket.binding(lr)),q.isUploadInput(e)&&e.getAttribute("data-phx-auto-upload")!==null){if(ie.filesAwaitingPreflight(e).length>0){let[v,g]=_();this.uploadFiles(e.form,s,v,p,c=>{a&&a(h),this.triggerAwaitingSubmit(e.form)})}}else a&&a(h)})}triggerAwaitingSubmit(e){let s=this.getScheduledSubmit(e);if(s){let[l,t,o,a]=s;this.cancelSubmit(e),a()}}getScheduledSubmit(e){return this.formSubmits.find(([s,l,t,o])=>s.isSameNode(e))}scheduleSubmit(e,s,l,t){if(this.getScheduledSubmit(e))return!0;this.formSubmits.push([e,s,l,t])}cancelSubmit(e){this.formSubmits=this.formSubmits.filter(([s,l,t])=>s.isSameNode(e)?(this.undoRefs(l),!1):!0)}pushFormSubmit(e,s,l,t,o){let a=h=>!(at(h,`${this.binding(ur)}=ignore`,h.form)||at(h,"data-phx-update=ignore",h.form)),u=h=>h.hasAttribute(this.binding(hr)),p=h=>h.tagName=="BUTTON",_=h=>["INPUT","TEXTAREA","SELECT"].includes(h.tagName),b=()=>{let h=Array.from(e.elements),v=h.filter(u),g=h.filter(p).filter(a),c=h.filter(_).filter(a);return g.forEach(r=>{r.setAttribute(li,r.disabled),r.disabled=!0}),c.forEach(r=>{r.setAttribute(er,r.readOnly),r.readOnly=!0,r.files&&(r.setAttribute(li,r.disabled),r.disabled=!0)}),e.setAttribute(this.binding(Er),""),this.putRef([e].concat(v).concat(g).concat(c),"submit",t)},m=this.targetComponentID(e,s);if(ie.hasUploadsInProgress(e)){let[h,v]=b(),g=()=>this.pushFormSubmit(e,s,l,t,o);return this.scheduleSubmit(e,h,t,g)}else if(ie.inputsAwaitingPreflight(e).length>0){let[h,v]=b(),g=()=>[h,v,t];this.uploadFiles(e,s,h,m,c=>{let r=vi(e,{});this.pushWithReply(g,"event",{type:"form",event:l,value:r,cid:m},o)})}else{let h=vi(e,{});this.pushWithReply(b,"event",{type:"form",event:l,value:h,cid:m},o)}}uploadFiles(e,s,l,t,o){let a=this.joinCount,u=ie.activeFileInputs(e),p=u.length;u.forEach(_=>{let b=new ie(_,this,()=>{p--,p===0&&o()});this.uploaders[_]=b;let m=b.entries().map(v=>v.toPreflightPayload()),h={ref:_.getAttribute(Fe),entries:m,cid:this.targetComponentID(_.form,s)};this.log("upload",()=>["sending preflight request",h]),this.pushWithReply(null,"allow_upload",h,v=>{if(this.log("upload",()=>["got preflight response",v]),v.error){this.undoRefs(l);let[g,c]=v.error;this.log("upload",()=>[`error for entry ${g}`,c])}else{let g=c=>{this.channel.onError(()=>{this.joinCount===a&&c()})};b.initAdapterUpload(v,g,this.liveSocket)}})})}dispatchUploads(e,s){let l=q.findUploadInputs(this.el).filter(t=>t.name===e);l.length===0?re(`no live file inputs found matching the name "${e}"`):l.length>1?re(`duplicate live file inputs found matching the name "${e}"`):q.dispatchEvent(l[0],Kr,{detail:{files:s}})}pushFormRecovery(e,s,l){this.liveSocket.withinOwners(e,(t,o)=>{let a=e.elements[0],u=e.getAttribute(this.binding(Tr))||e.getAttribute(this.binding("change"));we.exec("change",u,t,a,["push",{_target:a.name,newCid:s,callback:l}])})}pushLinkPatch(e,s,l){let t=this.liveSocket.setPendingLink(e),o=s?()=>this.putRef([s],"click"):null,a=()=>this.liveSocket.redirect(window.location.href),u=this.pushWithReply(o,"live_patch",{url:e},p=>{this.liveSocket.requestDOMUpdate(()=>{p.link_redirect?this.liveSocket.replaceMain(e,null,l,t):(this.liveSocket.commitPendingLink(t)&&(this.href=e),this.applyPendingUpdates(),l&&l(t))})});u?u.receive("timeout",a):a()}formsForRecovery(e){if(this.joinCount===0)return[];let s=this.binding("change"),l=document.createElement("template");return l.innerHTML=e,q.all(this.el,`form[${s}]`).filter(t=>t.id&&this.ownsElement(t)).filter(t=>t.elements.length>0).filter(t=>t.getAttribute(this.binding(Tr))!=="ignore").map(t=>{let o=l.content.querySelector(`form[id="${t.id}"][${s}="${t.getAttribute(s)}"]`);return o?[t,o,this.targetComponentID(o)]:[t,null,null]}).filter(([t,o,a])=>o)}maybePushComponentsDestroyed(e){let s=e.filter(l=>q.findComponentNodeList(this.el,l).length===0);s.length>0&&(this.pruningCIDs.push(...s),this.pushWithReply(null,"cids_will_destroy",{cids:s},()=>{this.pruningCIDs=this.pruningCIDs.filter(t=>s.indexOf(t)!==-1);let l=s.filter(t=>q.findComponentNodeList(this.el,t).length===0);l.length>0&&this.pushWithReply(null,"cids_destroyed",{cids:l},t=>{this.rendered.pruneCIDs(t.cids)})}))}ownsElement(e){return e.getAttribute(ze)===this.id||Ae(e.closest(Ke),s=>s.id)===this.id}submitForm(e,s,l,t={}){q.putPrivate(e,Jr,!0);let o=this.liveSocket.binding(lr),a=Array.from(e.elements);this.liveSocket.blurActiveElement(this),this.pushFormSubmit(e,s,l,t,()=>{a.forEach(u=>q.showError(u,o)),this.liveSocket.restorePreviouslyActiveFocus()})}binding(e){return this.liveSocket.binding(e)}},Yr=class{constructor(e,s,l={}){if(this.unloaded=!1,!s||s.constructor.name==="Object")throw new Error(`
      a phoenix Socket must be provided as the second argument to the LiveSocket constructor. For example:

          import {Socket} from "phoenix"
          import {LiveSocket} from "phoenix_live_view"
          let liveSocket = new LiveSocket("/live", Socket, {...})
      `);this.socket=new s(e,l),this.bindingPrefix=l.bindingPrefix||In,this.opts=l,this.params=rr(l.params||{}),this.viewLogger=l.viewLogger,this.metadataCallbacks=l.metadata||{},this.defaults=Object.assign(gi(jn),l.defaults||{}),this.activeElement=null,this.prevActive=null,this.silenced=!1,this.main=null,this.outgoingMainEl=null,this.clickStartedAtTarget=null,this.linkRef=1,this.roots={},this.href=window.location.href,this.pendingLink=null,this.currentLocation=gi(window.location),this.hooks=l.hooks||{},this.uploaders=l.uploaders||{},this.loaderTimeout=l.loaderTimeout||Pn,this.reloadWithJitterTimer=null,this.maxReloads=l.maxReloads||Sn,this.reloadJitterMin=l.reloadJitterMin||Cn,this.reloadJitterMax=l.reloadJitterMax||wn,this.failsafeJitter=l.failsafeJitter||Ln,this.localStorage=l.localStorage||window.localStorage,this.sessionStorage=l.sessionStorage||window.sessionStorage,this.boundTopLevelEvents=!1,this.domCallbacks=Object.assign({onNodeAdded:rr(),onBeforeElUpdated:rr()},l.dom||{}),this.transitions=new us,window.addEventListener("pagehide",t=>{this.unloaded=!0}),this.socket.onOpen(()=>{this.isUnloaded()&&window.location.reload()})}isProfileEnabled(){return this.sessionStorage.getItem(tr)==="true"}isDebugEnabled(){return this.sessionStorage.getItem(ui)==="true"}isDebugDisabled(){return this.sessionStorage.getItem(ui)==="false"}enableDebug(){this.sessionStorage.setItem(ui,"true")}enableProfiling(){this.sessionStorage.setItem(tr,"true")}disableDebug(){this.sessionStorage.setItem(ui,"false")}disableProfiling(){this.sessionStorage.removeItem(tr)}enableLatencySim(e){this.enableDebug(),console.log("latency simulator enabled for the duration of this browser session. Call disableLatencySim() to disable"),this.sessionStorage.setItem(ir,e)}disableLatencySim(){this.sessionStorage.removeItem(ir)}getLatencySim(){let e=this.sessionStorage.getItem(ir);return e?parseInt(e):null}getSocket(){return this.socket}connect(){window.location.hostname==="localhost"&&!this.isDebugDisabled()&&this.enableDebug();let e=()=>{this.joinRootViews()?(this.bindTopLevelEvents(),this.socket.connect()):this.main&&this.socket.connect()};["complete","loaded","interactive"].indexOf(document.readyState)>=0?e():document.addEventListener("DOMContentLoaded",()=>e())}disconnect(e){clearTimeout(this.reloadWithJitterTimer),this.socket.disconnect(e)}replaceTransport(e){clearTimeout(this.reloadWithJitterTimer),this.socket.replaceTransport(e),this.connect()}execJS(e,s,l=null){this.owner(e,t=>we.exec(l,s,t,e))}triggerDOM(e,s){this.domCallbacks[e](...s)}time(e,s){if(!this.isProfileEnabled()||!console.time)return s();console.time(e);let l=s();return console.timeEnd(e),l}log(e,s,l){if(this.viewLogger){let[t,o]=l();this.viewLogger(e,s,t,o)}else if(this.isDebugEnabled()){let[t,o]=l();Wn(e,s,t,o)}}requestDOMUpdate(e){this.transitions.after(e)}transition(e,s,l=function(){}){this.transitions.addTransition(e,s,l)}onChannel(e,s,l){e.on(s,t=>{let o=this.getLatencySim();o?(console.log(`simulating ${o}ms of latency from server to client`),setTimeout(()=>l(t),o)):l(t)})}wrapPush(e,s,l){let t=this.getLatencySim(),o=e.joinCount;if(!t)return this.isConnected()&&s.timeout?l().receive("timeout",()=>{e.joinCount===o&&!e.isDestroyed()&&this.reloadWithJitter(e,()=>{this.log(e,"timeout",()=>["received timeout while communicating with server. Falling back to hard refresh for recovery"])})}):l();console.log(`simulating ${t}ms of latency from client to server`);let a={receives:[],receive(u,p){this.receives.push([u,p])}};return setTimeout(()=>{e.isDestroyed()||a.receives.reduce((u,[p,_])=>u.receive(p,_),l())},t),a}reloadWithJitter(e,s){clearTimeout(this.reloadWithJitterTimer),this.disconnect();let l=this.reloadJitterMin,t=this.reloadJitterMax,o=Math.floor(Math.random()*(t-l+1))+l,a=Re.updateLocal(this.localStorage,window.location.pathname,qr,0,u=>u+1);a>this.maxReloads&&(o=this.failsafeJitter),this.reloadWithJitterTimer=setTimeout(()=>{e.isDestroyed()||e.isConnected()||(e.destroy(),s?s():this.log(e,"join",()=>[`encountered ${a} consecutive reloads`]),a>this.maxReloads&&this.log(e,"join",()=>[`exceeded ${this.maxReloads} consecutive reloads. Entering failsafe mode`]),this.hasPendingLink()?window.location=this.pendingLink:window.location.reload())},o)}getHookCallbacks(e){return e&&e.startsWith("Phoenix.")?Vn[e.split(".")[1]]:this.hooks[e]}isUnloaded(){return this.unloaded}isConnected(){return this.socket.isConnected()}getBindingPrefix(){return this.bindingPrefix}binding(e){return`${this.getBindingPrefix()}${e}`}channel(e,s){return this.socket.channel(e,s)}joinRootViews(){let e=!1;return q.all(document,`${Ke}:not([${ze}])`,s=>{if(!this.getRootById(s.id)){let l=this.newRootView(s);l.setHref(this.getHref()),l.join(),s.getAttribute(dr)&&(this.main=l)}e=!0}),e}redirect(e,s){this.disconnect(),Re.redirect(e,s)}replaceMain(e,s,l=null,t=this.setPendingLink(e)){this.outgoingMainEl=this.outgoingMainEl||this.main.el;let o=q.cloneNode(this.outgoingMainEl,"");this.main.showLoader(this.loaderTimeout),this.main.destroy(),this.main=this.newRootView(o,s),this.main.setRedirect(e),this.transitionRemoves(),this.main.join((a,u)=>{a===1&&this.commitPendingLink(t)&&this.requestDOMUpdate(()=>{q.findPhxSticky(document).forEach(p=>o.appendChild(p)),this.outgoingMainEl.replaceWith(o),this.outgoingMainEl=null,l&&requestAnimationFrame(l),u()})})}transitionRemoves(e){let s=this.binding("remove");e=e||q.all(document,`[${s}]`),e.forEach(l=>{document.body.contains(l)&&this.execJS(l,l.getAttribute(s),"remove")})}isPhxView(e){return e.getAttribute&&e.getAttribute(Me)!==null}newRootView(e,s){let l=new Gr(e,this,null,s);return this.roots[l.id]=l,l}owner(e,s){let l=Ae(e.closest(Ke),t=>this.getViewByEl(t))||this.main;l&&s(l)}withinOwners(e,s){this.owner(e,l=>s(l,e))}getViewByEl(e){let s=e.getAttribute(ct);return Ae(this.getRootById(s),l=>l.getDescendentByEl(e))}getRootById(e){return this.roots[e]}destroyAllViews(){for(let e in this.roots)this.roots[e].destroy(),delete this.roots[e];this.main=null}destroyViewByEl(e){let s=this.getRootById(e.getAttribute(ct));s&&s.id===e.id?(s.destroy(),delete this.roots[s.id]):s&&s.destroyDescendent(e.id)}setActiveElement(e){if(this.activeElement===e)return;this.activeElement=e;let s=()=>{e===this.activeElement&&(this.activeElement=null),e.removeEventListener("mouseup",this),e.removeEventListener("touchend",this)};e.addEventListener("mouseup",s),e.addEventListener("touchend",s)}getActiveElement(){return document.activeElement===document.body?this.activeElement||document.activeElement:document.activeElement||document.body}dropActiveElement(e){this.prevActive&&e.ownsElement(this.prevActive)&&(this.prevActive=null)}restorePreviouslyActiveFocus(){this.prevActive&&this.prevActive!==document.body&&this.prevActive.focus()}blurActiveElement(){this.prevActive=this.getActiveElement(),this.prevActive!==document.body&&this.prevActive.blur()}bindTopLevelEvents(){this.boundTopLevelEvents||(this.boundTopLevelEvents=!0,this.socket.onClose(e=>{e&&e.code===1e3&&this.main&&this.reloadWithJitter(this.main)}),document.body.addEventListener("click",function(){}),window.addEventListener("pageshow",e=>{e.persisted&&(this.getSocket().disconnect(),this.withPageLoading({to:window.location.href,kind:"redirect"}),window.location.reload())},!0),this.bindNav(),this.bindClicks(),this.bindForms(),this.bind({keyup:"keyup",keydown:"keydown"},(e,s,l,t,o,a)=>{let u=t.getAttribute(this.binding(On)),p=e.key&&e.key.toLowerCase();if(u&&u.toLowerCase()!==p)return;let _=Ye({key:e.key},this.eventMeta(s,e,t));we.exec(s,o,l,t,["push",{data:_}])}),this.bind({blur:"focusout",focus:"focusin"},(e,s,l,t,o,a)=>{if(!a){let u=Ye({key:e.key},this.eventMeta(s,e,t));we.exec(s,o,l,t,["push",{data:u}])}}),this.bind({blur:"blur",focus:"focus"},(e,s,l,t,o,a,u)=>{if(u==="window"){let p=this.eventMeta(s,e,t);we.exec(s,a,l,t,["push",{data:p}])}}),window.addEventListener("dragover",e=>e.preventDefault()),window.addEventListener("drop",e=>{e.preventDefault();let s=Ae(at(e.target,this.binding(wr)),o=>o.getAttribute(this.binding(wr))),l=s&&document.getElementById(s),t=Array.from(e.dataTransfer.files||[]);!l||l.disabled||t.length===0||!(l.files instanceof FileList)||(ie.trackFiles(l,t),l.dispatchEvent(new Event("input",{bubbles:!0})))}),this.on(Kr,e=>{let s=e.target;if(!q.isUploadInput(s))return;let l=Array.from(e.detail.files||[]).filter(t=>t instanceof File||t instanceof Blob);ie.trackFiles(s,l),s.dispatchEvent(new Event("input",{bubbles:!0}))}))}eventMeta(e,s,l){let t=this.metadataCallbacks[e];return t?t(s,l):{}}setPendingLink(e){return this.linkRef++,this.pendingLink=e,this.linkRef}commitPendingLink(e){return this.linkRef!==e?!1:(this.href=this.pendingLink,this.pendingLink=null,!0)}getHref(){return this.href}hasPendingLink(){return!!this.pendingLink}bind(e,s){for(let l in e){let t=e[l];this.on(t,o=>{let a=this.binding(l),u=this.binding(`window-${l}`),p=o.target.getAttribute&&o.target.getAttribute(a);p?this.debounce(o.target,o,t,()=>{this.withinOwners(o.target,_=>{s(o,l,_,o.target,p,null)})}):q.all(document,`[${u}]`,_=>{let b=_.getAttribute(u);this.debounce(_,o,t,()=>{this.withinOwners(_,m=>{s(o,l,m,_,b,"window")})})})})}}bindClicks(){window.addEventListener("mousedown",e=>this.clickStartedAtTarget=e.target),this.bindClick("click","click",!1),this.bindClick("mousedown","capture-click",!0)}bindClick(e,s,l){let t=this.binding(s);window.addEventListener(e,o=>{let a=null;if(l)a=o.target.matches(`[${t}]`)?o.target:o.target.querySelector(`[${t}]`);else{let p=this.clickStartedAtTarget||o.target;a=at(p,t),this.dispatchClickAway(o,p),this.clickStartedAtTarget=null}let u=a&&a.getAttribute(t);!u||(a.getAttribute("href")==="#"&&o.preventDefault(),this.debounce(a,o,"click",()=>{this.withinOwners(a,p=>{we.exec("click",u,p,a,["push",{data:this.eventMeta("click",o,a)}])})}))},l)}dispatchClickAway(e,s){let l=this.binding("click-away");q.all(document,`[${l}]`,t=>{t.isSameNode(s)||t.contains(s)||this.withinOwners(e.target,o=>{let a=t.getAttribute(l);we.isVisible(t)&&we.exec("click",a,o,t,["push",{data:this.eventMeta("click",e,e.target)}])})})}bindNav(){if(!Re.canPushState())return;history.scrollRestoration&&(history.scrollRestoration="manual");let e=null;window.addEventListener("scroll",s=>{clearTimeout(e),e=setTimeout(()=>{Re.updateCurrentState(l=>Object.assign(l,{scroll:window.scrollY}))},100)}),window.addEventListener("popstate",s=>{if(!this.registerNewLocation(window.location))return;let{type:l,id:t,root:o,scroll:a}=s.state||{},u=window.location.href;this.requestDOMUpdate(()=>{this.main.isConnected()&&l==="patch"&&t===this.main.id?this.main.pushLinkPatch(u,null):this.replaceMain(u,null,()=>{o&&this.replaceRootHistory(),typeof a=="number"&&setTimeout(()=>{window.scrollTo(0,a)},0)})})},!1),window.addEventListener("click",s=>{let l=at(s.target,Zi),t=l&&l.getAttribute(Zi),o=s.metaKey||s.ctrlKey||s.button===1;if(!t||!this.isConnected()||!this.main||o)return;let a=l.href,u=l.getAttribute(kn);s.preventDefault(),s.stopImmediatePropagation(),this.pendingLink!==a&&this.requestDOMUpdate(()=>{if(t==="patch")this.pushHistoryPatch(a,u,l);else if(t==="redirect")this.historyRedirect(a,u);else throw new Error(`expected ${Zi} to be "patch" or "redirect", got: ${t}`)})},!1)}dispatchEvent(e,s={}){q.dispatchEvent(window,`phx:${e}`,{detail:s})}dispatchEvents(e){e.forEach(([s,l])=>this.dispatchEvent(s,l))}withPageLoading(e,s){q.dispatchEvent(window,"phx:page-loading-start",{detail:e});let l=()=>q.dispatchEvent(window,"phx:page-loading-stop",{detail:e});return s?s(l):l}pushHistoryPatch(e,s,l){this.withPageLoading({to:e,kind:"patch"},t=>{this.main.pushLinkPatch(e,l,o=>{this.historyPatch(e,s,o),t()})})}historyPatch(e,s,l=this.setPendingLink(e)){!this.commitPendingLink(l)||(Re.pushState(s,{type:"patch",id:this.main.id},e),this.registerNewLocation(window.location))}historyRedirect(e,s,l){let t=window.scrollY;this.withPageLoading({to:e,kind:"redirect"},o=>{this.replaceMain(e,l,()=>{Re.pushState(s,{type:"redirect",id:this.main.id,scroll:t},e),this.registerNewLocation(window.location),o()})})}replaceRootHistory(){Re.pushState("replace",{root:!0,type:"patch",id:this.main.id})}registerNewLocation(e){let{pathname:s,search:l}=this.currentLocation;return s+l===e.pathname+e.search?!1:(this.currentLocation=gi(e),!0)}bindForms(){let e=0;this.on("submit",s=>{let l=s.target.getAttribute(this.binding("submit"));!l||(s.preventDefault(),s.target.disabled=!0,this.withinOwners(s.target,t=>{we.exec("submit",l,t,s.target,["push",{}])}))},!1);for(let s of["change","input"])this.on(s,l=>{let t=this.binding("change"),o=l.target,a=o.getAttribute(t),u=o.form&&o.form.getAttribute(t),p=a||u;if(!p||o.type==="number"&&o.validity&&o.validity.badInput)return;let _=a?o:o.form,b=e;e++;let{at:m,type:h}=q.private(o,"prev-iteration")||{};m===b-1&&s!==h||(q.putPrivate(o,"prev-iteration",{at:b,type:s}),this.debounce(o,l,s,()=>{this.withinOwners(_,v=>{q.putPrivate(o,$r,!0),q.isTextualInput(o)||this.setActiveElement(o),we.exec("change",p,v,o,["push",{_target:l.target.name,dispatcher:_}])})}))},!1)}debounce(e,s,l,t){if(l==="blur"||l==="focusout")return t();let o=this.binding(Tn),a=this.binding(Mn),u=this.defaults.debounce.toString(),p=this.defaults.throttle.toString();this.withinOwners(e,_=>{let b=()=>!_.isDestroyed()&&document.body.contains(e);q.debounce(e,s,o,u,a,p,b,()=>{t()})})}silenceEvents(e){this.silenced=!0,e(),this.silenced=!1}on(e,s){window.addEventListener(e,l=>{this.silenced||s(l)})}},us=class{constructor(){this.transitions=new Set,this.pendingOps=[],this.reset()}reset(){this.transitions.forEach(e=>{cancelTimeout(e),this.transitions.delete(e)}),this.flushPendingOps()}after(e){this.size()===0?e():this.pushPendingOp(e)}addTransition(e,s,l){s();let t=setTimeout(()=>{this.transitions.delete(t),l(),this.size()===0&&this.flushPendingOps()},e);this.transitions.add(t)}pushPendingOp(e){this.pendingOps.push(e)}size(){return this.transitions.size}flushPendingOps(){this.pendingOps.forEach(e=>e()),this.pendingOps=[]}};var Qr=pn(Zr()),en=IExTerminal={mounted(){let e=new Qr.Terminal;e.open(this.el.querySelector(".xtermjs_container")),e.onKey(s=>{this.pushEventTo(this.el,"key",s)}),this.handleEvent("print_"+this.el.id,s=>{e.write(s.data)})}};var tn={};tn.Terminal=en;var fs=document.querySelector("meta[name='csrf-token']").getAttribute("content"),ds=new Yr("/live",Cr,{params:{_csrf_token:fs},hooks:tn});ds.connect();})();
